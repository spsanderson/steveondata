{
  "hash": "d33313b64dc602e87b019c6096609b68",
  "result": {
    "markdown": "---\ntitle: \"Fitting a Distribution to Data in R\"\nauthor: \"Steven P. Sanderson II, MPH\"\ndate: \"2023-11-02\"\ncategories: [rtip, distribution]\n---\n\n\n# Introduction\n\nThe gamma distribution is a continuous probability distribution that is often used to model waiting times or other positively skewed data. It is a two-parameter distribution, where the shape parameter controls the skewness of the distribution and the scale parameter controls the spread of the distribution.\n\n# Fitting a gamma distribution to a dataset in R\n\nThere are two main ways to fit a gamma distribution to a dataset in R:\n\n1. **Maximum likelihood estimation (MLE)**: This method estimates the parameters of the gamma distribution that are most likely to have produced the observed data.\n2. **Method of moments:** This method estimates the parameters of the gamma distribution by equating the sample mean and variance to the theoretical mean and variance of the gamma distribution.\n\n**MLE** is the more common and generally more reliable method of fitting a gamma distribution to a dataset. To fit a gamma distribution to a dataset using MLE, we can use the `fitdist()` function from the `fitdistrplus` package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Install the fitdistrplus package if necessary\n#install.packages(\"fitdistrplus\")\n\n# Load the fitdistrplus package\nlibrary(fitdistrplus)\nlibrary(TidyDensity)\n\nset.seed(123)\ndata <- tidy_gamma(.n = 500)$y\n\n# Fit a gamma distribution to the data\nfit <- fitdist(data, distr = \"gamma\", method = \"mle\")\n```\n:::\n\n\nThe `fit` object contains the estimated parameters of the gamma distribution, as well as other information about the fit. We can access the estimated parameters using the `coef()` function. Now the `tidy_gamma()` function from the TidyDensity package comes with a default setting of a `.scale = 0.3` and `shape = 1`. The rate is `1/.scale`, so by default it is 3.33333\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get the estimated parameters of the gamma distribution\ncoef(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   shape     rate \n1.031833 3.594773 \n```\n:::\n:::\n\n\nNow let's see how that compares to the built in TidyDensity function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nutil_gamma_param_estimate(data)$parameter_tbl[1,c(\"shape\",\"scale\",\"shape_ratio\")]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 Ã— 3\n  shape scale shape_ratio\n  <dbl> <dbl>       <dbl>\n1 0.983 0.292        3.36\n```\n:::\n:::\n\nIn the above, the `shape_ratio` is the `rate`\n\n# Try on your own!\n\nI encourage you to try fitting a gamma distribution to your own data. You can use the `fitdistrplus` package in R to fit a gamma distribution to any dataset. Once you have fitted a gamma distribution to your data, you can use the estimated parameters to generate random samples from the gamma distribution or to calculate the probability of observing a particular value.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}