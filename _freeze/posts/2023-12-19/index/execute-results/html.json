{
  "hash": "ea6a9a3f2b29cb2f9e25f87a8fd60903",
  "result": {
    "markdown": "---\ntitle: \"A Gentle Introduction to Poisson Regression for Count Data: School's Out, Job Offers Incoming!\"\nauthor: \"Steven P. Sanderson II, MPH\"\ndate: \"2023-12-19\"\ncategories: [rtip, regression]\n---\n\n\n# Introduction\n\nHey data enthusiasts! Today, we're diving into the fascinating world of count data and its trusty sidekick, Poisson regression. Buckle up, because we're about to explore how this statistical powerhouse helps us understand the factors influencing, you guessed it, counts.\n\n_Scenario:_ Imagine you're an education researcher, eager to understand how a student's GPA might influence their job offer count after graduation. But hold on, job offers aren't continuous – they're discrete, ranging from 0 to a handful. That's where Poisson regression comes in!\n\n# Generating Data\n\nWe'll keep the data generation part the same, just adjusting the variables in our data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\n# Set seed for reproducibility\nset.seed(123)\n\n# Creating data frame\ndata <- data.frame(\n  School = sample(c(\"A\", \"B\", \"C\"), 100, replace = TRUE),\n  GPA = c(\n    round(runif(50, 1, 3), 1),\n    round(runif(30, 2, 3.5), 1),\n    round(runif(20, 3, 4), 1)\n  ),\n  JobOffers = c(rep(0, 50), rep(1, 30), rep(2, 10), rep(3, 7), rep(4, 3))\n)\n\nsummary(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    School               GPA          JobOffers   \n Length:100         Min.   :1.000   Min.   :0.00  \n Class :character   1st Qu.:1.875   1st Qu.:0.00  \n Mode  :character   Median :2.600   Median :0.50  \n                    Mean   :2.532   Mean   :0.83  \n                    3rd Qu.:3.200   3rd Qu.:1.00  \n                    Max.   :4.000   Max.   :4.00  \n```\n:::\n\n```{.r .cell-code}\ndata |>\n  group_by(JobOffers) |>\n  summarise(mean_gpa = mean(GPA))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 2\n  JobOffers mean_gpa\n      <dbl>    <dbl>\n1         0     1.94\n2         1     2.87\n3         2     3.41\n4         3     3.5 \n5         4     3.8 \n```\n:::\n:::\n\n\n## Visualizing the Data\n\nLet's update the plots to reflect the change in the predictor and outcome.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# Plotting GPA distribution by school\nggplot(data, aes(JobOffers, fill = School)) +\n  geom_histogram(binwidth=.5, position=\"dodge\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThe density plot now showcases the distribution of GPA scores for each school.\n\nNext, let's visualize the relationship between GPA and job offers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotting Job Offers vs. GPA\nggplot(data, aes(x = GPA, y = JobOffers, color = School)) +\n  geom_point(aes(y = JobOffers), alpha = .628,\n             position = position_jitter(h = .2)) +\n  labs(title = \"Scatter Plot of Job Offers vs. GPA\",\n       x = \"GPA\", y = \"Job Offers\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nThis scatter plot gives us a visual cue that higher GPAs might correlate with more job offers.\n\n## Poisson Regression\n\nNow, let's adjust the Poisson Regression model to reflect the change in predictor and outcome.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fitting Poisson Regression model\npoisson_model <- glm(JobOffers ~ GPA + School, data = data, family = \"poisson\")\n\n# Summary of the model\nsummary(poisson_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = JobOffers ~ GPA + School, family = \"poisson\", data = data)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.2452  -0.5856  -0.3483   0.3221   1.6491  \n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -5.25817    0.70621  -7.446 9.65e-14 ***\nGPA          1.73169    0.21241   8.153 3.56e-16 ***\nSchoolB      0.03135    0.27524   0.114    0.909    \nSchoolC     -0.19137    0.27637  -0.692    0.489    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 138.07  on 99  degrees of freedom\nResidual deviance:  43.18  on 96  degrees of freedom\nAIC: 168.06\n\nNumber of Fisher Scoring iterations: 5\n```\n:::\n:::\n\n\nThe model summary will now provide insights into how GPA influences the number of job offers.\n\n## Visualizing Model Fits\n\nLet's update the plot to reflect the relationship between GPA and predicted job offers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Adding predicted values to the data frame\ndata$Predicted <- predict(poisson_model, type = \"response\")\n\n# Plotting observed vs. predicted values\nggplot(data, aes(x = GPA, y = Predicted, color = School)) +\n  geom_point(aes(y = JobOffers), alpha = .628,\n             position = position_jitter(h = .2)) +\n  geom_line() +\n  labs(\n    title = \"Observed vs. Predicted Job Offers\",\n    x = \"GPA\", \n    y = \"Predicted Job Offers\",\n    color = \"School\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nThis plot now illustrates how the Poisson Regression model predicts job offers based on GPA.\n\n\n# Predicted vs. actual values\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = JobOffers, y = predict(poisson_model),\n                 color = School)) +\n  geom_point(aes(y = JobOffers), alpha = .628,\n             position = position_jitter(h = .2)) +\n  labs(\n    title = \"Predicted vs. Actual Job Offers\", \n    x = \"Actual Job Offers\", \n    y = \"Predicted Job Offers\",\n    color = \"School\") +\n  geom_abline(intercept = 0, slope = 1, color = \"red\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n# Residuals vs. predicted values\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(poisson_model, which = 1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}