<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Steven P. Sanderson II, MPH">
<meta name="dcterms.date" content="2023-11-16">

<title>Steve’s Data Tips and Tricks - {healthyR.ts} New Features: Unlocking More Power</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JSJCM62KQJ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-JSJCM62KQJ', { 'anonymize_ip': true});
</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Steve’s Data Tips and Tricks - {healthyR.ts} New Features: Unlocking More Power">
<meta property="og:description" content="">
<meta property="og:image" content="https://www.spsanderson.com/steveondata/posts/2023-11-16/index_files/figure-html/unnamed-chunk-1-1.png">
<meta property="og:site-name" content="Steve's Data Tips and Tricks">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
<meta name="twitter:title" content="Steve’s Data Tips and Tricks - {healthyR.ts} New Features: Unlocking More Power">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://www.spsanderson.com/steveondata/posts/2023-11-16/index_files/figure-html/unnamed-chunk-1-1.png">
<meta name="twitter:creator" content="@steveondata">
<meta name="twitter:site" content="@steveondata">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Steve’s Data Tips and Tricks</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/spsanderson" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://t.me/steveondata" rel="" target=""><i class="bi bi-telegram" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://feeds.feedburner.com/RBloggers" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.r-bloggers.com/" rel="" target=""><i class="bi bi-book" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.r-users.com/" rel="" target=""><i class="bi bi-briefcase" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">{healthyR.ts} New Features: Unlocking More Power</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">rtip</div>
                <div class="quarto-category">healthyrts</div>
                <div class="quarto-category">timeseries</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Steven P. Sanderson II, MPH </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 16, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="new-features-unlocking-more-power" class="level1">
<h1>New Features: Unlocking More Power</h1>
<p>My R package <code>{healthyR.ts}</code> has been updated to version 0.3.0; you can install it from either CRAN, r-universe or GitHub. Let’s go over some of the changes and improvements.</p>
</section>
<section id="news" class="level1">
<h1>News</h1>
<section id="util_log_ts---logging-time-series-data" class="level2">
<h2 class="anchored" data-anchor-id="util_log_ts---logging-time-series-data">1. <code>util_log_ts()</code> - Logging Time Series Data</h2>
<p>One of the standout additions is the introduction of <code>util_log_ts()</code>. This function seems like a game-changer, providing a streamlined way to log time series data. This is incredibly useful, especially when dealing with extensive datasets, making the whole process more efficient and user-friendly. This is a helper function for <code>auto_stationarize()</code>.</p>
</section>
<section id="util_singlediff_ts---single-differences-for-time-series" class="level2">
<h2 class="anchored" data-anchor-id="util_singlediff_ts---single-differences-for-time-series">2. <code>util_singlediff_ts()</code> - Single Differences for Time Series</h2>
<p>The addition of <code>util_singlediff_ts()</code> expands the toolkit, offering a function dedicated to handling single differences in time series data. This is valuable for various applications, such as identifying trends or preparing data for further analysis. This is a helper function for <code>auto_stationarize()</code>.</p>
</section>
<section id="util_doublediff_ts---double-differences-for-time-series" class="level2">
<h2 class="anchored" data-anchor-id="util_doublediff_ts---double-differences-for-time-series">3. <code>util_doublediff_ts()</code> - Double Differences for Time Series</h2>
<p>Building on the concept of differencing, <code>util_doublediff_ts()</code> seems to provide a higher level of sophistication, allowing users to perform double differences on time series data. This could be pivotal in cases where a more refined analysis is required. This is a helper function for <code>auto_stationarize()</code>.</p>
</section>
<section id="util_difflog_ts---combining-differences-and-log-transformation" class="level2">
<h2 class="anchored" data-anchor-id="util_difflog_ts---combining-differences-and-log-transformation">4. <code>util_difflog_ts()</code> - Combining Differences and Log Transformation</h2>
<p>The fusion of differencing and log transformation in <code>util_difflog_ts()</code> is a remarkable addition. This could be particularly beneficial in scenarios where both operations are needed to unlock deeper insights from the time series data. This is a helper function for <code>auto_stationarize()</code>.</p>
</section>
<section id="util_doubledifflog_ts---double-differences-with-log-transformation" class="level2">
<h2 class="anchored" data-anchor-id="util_doubledifflog_ts---double-differences-with-log-transformation">5. <code>util_doubledifflog_ts()</code> - Double Differences with Log Transformation</h2>
<p>The introduction of <code>util_doubledifflog_ts()</code> appears to take things a step further by combining double differences and log transformation. This function seems poised to provide a comprehensive solution for users dealing with complex time series data. This is a helper function for <code>auto_stationarize()</code>.</p>
</section>
</section>
<section id="minor-fixes-and-improvements-polishing-the-experience" class="level1">
<h1>Minor Fixes and Improvements: Polishing the Experience</h1>
<section id="attributes-enhancement-in-ts_growth_rate_vec" class="level2">
<h2 class="anchored" data-anchor-id="attributes-enhancement-in-ts_growth_rate_vec">1. Attributes Enhancement in <code>ts_growth_rate_vec()</code></h2>
<p>The attention to detail is evident with the addition of attributes to the output of <code>ts_growth_rate_vec()</code>. This enhancement not only improves the clarity of results but also contributes to a more informative and user-friendly experience.</p>
</section>
<section id="refinement-of-auto_stationarize-in-response-to-user-feedback" class="level2">
<h2 class="anchored" data-anchor-id="refinement-of-auto_stationarize-in-response-to-user-feedback">2. Refinement of <code>auto_stationarize()</code> in Response to User Feedback</h2>
<p>Updates to <code>auto_stationarize()</code> based on user feedback (Fix #481 #483) demonstrate a commitment to refining existing features. This responsiveness to the community’s needs is commendable and ensures that the package evolves in sync with user expectations. It has taken all of the <code>util_</code> transforms mentioned above in order to improve it’s functionality.</p>
</section>
<section id="integration-with-auto_arima-engine-in-ts_auto_arima" class="level2">
<h2 class="anchored" data-anchor-id="integration-with-auto_arima-engine-in-ts_auto_arima">3. Integration with <code>auto_arima</code> Engine in <code>ts_auto_arima()</code></h2>
<p>The integration of <code>ts_auto_arima()</code> with the parsnip engine of <code>auto_arima</code> is a notable improvement. This update, triggered when <code>.tune</code> is set to <code>FALSE</code>, aligns the package with cutting-edge tools, potentially enhancing the efficiency and accuracy of time series modeling.</p>
<p>In conclusion, the release of healthyR.ts version 0.3.0 is an exciting leap forward. The new features introduce powerful capabilities, while the minor fixes and improvements showcase a commitment to providing a robust and user-friendly package. Users can look forward to a more versatile and refined experience in time series analysis. Great job on this release, and I’m sure the community is eager to explore these enhancements!</p>
</section>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<p>Let’s see how the main functions now behave.</p>
<section id="auto_stationarize" class="level2">
<h2 class="anchored" data-anchor-id="auto_stationarize"><code>auto_stationarize()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(healthyR.ts)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">auto_stationarize</span>(AirPassengers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The time series is already stationary via ts_adf_test().</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1949 112 118 132 129 121 135 148 148 136 119 104 118
1950 115 126 141 135 125 149 170 170 158 133 114 140
1951 145 150 178 163 172 178 199 199 184 162 146 166
1952 171 180 193 181 183 218 230 242 209 191 172 194
1953 196 196 236 235 229 243 264 272 237 211 180 201
1954 204 188 235 227 234 264 302 293 259 229 203 229
1955 242 233 267 269 270 315 364 347 312 274 237 278
1956 284 277 317 313 318 374 413 405 355 306 271 306
1957 315 301 356 348 355 422 465 467 404 347 305 336
1958 340 318 362 348 363 435 491 505 404 359 310 337
1959 360 342 406 396 420 472 548 559 463 407 362 405
1960 417 391 419 461 472 535 622 606 508 461 390 432</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto_stationarize</span>(BJsales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The time series is not stationary. Attempting to make it stationary...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$stationary_ts
Time Series:
Start = 3 
End = 150 
Frequency = 1 
  [1]  0.5 -0.4  0.6  1.1 -2.8  3.0 -1.1  0.6 -0.5 -0.5  0.1  2.0 -0.6  0.8  1.2
 [16] -3.4 -0.7 -0.3  1.7  3.0 -3.2  0.9  2.2 -2.5 -0.4  2.6 -4.3  2.0 -3.1  2.7
 [31] -2.1  0.1  2.1 -0.2 -2.2  0.6  1.0 -2.6  3.0  0.3  0.2 -0.8  1.0  0.0  3.2
 [46] -2.2 -4.7  1.2  0.8 -0.6 -0.4  0.6  1.0 -1.6 -0.1  3.4 -0.9 -1.7 -0.5  0.8
 [61]  2.4 -1.9  0.6 -2.2  2.6 -0.1 -2.7  1.7 -0.3  1.9 -2.7  1.1 -0.6  0.9  0.0
 [76]  1.8 -0.5 -0.4 -1.2  2.6 -1.8  1.7 -0.9  0.6 -0.4  3.0 -2.8  3.1 -2.3 -1.1
 [91]  2.1 -0.3 -1.7 -0.8 -0.4  1.1 -1.5  0.3  1.4 -2.0  1.3 -0.3  0.4 -3.5  1.1
[106]  2.6  0.4 -1.3  2.0 -1.6  0.6 -0.1 -1.4  1.6  1.6 -3.4  1.7 -2.2  2.1 -2.0
[121] -0.2  0.2  0.7 -1.4  1.8 -0.1 -0.7  0.4  0.4  1.0 -2.4  1.0 -0.4  0.8 -1.0
[136]  1.4 -1.2  1.1 -0.9  0.5  1.9 -0.6  0.3 -1.4 -0.9 -0.5  1.4  0.1

$ndiffs
[1] 1

$adf_stats
$adf_stats$test_stat
[1] -6.562008

$adf_stats$p_value
[1] 0.01


$trans_type
[1] "double_diff"

$ret
[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(<span class="fu">auto_stationarize</span>(BJsales)<span class="sc">$</span>stationary_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The time series is not stationary. Attempting to make it stationary...</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto_stationarize</span>(BJsales.lead)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The time series is not stationary. Attempting to make it stationary...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$stationary_ts
Time Series:
Start = 2 
End = 150 
Frequency = 1 
  [1]  0.06  0.25 -0.57  0.58 -0.20  0.23 -0.04 -0.19  0.03  0.42  0.04  0.24
 [13]  0.34 -0.46 -0.18 -0.08  0.29  0.56 -0.37  0.20  0.54 -0.31  0.03  0.52
 [25] -0.70  0.35 -0.63  0.44 -0.38 -0.01  0.22  0.10 -0.50  0.01  0.30 -0.76
 [37]  0.52  0.15  0.06 -0.10  0.21 -0.01  0.70 -0.22 -0.76  0.06  0.02 -0.17
 [49] -0.08  0.01  0.11 -0.39  0.01  0.50 -0.02 -0.37 -0.13  0.05  0.54 -0.46
 [61]  0.25 -0.52  0.44  0.02 -0.47  0.11  0.06  0.25 -0.35  0.00 -0.06  0.21
 [73] -0.09  0.36  0.09 -0.04 -0.20  0.44 -0.23  0.40 -0.01  0.17  0.08  0.58
 [85] -0.27  0.79 -0.21  0.02  0.30  0.28 -0.27 -0.01  0.03  0.16 -0.28  0.15
 [97]  0.26 -0.36  0.32 -0.11  0.22 -0.65  0.00  0.47  0.16 -0.19  0.48 -0.26
[109]  0.21  0.00 -0.20  0.35  0.38 -0.48  0.20 -0.32  0.43 -0.50  0.12 -0.17
[121]  0.15 -0.36  0.35 -0.03 -0.18  0.16  0.07  0.21 -0.50  0.23 -0.13  0.14
[133] -0.15  0.19 -0.24  0.26 -0.22  0.17  0.37 -0.06  0.29 -0.34 -0.12 -0.16
[145]  0.25  0.08 -0.07  0.26 -0.37

$ndiffs
[1] 1

$adf_stats
$adf_stats$test_stat
[1] -4.838625

$adf_stats$p_value
[1] 0.01


$trans_type
[1] "diff"

$ret
[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(<span class="fu">auto_stationarize</span>(BJsales.lead)<span class="sc">$</span>stationary_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The time series is not stationary. Attempting to make it stationary...</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ts_auto_arima" class="level2">
<h2 class="anchored" data-anchor-id="ts_auto_arima"><code>ts_auto_arima()</code></h2>
<p>This use to only use the Arima engine if the <code>.tune</code> parameter was set to FALSE, thus it would many times give a simple straight line forecast. This was changed to make the engine auto_arima if <code>.tune</code> is set to FALSE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(timetk)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modeltime)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> AirPassengers <span class="sc">|&gt;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ts_to_tbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>index)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>splits <span class="ot">&lt;-</span> <span class="fu">time_series_split</span>(</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  data</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  , date_col</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  , <span class="at">assess =</span> <span class="dv">12</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  , <span class="at">skip =</span> <span class="dv">3</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  , <span class="at">cumulative =</span> <span class="cn">TRUE</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>ts_aa <span class="ot">&lt;-</span> <span class="fu">ts_auto_arima</span>(</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">.data =</span> data,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">.num_cores =</span> <span class="dv">2</span>,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">.date_col =</span> date_col,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">.value_col =</span> value,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">.rsamp_obj =</span> splits,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">.formula =</span> value <span class="sc">~</span> .,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">.grid_size =</span> <span class="dv">5</span>,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">.cv_slice_limit =</span> <span class="dv">2</span>,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">.tune =</span> <span class="cn">FALSE</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>ts_aa<span class="sc">$</span>recipe_info</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$recipe_call
recipe(.data = data, .date_col = date_col, .value_col = value, 
    .formula = value ~ ., .rsamp_obj = splits, .tune = FALSE, 
    .grid_size = 5, .num_cores = 2, .cv_slice_limit = 2)

$recipe_syntax
[1] "ts_arima_recipe &lt;-"                                                                                                                                                                           
[2] "\n  recipe(.data = data, .date_col = date_col, .value_col = value, .formula = value ~ \n    ., .rsamp_obj = splits, .tune = FALSE, .grid_size = 5, .num_cores = 2, \n    .cv_slice_limit = 2)"

$rec_obj</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ts_aa<span class="sc">$</span>model_info</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$model_spec
ARIMA Regression Model Specification (regression)

Computational engine: auto_arima 


$wflw
══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: arima_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
ARIMA Regression Model Specification (regression)

Computational engine: auto_arima 


$fitted_wflw
══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: arima_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
Series: outcome 
ARIMA(1,1,0)(0,1,0)[12] 

Coefficients:
          ar1
      -0.2431
s.e.   0.0894

sigma^2 = 109.8:  log likelihood = -447.95
AIC=899.9   AICc=900.01   BIC=905.46

$was_tuned
[1] "not_tuned"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ts_aa<span class="sc">$</span>model_calibration</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$plot

$calibration_tbl
# Modeltime Table
# A tibble: 1 × 5
  .model_id .model     .model_desc             .type .calibration_data
      &lt;int&gt; &lt;list&gt;     &lt;chr&gt;                   &lt;chr&gt; &lt;list&gt;           
1         1 &lt;workflow&gt; ARIMA(1,1,0)(0,1,0)[12] Test  &lt;tibble [12 × 4]&gt;

$model_accuracy
# A tibble: 1 × 9
  .model_id .model_desc             .type   mae  mape  mase smape  rmse   rsq
      &lt;int&gt; &lt;chr&gt;                   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1         1 ARIMA(1,1,0)(0,1,0)[12] Test   18.5  4.18 0.384  4.03  23.9 0.955</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ts_aa<span class="sc">$</span>model_calibration<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9e72df46a6f62d8a62a4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9e72df46a6f62d8a62a4">{"x":{"data":[{"x":["1949-01-01","1949-02-01","1949-03-01","1949-04-01","1949-05-01","1949-06-01","1949-07-01","1949-08-01","1949-09-01","1949-10-01","1949-11-01","1949-12-01","1950-01-01","1950-02-01","1950-03-01","1950-04-01","1950-05-01","1950-06-01","1950-07-01","1950-08-01","1950-09-01","1950-10-01","1950-11-01","1950-12-01","1951-01-01","1951-02-01","1951-03-01","1951-04-01","1951-05-01","1951-06-01","1951-07-01","1951-08-01","1951-09-01","1951-10-01","1951-11-01","1951-12-01","1952-01-01","1952-02-01","1952-03-01","1952-04-01","1952-05-01","1952-06-01","1952-07-01","1952-08-01","1952-09-01","1952-10-01","1952-11-01","1952-12-01","1953-01-01","1953-02-01","1953-03-01","1953-04-01","1953-05-01","1953-06-01","1953-07-01","1953-08-01","1953-09-01","1953-10-01","1953-11-01","1953-12-01","1954-01-01","1954-02-01","1954-03-01","1954-04-01","1954-05-01","1954-06-01","1954-07-01","1954-08-01","1954-09-01","1954-10-01","1954-11-01","1954-12-01","1955-01-01","1955-02-01","1955-03-01","1955-04-01","1955-05-01","1955-06-01","1955-07-01","1955-08-01","1955-09-01","1955-10-01","1955-11-01","1955-12-01","1956-01-01","1956-02-01","1956-03-01","1956-04-01","1956-05-01","1956-06-01","1956-07-01","1956-08-01","1956-09-01","1956-10-01","1956-11-01","1956-12-01","1957-01-01","1957-02-01","1957-03-01","1957-04-01","1957-05-01","1957-06-01","1957-07-01","1957-08-01","1957-09-01","1957-10-01","1957-11-01","1957-12-01","1958-01-01","1958-02-01","1958-03-01","1958-04-01","1958-05-01","1958-06-01","1958-07-01","1958-08-01","1958-09-01","1958-10-01","1958-11-01","1958-12-01","1959-01-01","1959-02-01","1959-03-01","1959-04-01","1959-05-01","1959-06-01","1959-07-01","1959-08-01","1959-09-01","1959-10-01","1959-11-01","1959-12-01","1960-01-01","1960-02-01","1960-03-01","1960-04-01","1960-05-01","1960-06-01","1960-07-01","1960-08-01","1960-09-01","1960-10-01","1960-11-01","1960-12-01"],"y":[112,118,132,129,121,135,148,148,136,119,104,118,115,126,141,135,125,149,170,170,158,133,114,140,145,150,178,163,172,178,199,199,184,162,146,166,171,180,193,181,183,218,230,242,209,191,172,194,196,196,236,235,229,243,264,272,237,211,180,201,204,188,235,227,234,264,302,293,259,229,203,229,242,233,267,269,270,315,364,347,312,274,237,278,284,277,317,313,318,374,413,405,355,306,271,306,315,301,356,348,355,422,465,467,404,347,305,336,340,318,362,348,363,435,491,505,404,359,310,337,360,342,406,396,420,472,548,559,463,407,362,405,417,391,419,461,472,535,622,606,508,461,390,432],"text":[".index: 1949-01-01<br />.value: 112.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-02-01<br />.value: 118.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-03-01<br />.value: 132.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-04-01<br />.value: 129.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-05-01<br />.value: 121.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-06-01<br />.value: 135.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-07-01<br />.value: 148.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-08-01<br />.value: 148.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-09-01<br />.value: 136.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-10-01<br />.value: 119.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-11-01<br />.value: 104.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-12-01<br />.value: 118.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-01-01<br />.value: 115.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-02-01<br />.value: 126.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-03-01<br />.value: 141.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-04-01<br />.value: 135.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-05-01<br />.value: 125.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-06-01<br />.value: 149.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-07-01<br />.value: 170.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-08-01<br />.value: 170.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-09-01<br />.value: 158.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-10-01<br />.value: 133.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-11-01<br />.value: 114.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-12-01<br />.value: 140.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-01-01<br />.value: 145.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-02-01<br />.value: 150.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-03-01<br />.value: 178.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-04-01<br />.value: 163.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-05-01<br />.value: 172.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-06-01<br />.value: 178.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-07-01<br />.value: 199.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-08-01<br />.value: 199.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-09-01<br />.value: 184.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-10-01<br />.value: 162.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-11-01<br />.value: 146.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-12-01<br />.value: 166.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-01-01<br />.value: 171.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-02-01<br />.value: 180.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-03-01<br />.value: 193.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-04-01<br />.value: 181.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-05-01<br />.value: 183.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-06-01<br />.value: 218.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-07-01<br />.value: 230.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-08-01<br />.value: 242.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-09-01<br />.value: 209.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-10-01<br />.value: 191.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-11-01<br />.value: 172.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-12-01<br />.value: 194.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-01-01<br />.value: 196.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-02-01<br />.value: 196.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-03-01<br />.value: 236.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-04-01<br />.value: 235.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-05-01<br />.value: 229.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-06-01<br />.value: 243.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-07-01<br />.value: 264.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-08-01<br />.value: 272.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-09-01<br />.value: 237.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-10-01<br />.value: 211.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-11-01<br />.value: 180.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-12-01<br />.value: 201.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-01-01<br />.value: 204.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-02-01<br />.value: 188.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-03-01<br />.value: 235.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-04-01<br />.value: 227.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-05-01<br />.value: 234.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-06-01<br />.value: 264.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-07-01<br />.value: 302.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-08-01<br />.value: 293.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-09-01<br />.value: 259.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-10-01<br />.value: 229.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-11-01<br />.value: 203.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-12-01<br />.value: 229.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-01-01<br />.value: 242.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-02-01<br />.value: 233.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-03-01<br />.value: 267.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-04-01<br />.value: 269.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-05-01<br />.value: 270.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-06-01<br />.value: 315.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-07-01<br />.value: 364.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-08-01<br />.value: 347.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-09-01<br />.value: 312.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-10-01<br />.value: 274.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-11-01<br />.value: 237.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-12-01<br />.value: 278.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-01-01<br />.value: 284.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-02-01<br />.value: 277.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-03-01<br />.value: 317.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-04-01<br />.value: 313.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-05-01<br />.value: 318.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-06-01<br />.value: 374.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-07-01<br />.value: 413.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-08-01<br />.value: 405.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-09-01<br />.value: 355.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-10-01<br />.value: 306.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-11-01<br />.value: 271.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-12-01<br />.value: 306.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-01-01<br />.value: 315.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-02-01<br />.value: 301.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-03-01<br />.value: 356.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-04-01<br />.value: 348.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-05-01<br />.value: 355.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-06-01<br />.value: 422.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-07-01<br />.value: 465.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-08-01<br />.value: 467.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-09-01<br />.value: 404.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-10-01<br />.value: 347.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-11-01<br />.value: 305.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-12-01<br />.value: 336.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-01-01<br />.value: 340.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-02-01<br />.value: 318.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-03-01<br />.value: 362.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-04-01<br />.value: 348.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-05-01<br />.value: 363.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-06-01<br />.value: 435.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-07-01<br />.value: 491.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-08-01<br />.value: 505.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-09-01<br />.value: 404.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-10-01<br />.value: 359.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-11-01<br />.value: 310.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-12-01<br />.value: 337.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-01-01<br />.value: 360.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-02-01<br />.value: 342.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-03-01<br />.value: 406.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-04-01<br />.value: 396.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-05-01<br />.value: 420.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-06-01<br />.value: 472.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-07-01<br />.value: 548.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-08-01<br />.value: 559.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-09-01<br />.value: 463.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-10-01<br />.value: 407.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-11-01<br />.value: 362.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-12-01<br />.value: 405.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-01-01<br />.value: 417.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-02-01<br />.value: 391.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-03-01<br />.value: 419.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-04-01<br />.value: 461.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-05-01<br />.value: 472.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-06-01<br />.value: 535.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-07-01<br />.value: 622.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-08-01<br />.value: 606.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-09-01<br />.value: 508.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-10-01<br />.value: 461.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-11-01<br />.value: 390.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-12-01<br />.value: 432.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["1960-01-01","1960-02-01","1960-03-01","1960-04-01","1960-05-01","1960-06-01","1960-07-01","1960-08-01","1960-09-01","1960-10-01","1960-11-01","1960-12-01"],"y":[424.10989389354904,407.05570173851447,470.8257459339377,460.88165546391258,484.86806208866483,536.87136706816841,612.87056352310901,623.87075889033031,527.87071139037903,471.87072293911967,426.87072013125544,469.87072081393603],"text":[".index: 1960-01-01<br />.value: 424.1099<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-02-01<br />.value: 407.0557<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-03-01<br />.value: 470.8257<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-04-01<br />.value: 460.8817<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-05-01<br />.value: 484.8681<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-06-01<br />.value: 536.8714<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-07-01<br />.value: 612.8706<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-08-01<br />.value: 623.8708<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-09-01<br />.value: 527.8707<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-10-01<br />.value: 471.8707<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-11-01<br />.value: 426.8707<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-12-01<br />.value: 469.8707<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"1_ARIMA(1,1,0)(0,1,0)[12]","legendgroup":"1_ARIMA(1,1,0)(0,1,0)[12]","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":25.570776255707766,"l":28.493150684931514},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.611872146118724},"title":{"text":"Forecast Plot","font":{"color":"rgba(44,62,80,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["1948-05-28","1961-07-06"],"tickmode":"auto","ticktext":["1950","1955","1960"],"tickvals":[-7305,-5479,-3653],"categoryorder":"array","categoryarray":["1950","1955","1960"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.6529680365296811,"tickwidth":0.22139200221392005,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392005,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[78.006462055483482,649.86429683484687],"tickmode":"auto","ticktext":["200","400","600"],"tickvals":[200,400,600],"categoryorder":"array","categoryarray":["200","400","600"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.6529680365296811,"tickwidth":0.22139200221392005,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392005,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088001,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.68949771689498},"title":{"text":"Legend","font":{"color":"rgba(44,62,80,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"21c1c22705e":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"21c1c22705e","visdat":{"21c1c22705e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Finally enhancement to add attributes to <code>ts_growth_rate_vec()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_growth_rate_vec</span>(AirPassengers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]          NA   5.3571429  11.8644068  -2.2727273  -6.2015504  11.5702479
  [7]   9.6296296   0.0000000  -8.1081081 -12.5000000 -12.6050420  13.4615385
 [13]  -2.5423729   9.5652174  11.9047619  -4.2553191  -7.4074074  19.2000000
 [19]  14.0939597   0.0000000  -7.0588235 -15.8227848 -14.2857143  22.8070175
 [25]   3.5714286   3.4482759  18.6666667  -8.4269663   5.5214724   3.4883721
 [31]  11.7977528   0.0000000  -7.5376884 -11.9565217  -9.8765432  13.6986301
 [37]   3.0120482   5.2631579   7.2222222  -6.2176166   1.1049724  19.1256831
 [43]   5.5045872   5.2173913 -13.6363636  -8.6124402  -9.9476440  12.7906977
 [49]   1.0309278   0.0000000  20.4081633  -0.4237288  -2.5531915   6.1135371
 [55]   8.6419753   3.0303030 -12.8676471 -10.9704641 -14.6919431  11.6666667
 [61]   1.4925373  -7.8431373  25.0000000  -3.4042553   3.0837004  12.8205128
 [67]  14.3939394  -2.9801325 -11.6040956 -11.5830116 -11.3537118  12.8078818
 [73]   5.6768559  -3.7190083  14.5922747   0.7490637   0.3717472  16.6666667
 [79]  15.5555556  -4.6703297 -10.0864553 -12.1794872 -13.5036496  17.2995781
 [85]   2.1582734  -2.4647887  14.4404332  -1.2618297   1.5974441  17.6100629
 [91]  10.4278075  -1.9370460 -12.3456790 -13.8028169 -11.4379085  12.9151292
 [97]   2.9411765  -4.4444444  18.2724252  -2.2471910   2.0114943  18.8732394
[103]  10.1895735   0.4301075 -13.4903640 -14.1089109 -12.1037464  10.1639344
[109]   1.1904762  -6.4705882  13.8364780  -3.8674033   4.3103448  19.8347107
[115]  12.8735632   2.8513238 -20.0000000 -11.1386139 -13.6490251   8.7096774
[121]   6.8249258  -5.0000000  18.7134503  -2.4630542   6.0606061  12.3809524
[127]  16.1016949   2.0072993 -17.1735242 -12.0950324 -11.0565111  11.8784530
[133]   2.9629630  -6.2350120   7.1611253  10.0238663   2.3861171  13.3474576
[139]  16.2616822  -2.5723473 -16.1716172  -9.2519685 -15.4013015  10.7692308
attr(,"vector_attributes")
attr(,"vector_attributes")$tsp
[1] 1949.000 1960.917   12.000

attr(,"vector_attributes")$class
[1] "ts"

attr(,"name")
[1] "AirPassengers"</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>