<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Steven P. Sanderson II, MPH">
<meta name="dcterms.date" content="2024-09-04">
<meta name="keywords" content="Programming, Case-Insensitive grep in R, grep in R example, R grep case insensitive, How to use case-insensitive grep in R for text analysis">

<title>Steve’s Data Tips and Tricks - Harness the Full Potential of Case-Insensitive Searches with grep() in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JSJCM62KQJ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-JSJCM62KQJ', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Steve’s Data Tips and Tricks - Harness the Full Potential of Case-Insensitive Searches with grep() in R">
<meta property="og:description" content="">
<meta property="og:site_name" content="Steve's Data Tips and Tricks">
<meta name="twitter:title" content="Steve’s Data Tips and Tricks - Harness the Full Potential of Case-Insensitive Searches with grep() in R">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@steveondata">
<meta name="twitter:site" content="@steveondata">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Steve’s Data Tips and Tricks</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/spsanderson"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://t.me/steveondata"> <i class="bi bi-telegram" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://feeds.feedburner.com/RBloggers"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.r-bloggers.com/"> <i class="bi bi-book" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.r-users.com/"> <i class="bi bi-briefcase" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Harness the Full Potential of Case-Insensitive Searches with grep() in R</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">rtip</div>
                <div class="quarto-category">grep</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Steven P. Sanderson II, MPH </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 4, 2024</p>
      </div>
    </div>
    
      
    </div>
    

  <div>
    <div class="keywords">
      <div class="block-title">Keywords</div>
      <p>Programming, Case-Insensitive grep in R, grep in R example, R grep case insensitive, How to use case-insensitive grep in R for text analysis</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-to-grep-in-r" id="toc-introduction-to-grep-in-r" class="nav-link active" data-scroll-target="#introduction-to-grep-in-r">Introduction to <code>grep()</code> in R</a>
  <ul class="collapse">
  <li><a href="#why-use-case-insensitive-grep" id="toc-why-use-case-insensitive-grep" class="nav-link" data-scroll-target="#why-use-case-insensitive-grep">Why Use Case-Insensitive <code>grep()</code>?</a></li>
  <li><a href="#basic-syntax-of-grep-in-r" id="toc-basic-syntax-of-grep-in-r" class="nav-link" data-scroll-target="#basic-syntax-of-grep-in-r">Basic Syntax of <code>grep()</code> in R</a></li>
  </ul></li>
  <li><a href="#how-to-use-case-insensitive-grep-in-r" id="toc-how-to-use-case-insensitive-grep-in-r" class="nav-link" data-scroll-target="#how-to-use-case-insensitive-grep-in-r">How to Use Case-Insensitive <code>grep()</code> in R</a>
  <ul class="collapse">
  <li><a href="#using-grep-with-ignore.case-true" id="toc-using-grep-with-ignore.case-true" class="nav-link" data-scroll-target="#using-grep-with-ignore.case-true">Using <code>grep()</code> with <code>ignore.case = TRUE</code></a></li>
  <li><a href="#practical-examples-of-case-insensitive-grep" id="toc-practical-examples-of-case-insensitive-grep" class="nav-link" data-scroll-target="#practical-examples-of-case-insensitive-grep">Practical Examples of Case-Insensitive <code>grep()</code></a>
  <ul class="collapse">
  <li><a href="#example-1-searching-within-a-character-vector" id="toc-example-1-searching-within-a-character-vector" class="nav-link" data-scroll-target="#example-1-searching-within-a-character-vector"><strong>Example 1: Searching within a Character Vector</strong></a></li>
  <li><a href="#example-2-searching-within-a-data-frame-column" id="toc-example-2-searching-within-a-data-frame-column" class="nav-link" data-scroll-target="#example-2-searching-within-a-data-frame-column"><strong>Example 2: Searching within a Data Frame Column</strong></a></li>
  <li><a href="#example-3-using-grep-with-regular-expressions" id="toc-example-3-using-grep-with-regular-expressions" class="nav-link" data-scroll-target="#example-3-using-grep-with-regular-expressions"><strong>Example 3: Using <code>grep()</code> with Regular Expressions</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#difference-between-grep-grepl-regexpr-and-gregexpr" id="toc-difference-between-grep-grepl-regexpr-and-gregexpr" class="nav-link" data-scroll-target="#difference-between-grep-grepl-regexpr-and-gregexpr">Difference Between <code>grep()</code>, <code>grepl()</code>, <code>regexpr()</code>, and <code>gregexpr()</code></a></li>
  <li><a href="#common-mistakes-when-using-case-insensitive-grep" id="toc-common-mistakes-when-using-case-insensitive-grep" class="nav-link" data-scroll-target="#common-mistakes-when-using-case-insensitive-grep">Common Mistakes When Using Case-Insensitive <code>grep()</code></a></li>
  <li><a href="#advanced-usage-of-grep-in-r" id="toc-advanced-usage-of-grep-in-r" class="nav-link" data-scroll-target="#advanced-usage-of-grep-in-r">Advanced Usage of <code>grep()</code> in R</a>
  <ul class="collapse">
  <li><a href="#combining-grep-with-subset-for-data-frame-filtering" id="toc-combining-grep-with-subset-for-data-frame-filtering" class="nav-link" data-scroll-target="#combining-grep-with-subset-for-data-frame-filtering"><strong>Combining <code>grep()</code> with <code>subset()</code> for Data Frame Filtering:</strong></a></li>
  <li><a href="#using-grep-in-data-cleaning" id="toc-using-grep-in-data-cleaning" class="nav-link" data-scroll-target="#using-grep-in-data-cleaning"><strong>Using <code>grep()</code> in Data Cleaning:</strong></a></li>
  <li><a href="#case-insensitive-search-with-multiple-patterns" id="toc-case-insensitive-search-with-multiple-patterns" class="nav-link" data-scroll-target="#case-insensitive-search-with-multiple-patterns"><strong>Case-Insensitive Search with Multiple Patterns:</strong></a></li>
  </ul></li>
  <li><a href="#performance-considerations-for-case-insensitive-grep" id="toc-performance-considerations-for-case-insensitive-grep" class="nav-link" data-scroll-target="#performance-considerations-for-case-insensitive-grep">Performance Considerations for Case-Insensitive <code>grep()</code></a>
  <ul class="collapse">
  <li><a href="#example-of-performance-optimization" id="toc-example-of-performance-optimization" class="nav-link" data-scroll-target="#example-of-performance-optimization"><strong>Example of Performance Optimization:</strong></a></li>
  </ul></li>
  <li><a href="#troubleshooting-and-debugging-grep-issues" id="toc-troubleshooting-and-debugging-grep-issues" class="nav-link" data-scroll-target="#troubleshooting-and-debugging-grep-issues">Troubleshooting and Debugging <code>grep()</code> Issues</a>
  <ul class="collapse">
  <li><a href="#example-of-debugging-a-common-grep-error" id="toc-example-of-debugging-a-common-grep-error" class="nav-link" data-scroll-target="#example-of-debugging-a-common-grep-error"><strong>Example of Debugging a Common <code>grep()</code> Error:</strong></a></li>
  </ul></li>
  <li><a href="#alternative-methods-for-case-insensitive-search-in-r" id="toc-alternative-methods-for-case-insensitive-search-in-r" class="nav-link" data-scroll-target="#alternative-methods-for-case-insensitive-search-in-r">Alternative Methods for Case-Insensitive Search in R</a></li>
  <li><a href="#combining-grep-with-other-functions-for-data-analysis" id="toc-combining-grep-with-other-functions-for-data-analysis" class="nav-link" data-scroll-target="#combining-grep-with-other-functions-for-data-analysis">Combining <code>grep()</code> with Other Functions for Data Analysis</a>
  <ul class="collapse">
  <li><a href="#filtering-data-frames-with-case-insensitive-search" id="toc-filtering-data-frames-with-case-insensitive-search" class="nav-link" data-scroll-target="#filtering-data-frames-with-case-insensitive-search"><strong>Filtering Data Frames with Case-Insensitive Search:</strong></a></li>
  <li><a href="#combining-grep-with-lapply-and-sapply" id="toc-combining-grep-with-lapply-and-sapply" class="nav-link" data-scroll-target="#combining-grep-with-lapply-and-sapply"><strong>Combining <code>grep()</code> with <code>lapply()</code> and <code>sapply()</code>:</strong></a></li>
  </ul></li>
  <li><a href="#case-studies-and-examples" id="toc-case-studies-and-examples" class="nav-link" data-scroll-target="#case-studies-and-examples">Case Studies and Examples</a>
  <ul class="collapse">
  <li><a href="#example-1-case-insensitive-search-in-a-text-mining-project" id="toc-example-1-case-insensitive-search-in-a-text-mining-project" class="nav-link" data-scroll-target="#example-1-case-insensitive-search-in-a-text-mining-project"><strong>Example 1: Case-Insensitive Search in a Text Mining Project</strong></a></li>
  <li><a href="#example-2-data-cleaning-and-preparation-using-grep" id="toc-example-2-data-cleaning-and-preparation-using-grep" class="nav-link" data-scroll-target="#example-2-data-cleaning-and-preparation-using-grep"><strong>Example 2: Data Cleaning and Preparation Using <code>grep()</code></strong></a></li>
  <li><a href="#example-3-real-world-example-from-bioinformatics-data-analysis" id="toc-example-3-real-world-example-from-bioinformatics-data-analysis" class="nav-link" data-scroll-target="#example-3-real-world-example-from-bioinformatics-data-analysis"><strong>Example 3: Real-World Example from Bioinformatics Data Analysis</strong></a></li>
  </ul></li>
  <li><a href="#best-practices-for-using-grep-in-r" id="toc-best-practices-for-using-grep-in-r" class="nav-link" data-scroll-target="#best-practices-for-using-grep-in-r">Best Practices for Using <code>grep()</code> in R</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction-to-grep-in-r" class="level1">
<h1>Introduction to <code>grep()</code> in R</h1>
<p>The <code>grep()</code> function in R is a powerful tool for searching and matching patterns within text data. It is commonly used in data cleaning, manipulation, and text analysis to find specific patterns or values in strings or data frames. By default, <code>grep()</code> performs a case-sensitive search, meaning it distinguishes between uppercase and lowercase characters.</p>
<p>This case sensitivity can be restrictive in scenarios where you want to match text regardless of case. Fortunately, <code>grep()</code> has an <code>ignore.case</code> argument that allows for case-insensitive matching, making it more flexible and powerful in handling textual data.</p>
<section id="why-use-case-insensitive-grep" class="level2">
<h2 class="anchored" data-anchor-id="why-use-case-insensitive-grep">Why Use Case-Insensitive <code>grep()</code>?</h2>
<p>Using case-insensitive <code>grep()</code> is particularly useful in various scenarios, such as:</p>
<ul>
<li><p><strong>Text Mining and Natural Language Processing (NLP):</strong> In text analysis, you might need to search for a keyword or phrase regardless of its capitalization in the text data. For example, finding occurrences of the word “RStudio” should match “RStudio”, “rstudio”, “RSTUDIO”, etc.</p></li>
<li><p><strong>Data Cleaning:</strong> In datasets, especially those containing user-generated content, there can be inconsistencies in capitalization. Using case-insensitive <code>grep()</code> helps in uniformly identifying records that should be treated as equivalent.</p></li>
<li><p><strong>General Data Analysis:</strong> Case insensitivity is beneficial when working with categorical data or any situation where matching text needs to be more forgiving regarding capitalization differences.</p></li>
</ul>
</section>
<section id="basic-syntax-of-grep-in-r" class="level2">
<h2 class="anchored" data-anchor-id="basic-syntax-of-grep-in-r">Basic Syntax of <code>grep()</code> in R</h2>
<p>The basic syntax for <code>grep()</code> in R is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  pattern, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  x, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ignore.case =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">useBytes =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">invert =</span> <span class="cn">FALSE</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here’s a breakdown of the main arguments:</p>
<ul>
<li><strong><code>pattern</code>:</strong> A character string containing a regular expression to be matched in the <code>x</code> argument.</li>
<li><strong><code>x</code>:</strong> A character vector where the function will search for the pattern.</li>
<li><strong><code>ignore.case</code>:</strong> A logical argument; if set to <code>TRUE</code>, the pattern matching is case-insensitive.</li>
<li><strong><code>value</code>:</strong> A logical argument; if set to <code>TRUE</code>, the function returns the values of the matching elements rather than their indices.</li>
<li><strong><code>fixed</code>:</strong> A logical argument; if set to <code>TRUE</code>, <code>grep()</code> will search for the exact pattern rather than treating it as a regular expression.</li>
<li><strong><code>useBytes</code>:</strong> If <code>TRUE</code>, matching is done byte-by-byte rather than character-by-character.</li>
<li><strong><code>invert</code>:</strong> If <code>TRUE</code>, returns elements that do not match the pattern.</li>
</ul>
<p>Using <code>ignore.case = TRUE</code> allows <code>grep()</code> to perform case-insensitive matching. Here is a simple example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of case-insensitive grep</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>text_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Apple"</span>, <span class="st">"banana"</span>, <span class="st">"Cherry"</span>, <span class="st">"apple"</span>, <span class="st">"BANANA"</span>, <span class="st">"cherry"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Case-insensitive search for "apple"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">"apple"</span>, text_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 4</code></pre>
</div>
</div>
<p>This code will return the indices of all elements in <code>text_vector</code> that match “apple” regardless of their case, i.e., both “Apple” and “apple”.</p>
</section>
</section>
<section id="how-to-use-case-insensitive-grep-in-r" class="level1">
<h1>How to Use Case-Insensitive <code>grep()</code> in R</h1>
<section id="using-grep-with-ignore.case-true" class="level2">
<h2 class="anchored" data-anchor-id="using-grep-with-ignore.case-true">Using <code>grep()</code> with <code>ignore.case = TRUE</code></h2>
<p>To perform a case-insensitive search using <code>grep()</code>, you simply need to set the <code>ignore.case</code> parameter to <code>TRUE</code>. This will allow the function to match the specified pattern regardless of whether the characters in the pattern or the search vector are uppercase or lowercase.</p>
<p><strong>Syntax for Case-Insensitive <code>grep()</code></strong>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(pattern, x, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Example Usage:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of using grep with ignore.case = TRUE</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>text_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DataScience"</span>, <span class="st">"datascience"</span>, <span class="st">"DATA"</span>, <span class="st">"science"</span>, <span class="st">"Science"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Case-insensitive search for "science"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"science"</span>, text_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Output:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 4 5</code></pre>
</div>
</div>
<p>In this example, <code>grep()</code> searches for the pattern “science” in the <code>text_vector</code>. By setting <code>ignore.case = TRUE</code>, it matches all instances where “science” appears, regardless of capitalization.</p>
</section>
<section id="practical-examples-of-case-insensitive-grep" class="level2">
<h2 class="anchored" data-anchor-id="practical-examples-of-case-insensitive-grep">Practical Examples of Case-Insensitive <code>grep()</code></h2>
<section id="example-1-searching-within-a-character-vector" class="level3">
<h3 class="anchored" data-anchor-id="example-1-searching-within-a-character-vector"><strong>Example 1: Searching within a Character Vector</strong></h3>
<p>Consider a scenario where you have a character vector containing various fruit names, and you want to find all instances of “apple”, regardless of how they are capitalized.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fruits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Apple"</span>, <span class="st">"Banana"</span>, <span class="st">"apple"</span>, <span class="st">"Cherry"</span>, <span class="st">"APPLE"</span>, <span class="st">"banana"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Case-insensitive search for "apple"</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>apple_indices <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"apple"</span>, fruits, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(apple_indices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 3 5</code></pre>
</div>
</div>
<p><strong>Output:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(apple_indices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 3 5</code></pre>
</div>
</div>
<p>The function returns the indices where “apple” is found, ignoring case differences.</p>
</section>
<section id="example-2-searching-within-a-data-frame-column" class="level3">
<h3 class="anchored" data-anchor-id="example-2-searching-within-a-data-frame-column"><strong>Example 2: Searching within a Data Frame Column</strong></h3>
<p>You can also use <code>grep()</code> with <code>ignore.case = TRUE</code> to search within a data frame column. Suppose you have a data frame of customer reviews and you want to find all reviews that mention the word “service” in any case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>reviews <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Review =</span> <span class="fu">c</span>(<span class="st">"Excellent service"</span>, <span class="st">"Bad Service"</span>, <span class="st">"Great food"</span>, <span class="st">"SERVICE is poor"</span>, <span class="st">"friendly staff"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Case-insensitive search for "service"</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>service_reviews <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"service"</span>, reviews<span class="sc">$</span>Review, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Output:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(reviews[service_reviews, ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID            Review
1  1 Excellent service
2  2       Bad Service
4  4   SERVICE is poor</code></pre>
</div>
</div>
<p>This example shows how to filter a data frame to retrieve rows where the “Review” column mentions “service” in any form.</p>
</section>
<section id="example-3-using-grep-with-regular-expressions" class="level3">
<h3 class="anchored" data-anchor-id="example-3-using-grep-with-regular-expressions"><strong>Example 3: Using <code>grep()</code> with Regular Expressions</strong></h3>
<p><code>grep()</code> supports regular expressions, allowing you to perform complex searches. For instance, you may want to find strings that start with “data” regardless of case:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example text vector</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>text_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DataScience"</span>, <span class="st">"datascience"</span>, <span class="st">"DATA mining"</span>, <span class="st">"Analysis"</span>, <span class="st">"data-analysis"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Case-insensitive search for words starting with "data"</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>data_indices <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"^data"</span>, text_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Output:</strong></p>
<pre><code>print(data_indices)</code></pre>
<p>The function uses the regular expression <code>^data</code> to find any word starting with “data” in any capitalization.</p>
</section>
</section>
</section>
<section id="difference-between-grep-grepl-regexpr-and-gregexpr" class="level1">
<h1>Difference Between <code>grep()</code>, <code>grepl()</code>, <code>regexpr()</code>, and <code>gregexpr()</code></h1>
<p>In R, there are several functions for pattern matching, each with different functionalities and use cases:</p>
<ul>
<li><p><strong><code>grep()</code>:</strong> Returns the indices of the elements that match the pattern. When <code>value = TRUE</code>, it returns the matching elements themselves.</p></li>
<li><p><strong><code>grepl()</code>:</strong> Returns a logical vector indicating if there is a match or not for each element of the input vector.</p></li>
<li><p><strong><code>regexpr()</code>:</strong> Returns a vector of the same length as the input with the starting position of the first match or -1 if there is no match. It also returns the match length as an attribute.</p></li>
<li><p><strong><code>gregexpr()</code>:</strong> Similar to <code>regexpr()</code>, but returns a list of the starting positions of all matches.</p></li>
</ul>
<p><strong>Key Differences and Use Cases:</strong></p>
<ul>
<li>Use <code>grep()</code> when you need the indices or values of matching elements.</li>
<li>Use <code>grepl()</code> when you need a logical vector to use in conditional statements or filtering.</li>
<li>Use <code>regexpr()</code> when you need the position and length of the first match.</li>
<li>Use <code>gregexpr()</code> when you need the positions of all matches within each element of the input vector.</li>
</ul>
<p><strong>Example Comparison:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>text_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"data science"</span>, <span class="st">"Data Mining"</span>, <span class="st">"analysis"</span>, <span class="st">"data-visualization"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using grep()</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>grep_result <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"data"</span>, text_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Using grepl()</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>grepl_result <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"data"</span>, text_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Using regexpr()</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>regexpr_result <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="st">"data"</span>, text_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Using gregexpr()</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>gregexpr_result <span class="ot">&lt;-</span> <span class="fu">gregexpr</span>(<span class="st">"data"</span>, text_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(grep_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(grepl_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(regexpr_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  1 -1  1
attr(,"match.length")
[1]  4  4 -1  4
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gregexpr_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1
attr(,"match.length")
[1] 4
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE

[[2]]
[1] 1
attr(,"match.length")
[1] 4
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE

[[3]]
[1] -1
attr(,"match.length")
[1] -1
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE

[[4]]
[1] 1
attr(,"match.length")
[1] 4
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE</code></pre>
</div>
</div>
<p>These functions provide flexibility in text processing tasks, and choosing the right function depends on the specific requirement of your analysis.</p>
</section>
<section id="common-mistakes-when-using-case-insensitive-grep" class="level1">
<h1>Common Mistakes When Using Case-Insensitive <code>grep()</code></h1>
<p>While using the <code>grep()</code> function with <code>ignore.case = TRUE</code>, it’s essential to be aware of some common mistakes that can lead to errors or unexpected results:</p>
<ul>
<li><strong>Forgetting to Set <code>ignore.case = TRUE</code>:</strong> By default, <code>grep()</code> is case-sensitive. If you forget to set <code>ignore.case = TRUE</code>, the function will not match patterns with different capitalization, leading to incomplete results.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorrect usage without ignore.case = TRUE</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>text_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"apple"</span>, <span class="st">"Apple"</span>, <span class="st">"APPLE"</span>, <span class="st">"banana"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"apple"</span>, text_vector)  <span class="co"># This will only match the first "apple"</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<ul>
<li><strong>Misunderstanding the Output Format:</strong> By default, <code>grep()</code> returns the indices of the matching elements. To get the matching elements themselves, you need to set <code>value = TRUE</code>. Failing to do so can cause confusion.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct usage to return values</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>matching_values <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"apple"</span>, text_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(matching_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "apple" "Apple" "APPLE"</code></pre>
</div>
</div>
<ul>
<li><strong>Issues with Pattern Syntax in Regular Expressions:</strong> <code>grep()</code> uses regular expressions (regex) for pattern matching. A common mistake is not escaping special characters or using incorrect syntax in the pattern, which can cause <code>grep()</code> to behave unexpectedly.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorrect regex pattern without escape</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>text_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"abc.def"</span>, <span class="st">"abc-def"</span>, <span class="st">"abcdef"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"abc.def"</span>, text_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct regex pattern with escape</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>correct_result <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"abc</span><span class="sc">\\</span><span class="st">.def"</span>, text_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(correct_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="advanced-usage-of-grep-in-r" class="level1">
<h1>Advanced Usage of <code>grep()</code> in R</h1>
<p>The <code>grep()</code> function can be combined with other functions in R to perform advanced data manipulation and cleaning tasks. Here are some examples:</p>
<section id="combining-grep-with-subset-for-data-frame-filtering" class="level2">
<h2 class="anchored" data-anchor-id="combining-grep-with-subset-for-data-frame-filtering"><strong>Combining <code>grep()</code> with <code>subset()</code> for Data Frame Filtering:</strong></h2>
<p>You can use <code>grep()</code> inside <code>subset()</code> to filter data frames based on a pattern match:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product =</span> <span class="fu">c</span>(</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Apple Juice"</span>, </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Banana Shake"</span>, </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"apple pie"</span>, </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cherry Tart"</span>, </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"APPLE Cider"</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data frame to include only rows with "apple" in any case</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>apple_products <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, <span class="fu">grepl</span>(<span class="st">"apple"</span>, Product, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Output:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(apple_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID     Product
1  1 Apple Juice
3  3   apple pie
5  5 APPLE Cider</code></pre>
</div>
</div>
</section>
<section id="using-grep-in-data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="using-grep-in-data-cleaning"><strong>Using <code>grep()</code> in Data Cleaning:</strong></h2>
<p><code>grep()</code> can help clean and standardize text data by identifying and replacing patterns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of cleaning data</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>names_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"John Doe"</span>, <span class="st">"john doe"</span>, <span class="st">"JOHN DOE"</span>, <span class="st">"Jane Smith"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize all names to title case</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>standardized_names <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"john doe"</span>, <span class="st">"John Doe"</span>, names_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Output:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(standardized_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "John Doe"   "John Doe"   "John Doe"   "Jane Smith"</code></pre>
</div>
</div>
</section>
<section id="case-insensitive-search-with-multiple-patterns" class="level2">
<h2 class="anchored" data-anchor-id="case-insensitive-search-with-multiple-patterns"><strong>Case-Insensitive Search with Multiple Patterns:</strong></h2>
<p>To search for multiple patterns simultaneously, you can use the <code>|</code> operator in regular expressions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>text_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"apple"</span>, <span class="st">"Apple"</span>, <span class="st">"APPLE"</span>, <span class="st">"banana"</span>, <span class="st">"Banana"</span>, <span class="st">"BANANA"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Search for multiple patterns "apple" or "banana"</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"apple|banana"</span>, text_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Output:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "apple"  "Apple"  "APPLE"  "banana" "Banana" "BANANA"</code></pre>
</div>
</div>
</section>
</section>
<section id="performance-considerations-for-case-insensitive-grep" class="level1">
<h1>Performance Considerations for Case-Insensitive <code>grep()</code></h1>
<p>While <code>grep()</code> is a powerful function, it’s important to consider its performance, especially when working with large datasets:</p>
<ul>
<li><p><strong>Impact of <code>ignore.case = TRUE</code> on Performance:</strong> Enabling case insensitivity (<code>ignore.case = TRUE</code>) can slightly increase the computational load, as R needs to convert each character to a common case (usually lowercase) before performing the pattern match. However, this is generally a minor impact unless working with extremely large datasets.</p></li>
<li><p><strong>Optimizing <code>grep()</code> Performance:</strong></p>
<ul>
<li><strong>Use Specific Patterns:</strong> More specific patterns reduce the number of potential matches and improve performance.</li>
<li><strong>Limit Data Scope:</strong> Apply <code>grep()</code> to a specific subset of data instead of a full dataset to reduce computation time.</li>
<li><strong>Use Vectorized Functions:</strong> Combining <code>grep()</code> with other vectorized functions like <code>sapply()</code> or <code>vapply()</code> can leverage R’s vectorized computation capabilities.</li>
</ul></li>
</ul>
<section id="example-of-performance-optimization" class="level2">
<h2 class="anchored" data-anchor-id="example-of-performance-optimization"><strong>Example of Performance Optimization:</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Large vector for demonstration</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>large_vector <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"cherry"</span>), <span class="at">times =</span> <span class="fl">1e6</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Case-insensitive search optimized with specific pattern</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>optimized_result <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"^a"</span>, large_vector, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Output:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(optimized_result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1000000</code></pre>
</div>
</div>
<p>By understanding and applying these performance considerations, you can use <code>grep()</code> efficiently even on large datasets.</p>
</section>
</section>
<section id="troubleshooting-and-debugging-grep-issues" class="level1">
<h1>Troubleshooting and Debugging <code>grep()</code> Issues</h1>
<p>Using <code>grep()</code> effectively requires understanding how to troubleshoot common issues. Here are some tips for identifying and resolving problems when using <code>grep()</code> with <code>ignore.case = TRUE</code>:</p>
<ul>
<li><p><strong>Common Errors and Warnings:</strong></p>
<ul>
<li><strong>Warning: <code>invalid regular expression</code>:</strong> This error occurs when there is a syntax error in the pattern. Ensure that special characters are properly escaped (e.g., using <code>\\.</code> for a literal period).</li>
<li><strong>No Matches Found:</strong> If <code>grep()</code> returns no matches, double-check that <code>ignore.case</code> is set correctly and that the pattern exists in the input vector.</li>
</ul></li>
<li><p><strong>Interpreting <code>grep()</code> Results:</strong></p></li>
<li><p>If <code>grep()</code> returns an empty result or unexpected indices, verify that the <code>pattern</code> argument accurately reflects the search criteria and that <code>ignore.case = TRUE</code> is set if needed.</p></li>
<li><p><strong>Debugging Tips for Complex Patterns:</strong></p></li>
<li><p><strong>Test Patterns with Simple Data:</strong> Start with a small, simple vector to ensure the pattern works correctly before applying it to larger datasets.</p></li>
<li><p><strong>Use <code>print()</code> Statements:</strong> Insert <code>print()</code> statements to check intermediate results and understand how <code>grep()</code> processes the data.</p></li>
<li><p><strong>Visualize the Data:</strong> Sometimes, printing or plotting the data can help understand why certain patterns are not being matched.</p></li>
</ul>
<section id="example-of-debugging-a-common-grep-error" class="level2">
<h2 class="anchored" data-anchor-id="example-of-debugging-a-common-grep-error"><strong>Example of Debugging a Common <code>grep()</code> Error:</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorrect pattern causing an error</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>text_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"file1.txt"</span>, <span class="st">"file2.csv"</span>, <span class="st">"file3.txt"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># grep("file[.]", text_vector) # This will cause an error</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct pattern with escape character</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>correct_result <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"file</span><span class="sc">\\</span><span class="st">."</span>, text_vector)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(correct_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
</div>
</section>
</section>
<section id="alternative-methods-for-case-insensitive-search-in-r" class="level1">
<h1>Alternative Methods for Case-Insensitive Search in R</h1>
<p>While <code>grep()</code> is a versatile function for pattern matching, there are alternative methods and functions in R that provide case-insensitive search capabilities:</p>
<ul>
<li><strong><code>stringr</code> Package Functions:</strong> The <code>stringr</code> package offers several functions that simplify string manipulation and pattern matching. For case-insensitive searches, you can use <code>str_detect()</code> and <code>str_subset()</code> with <code>regex()</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of case-insensitive search using stringr</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>text_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DataScience"</span>, <span class="st">"datascience"</span>, <span class="st">"DATA"</span>, <span class="st">"science"</span>, <span class="st">"Science"</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Case-insensitive search with str_detect</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>str_result <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(text_vector, <span class="fu">regex</span>(<span class="st">"science"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(str_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE  TRUE  TRUE</code></pre>
</div>
</div>
<p><strong><code>tolower()</code> and <code>toupper()</code> Functions:</strong> Another approach is to convert all text to a common case (lower or upper) before using <code>grep()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to lowercase for case-insensitive search</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>lower_text_vector <span class="ot">&lt;-</span> <span class="fu">tolower</span>(text_vector)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">"science"</span>, lower_text_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 4 5</code></pre>
</div>
</div>
<ul>
<li><strong>Comparison with <code>grep()</code>:</strong>
<ul>
<li><strong>Pros:</strong> Functions from the <code>stringr</code> package are generally more user-friendly and often provide clearer error messages. They also integrate well with <code>dplyr</code> for data manipulation.</li>
<li><strong>Cons:</strong> <code>grep()</code> is a base R function, so it doesn’t require additional package installations, making it more suitable for lightweight scripts or when working in environments with limited package support.</li>
</ul></li>
</ul>
</section>
<section id="combining-grep-with-other-functions-for-data-analysis" class="level1">
<h1>Combining <code>grep()</code> with Other Functions for Data Analysis</h1>
<p><code>grep()</code> can be combined with other R functions to perform advanced data manipulation and analysis tasks. This versatility makes it a powerful tool in the R programmer’s toolkit:</p>
<section id="filtering-data-frames-with-case-insensitive-search" class="level2">
<h2 class="anchored" data-anchor-id="filtering-data-frames-with-case-insensitive-search"><strong>Filtering Data Frames with Case-Insensitive Search:</strong></h2>
<p>You can use <code>grep()</code> with <code>ignore.case = TRUE</code> in conjunction with <code>filter()</code> from <code>dplyr</code> to filter data frames based on complex text patterns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Description =</span> <span class="fu">c</span>(<span class="st">"Fresh Apple Juice"</span>, <span class="st">"Banana Bread"</span>, <span class="st">"apple tart"</span>, <span class="st">"Cherry Pie"</span>, <span class="st">"APPLE Jam"</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Use dplyr's filter with grep to find all rows with "apple"</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>apple_filtered_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"apple"</span>, Description, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(apple_filtered_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID       Description
1  1 Fresh Apple Juice
2  3        apple tart
3  5         APPLE Jam</code></pre>
</div>
</div>
</section>
<section id="combining-grep-with-lapply-and-sapply" class="level2">
<h2 class="anchored" data-anchor-id="combining-grep-with-lapply-and-sapply"><strong>Combining <code>grep()</code> with <code>lapply()</code> and <code>sapply()</code>:</strong></h2>
<p>For more complex operations, <code>grep()</code> can be used inside <code>lapply()</code> or <code>sapply()</code> to apply the function to each element of a list or a column of a data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example list of character vectors</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>list_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"cherry"</span>),</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"Apple Pie"</span>, <span class="st">"Banana Bread"</span>, <span class="st">"Cherry Tart"</span>),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"apple cider"</span>, <span class="st">"banana split"</span>, <span class="st">"cherry juice"</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Use sapply to find "apple" case-insensitively in each list element</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>apple_positions <span class="ot">&lt;-</span> <span class="fu">sapply</span>(list_data, <span class="cf">function</span>(x) <span class="fu">grep</span>(<span class="st">"apple"</span>, x, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(apple_positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1</code></pre>
</div>
</div>
<p>Combining <code>grep()</code> with other R functions can significantly enhance your data analysis workflow, allowing you to perform complex filtering, subsetting, and string manipulation tasks efficiently.</p>
</section>
</section>
<section id="case-studies-and-examples" class="level1">
<h1>Case Studies and Examples</h1>
<p>To illustrate the versatility of <code>grep()</code> with <code>ignore.case = TRUE</code>, let’s explore some real-world case studies and examples where this function proves invaluable.</p>
<section id="example-1-case-insensitive-search-in-a-text-mining-project" class="level2">
<h2 class="anchored" data-anchor-id="example-1-case-insensitive-search-in-a-text-mining-project"><strong>Example 1: Case-Insensitive Search in a Text Mining Project</strong></h2>
<p>Suppose you are working on a text mining project analyzing customer feedback to identify common themes or keywords. A case-insensitive search allows you to catch all variations of a word regardless of capitalization:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example feedback data</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>feedback <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Great Service"</span>, <span class="st">"service was poor"</span>, <span class="st">"excellent SERVICE"</span>, <span class="st">"Customer Service is key"</span>, <span class="st">"Love the SERVICE"</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find all mentions of "service" regardless of case</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>service_mentions <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"service"</span>, feedback, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(service_mentions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Great Service"           "service was poor"       
[3] "excellent SERVICE"       "Customer Service is key"
[5] "Love the SERVICE"       </code></pre>
</div>
</div>
<p>This output captures all variations of the word “service,” ensuring comprehensive analysis.</p>
</section>
<section id="example-2-data-cleaning-and-preparation-using-grep" class="level2">
<h2 class="anchored" data-anchor-id="example-2-data-cleaning-and-preparation-using-grep"><strong>Example 2: Data Cleaning and Preparation Using <code>grep()</code></strong></h2>
<p>In data cleaning, you may need to identify and correct entries in a dataset that contain typos or inconsistencies in capitalization. For instance, in a dataset of product names, you want to ensure all references to “apple” products are standardized:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example product data</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>products <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Apple Juice"</span>, <span class="st">"apple juice"</span>, <span class="st">"APPLE JUICE"</span>, <span class="st">"Banana Smoothie"</span>, <span class="st">"apple cider"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize all "apple" product references</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>standardized_products <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"apple.*"</span>, <span class="st">"Apple Product"</span>, products, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(standardized_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Apple Product"   "Apple Product"   "Apple Product"   "Banana Smoothie"
[5] "Apple Product"  </code></pre>
</div>
</div>
<p>All entries referencing “apple” are now standardized, facilitating cleaner data analysis.</p>
</section>
<section id="example-3-real-world-example-from-bioinformatics-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="example-3-real-world-example-from-bioinformatics-data-analysis"><strong>Example 3: Real-World Example from Bioinformatics Data Analysis</strong></h2>
<p>In bioinformatics, case-insensitive searches are crucial for matching gene names or protein sequences where the case may vary depending on the data source. For example, finding occurrences of a specific gene name:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example gene list</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BRCA1"</span>, <span class="st">"brca1"</span>, <span class="st">"BRCA2"</span>, <span class="st">"tp53"</span>, <span class="st">"TP53"</span>, <span class="st">"brca1"</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Case-insensitive search for "BRCA1"</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>brca1_indices <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"brca1"</span>, genes, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(genes[brca1_indices])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "BRCA1" "brca1" "brca1"</code></pre>
</div>
</div>
<p>This approach ensures that all mentions of “BRCA1” are captured, regardless of their format.</p>
</section>
</section>
<section id="best-practices-for-using-grep-in-r" class="level1">
<h1>Best Practices for Using <code>grep()</code> in R</h1>
<p>To maximize the efficiency and effectiveness of <code>grep()</code> in your R scripts, consider the following best practices:</p>
<ul>
<li><p><strong>Use Clear and Specific Patterns:</strong> When writing patterns for <code>grep()</code>, be as specific as possible. This not only improves the accuracy of matches but also enhances performance by reducing the number of potential matches.</p></li>
<li><p><strong>Combine with Other Functions:</strong> Leverage <code>grep()</code> with functions like <code>subset()</code>, <code>filter()</code>, or <code>lapply()</code> to perform more complex data manipulation tasks.</p></li>
<li><p><strong>Consider Case Sensitivity:</strong> Be mindful of whether case sensitivity is necessary for your analysis. If not, always set <code>ignore.case = TRUE</code> to avoid missing relevant data due to capitalization differences.</p></li>
<li><p><strong>Test with Small Datasets First:</strong> When working with large datasets, test your <code>grep()</code> patterns on smaller subsets to ensure they work as intended. This prevents lengthy computation times and potential errors on large data.</p></li>
<li><p><strong>Use <code>value = TRUE</code> for Direct Matches:</strong> If you need the actual matching elements rather than their indices, always set <code>value = TRUE</code>. This can simplify your code and make it more readable.</p></li>
<li><p><strong>Handle Special Characters Appropriately:</strong> If your pattern includes special characters (e.g., “.”, “*“, or”+“), ensure they are properly escaped to avoid unintended matches.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct usage with escaped special character</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">"file</span><span class="sc">\\</span><span class="st">."</span>, <span class="fu">c</span>(<span class="st">"file.txt"</span>, <span class="st">"file.csv"</span>, <span class="st">"file.doc"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>The <code>grep()</code> function in R, with its flexibility and powerful pattern-matching capabilities, is an essential tool for any data scientist or analyst. By understanding how to use <code>ignore.case = TRUE</code> effectively, you can ensure that your text searches are comprehensive and accurate, capturing all relevant data regardless of capitalization.</p>
<p>Whether you are performing data cleaning, text mining, or advanced data analysis, mastering <code>grep()</code> will greatly enhance your ability to manipulate and analyze textual data in R. Remember to combine <code>grep()</code> with other R functions and packages to unlock even more powerful data manipulation capabilities.</p>
<p>Alternatives to <code>grep()</code> include functions from the <code>stringr</code> package such as <code>str_detect()</code> and <code>str_subset()</code> with <code>regex()</code>. You can also use base R functions like <code>tolower()</code> or <code>toupper()</code> to normalize case before searching.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="grep_caseinsensitive.png" class="img-fluid figure-img"></p>
<figcaption>Case Insensitive grep()</figcaption>
</figure>
</div>
<script src="https://giscus.app/client.js" data-repo="spsanderson/steveondata" data-repo-id="R_kgDOIIxnLw" data-category="Comments" data-category-id="DIC_kwDOIIxnL84ChTk8" data-mapping="url" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="dark" data-lang="en" data-loading="lazy" crossorigin="anonymous" async="">
</script>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.spsanderson\.com\/steveondata\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>