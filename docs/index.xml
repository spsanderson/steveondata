<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Steve&#39;s Data Tips and Tricks</title>
<link>https://www.spsanderson.com/steveondata/</link>
<atom:link href="https://www.spsanderson.com/steveondata/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.4.555</generator>
<lastBuildDate>Wed, 24 Jul 2024 04:00:00 GMT</lastBuildDate>
<item>
  <title>Getting the Workbook Name in VBA and Calling It from R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-24/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>When working with Excel, it’s often useful to know the name of the workbook you’re working in, especially if you’re managing multiple files. Today, we’ll look at how to retrieve the workbook name using VBA (Visual Basic for Applications) and then call this VBA code from R. This post will walk you through the steps with clear examples and explanations. Let’s get to it!</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<section id="getting-the-workbook-name-using-vba" class="level2">
<h2 class="anchored" data-anchor-id="getting-the-workbook-name-using-vba">Getting the Workbook Name Using VBA</h2>
<p>First, we’ll start with a simple VBA script to get the workbook name. VBA is a powerful tool integrated into Microsoft Office applications, allowing you to automate tasks and interact with various elements in your documents.</p>
<p>Here’s a basic example of VBA code that retrieves the name of the active workbook:</p>
<pre class="vba"><code>Sub GetWorkbookName()
    Dim wbName As String
    wbName = ThisWorkbook.Name
    MsgBox "The name of the active workbook is: " &amp; wbName
End Sub</code></pre>
<p><strong>Explanation:</strong></p>
<ol type="1">
<li><strong>Sub GetWorkbookName()</strong>: This line defines a new subroutine named <code>GetWorkbookName</code>. A subroutine in VBA is a block of code that performs a specific task.</li>
<li><strong>Dim wbName As String</strong>: This line declares a variable <code>wbName</code> that will hold the workbook’s name as a string.</li>
<li><strong>wbName = ThisWorkbook.Name</strong>: Here, we’re assigning the name of the active workbook (the one where this VBA code is being run) to the <code>wbName</code> variable.</li>
<li><strong>MsgBox “The name of the active workbook is:” &amp; wbName</strong>: Finally, we use a message box to display the workbook name.</li>
</ol>
</section>
<section id="calling-vba-code-from-r" class="level2">
<h2 class="anchored" data-anchor-id="calling-vba-code-from-r">Calling VBA Code from R</h2>
<p>Now that we have our VBA macro, the next step is to call it from R. This is particularly useful if you’re integrating Excel operations into your R workflows.</p>
<p>We’ll use the <code>RDCOMClient</code> package in R, which allows us to interact with COM (Component Object Model) objects, such as Excel. If you haven’t installed this package, you can do so with:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RDCOMClient"</span>)</span></code></pre></div>
<p>Here’s a simple R script to call our VBA subroutine:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RDCOMClient)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create an instance of the Excel application</span></span>
<span id="cb3-4">excel_app <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">COMCreate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Excel.Application"</span>)</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File Path</span></span>
<span id="cb3-7">f_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C:/path_to/workbook_name.xlsm"</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Open the workbook (replace 'f_path' with the actual path)</span></span>
<span id="cb3-10">workbook <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> excel_app<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Workbooks</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Open</span>(f_path)</span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the VBA macro</span></span>
<span id="cb3-13">excel_app<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Run</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GetWorkbookName"</span>)</span>
<span id="cb3-14"></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Close the workbook without saving changes</span></span>
<span id="cb3-16">workbook<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Close</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Quit Excel</span></span>
<span id="cb3-19">excel_app<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Quit</span>()</span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Release the object</span></span>
<span id="cb3-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(excel_app)</span></code></pre></div>
<p><strong>Explanation:</strong></p>
<ol type="1">
<li><strong>library(RDCOMClient)</strong>: This line loads the <code>RDCOMClient</code> package.</li>
<li><strong>COMCreate(“Excel.Application”)</strong>: We create an instance of the Excel application.</li>
<li><strong>workbook &lt;- excel_app<img src="https://latex.codecogs.com/png.latex?Workbooks()">Open(“f_path”)</strong>: This line opens the specified workbook. Replace <code>"f_path"</code> with the path to your actual Excel file.</li>
<li><strong>excel_app$Run(“GetWorkbookName”)</strong>: Here, we call the VBA subroutine <code>GetWorkbookName</code> to display the workbook’s name.</li>
<li><strong>workbook$Close(FALSE)</strong>: We close the workbook without saving any changes.</li>
<li><strong>excel_app$Quit()</strong>: This closes the Excel application.</li>
<li><strong>rm(excel_app)</strong>: Finally, we release the Excel application object to free up resources.</li>
</ol>
<p>Here is a picture of the message:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-24/Capture.PNG" class="img-fluid figure-img"></p>
<figcaption>VBA Workbook Name</figcaption>
</figure>
</div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>With these simple steps, you’ve learned how to retrieve the name of an Excel workbook using VBA and how to call this VBA code from R. This combination can be quite powerful, especially when automating data processing tasks that involve both Excel and R.</p>
<p>Feel free to try this on your own. Experiment with different VBA scripts and see how you can integrate them into your R workflows. It’s a great way to streamline your work and make the most of both tools.</p>
<hr>
<p>Happy coding!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>operations</category>
  <category>vba</category>
  <category>excel</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-24/</guid>
  <pubDate>Wed, 24 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Checking if a String Contains Multiple Substrings in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-23/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hello, fellow R programmers! Today, we’re looking at a practical topic that often comes up when dealing with text data: how to check if a string contains multiple substrings. We’ll cover how to do this in base R, as well as using the <code>stringr</code> and <code>stringi</code> packages. Each approach has its own advantages, so let’s explore them together.</p>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<section id="base-r-approach" class="level2">
<h2 class="anchored" data-anchor-id="base-r-approach">Base R Approach</h2>
<p>First, let’s start with base R. Suppose we have a string and we want to check if it contains both “apple” and “banana”. Here’s how you can do it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Our main string</span></span>
<span id="cb1-2">main_string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"I have an apple and a banana."</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Substrings to check</span></span>
<span id="cb1-5">substrings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apple"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"banana"</span>)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if all substrings are in the main string</span></span>
<span id="cb1-8">contains_all <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(substrings, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(x, main_string)))</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output the result</span></span>
<span id="cb1-11">contains_all</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(substrings, grepl, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> main_string)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> apple banana 
  TRUE   TRUE </code></pre>
</div>
</div>
<section id="explanation" class="level3">
<h3 class="anchored" data-anchor-id="explanation">Explanation</h3>
<ol type="1">
<li><strong><code>main_string</code></strong>: This is the string we are checking.</li>
<li><strong><code>substrings</code></strong>: A vector containing the substrings we are looking for.</li>
<li><strong><code>sapply(substrings, function(x) grepl(x, main_string))</code></strong>: We use <code>sapply</code> to apply <code>grepl</code> (which checks if a pattern is found in a string) to each substring. This returns a logical vector indicating if each substring is present.</li>
<li><strong><code>all()</code></strong>: This function checks if all values in the logical vector are <code>TRUE</code>.</li>
</ol>
<p>By combining these functions, we can efficiently check if all the substrings are present in our main string.</p>
</section>
</section>
<section id="using-stringr" class="level2">
<h2 class="anchored" data-anchor-id="using-stringr">Using <code>stringr</code></h2>
<p>The <code>stringr</code> package provides a set of functions designed to make string manipulation easier and more intuitive. Here’s how we can use it to achieve the same goal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the stringr package</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Our main string</span></span>
<span id="cb5-5">main_string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"I have an apple and a banana."</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Substrings to check</span></span>
<span id="cb5-8">substrings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apple"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"banana"</span>)</span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if all substrings are in the main string</span></span>
<span id="cb5-11">contains_all <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(main_string, substrings))</span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output the result</span></span>
<span id="cb5-14">contains_all</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(main_string, substrings)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE</code></pre>
</div>
</div>
<section id="explanation-1" class="level3">
<h3 class="anchored" data-anchor-id="explanation-1">Explanation</h3>
<ol type="1">
<li><strong><code>library(stringr)</code></strong>: Loads the <code>stringr</code> package.</li>
<li><strong><code>str_detect(main_string, substrings)</code></strong>: The <code>str_detect</code> function checks if each pattern in <code>substrings</code> is found in <code>main_string</code>. It returns a logical vector.</li>
<li><strong><code>all()</code></strong>: As before, <code>all</code> checks if all values in the logical vector are <code>TRUE</code>.</li>
</ol>
<p>The <code>stringr</code> package simplifies the syntax and makes the code more readable.</p>
</section>
</section>
<section id="using-stringi" class="level2">
<h2 class="anchored" data-anchor-id="using-stringi">Using <code>stringi</code></h2>
<p>The <code>stringi</code> package is another powerful tool for string manipulation. It offers a highly efficient way to handle strings. Here’s how we can use <code>stringi</code> to check for multiple substrings:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the stringi package</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringi)</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Our main string</span></span>
<span id="cb9-5">main_string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"I have an apple and a banana."</span></span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Substrings to check</span></span>
<span id="cb9-8">substrings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apple"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"banana"</span>)</span>
<span id="cb9-9"></span>
<span id="cb9-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if all substrings are in the main string</span></span>
<span id="cb9-11">contains_all <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stri_detect_fixed</span>(main_string, substrings))</span>
<span id="cb9-12"></span>
<span id="cb9-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output the result</span></span>
<span id="cb9-14">contains_all</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stri_detect_fixed</span>(main_string, substrings)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE</code></pre>
</div>
</div>
<section id="explanation-2" class="level3">
<h3 class="anchored" data-anchor-id="explanation-2">Explanation</h3>
<ol type="1">
<li><strong><code>library(stringi)</code></strong>: Loads the <code>stringi</code> package.</li>
<li><strong><code>stri_detect_fixed(main_string, substrings)</code></strong>: The <code>stri_detect_fixed</code> function checks if each fixed pattern in <code>substrings</code> is found in <code>main_string</code>. This function is optimized for fixed patterns and is very fast.</li>
<li><strong><code>all()</code></strong>: Again, we use <code>all</code> to check if all values in the logical vector are <code>TRUE</code>.</li>
</ol>
<p><code>stringi</code> provides highly optimized functions that can be very useful for handling large datasets or performance-critical applications.</p>
</section>
</section>
</section>
<section id="try-it-yourself" class="level1">
<h1>Try It Yourself!</h1>
<p>Now that we’ve walked through the different methods to check if a string contains multiple substrings, I encourage you to try these approaches on your own. Experiment with different strings and substrings to get a feel for how these functions work. Understanding these techniques can greatly enhance your text data manipulation skills in R.</p>
<p>Happy coding, and feel free to share your experiences and any questions you might have in the comments!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>operations</category>
  <category>strings</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-23/</guid>
  <pubDate>Tue, 23 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>How to Concatenate Strings in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-22/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hello, R users! Today, we’re going to talk about a fundamental yet essential aspect of data manipulation: concatenating strings. String concatenation is the process of joining two or more strings together. It doesn’t matter if you’re working with text data, creating labels, or generating dynamic outputs, knowing how to concatenate strings efficiently is a must. We’ll explore how to do this using base R, the <code>stringr</code> package, and the <code>stringi</code> package. Let’s get started!</p>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<section id="concatenating-strings-in-base-r" class="level2">
<h2 class="anchored" data-anchor-id="concatenating-strings-in-base-r">Concatenating Strings in Base R</h2>
<p>Base R provides a straightforward way to concatenate strings using the <code>paste()</code> and <code>paste0()</code> functions. Here’s how you can use them:</p>
<section id="using-paste" class="level3">
<h3 class="anchored" data-anchor-id="using-paste">Using <code>paste()</code></h3>
<p>The <code>paste()</code> function combines strings and adds a separator (default is a space).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example</span></span>
<span id="cb1-2">string1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hello"</span></span>
<span id="cb1-3">string2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"World"</span></span>
<span id="cb1-4">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(string1, string2)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "Hello World"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello World"</code></pre>
</div>
</div>
<p>In this example, <code>paste(string1, string2)</code> joins “Hello” and “World” with a space in between.</p>
</section>
<section id="using-paste0" class="level3">
<h3 class="anchored" data-anchor-id="using-paste0">Using <code>paste0()</code></h3>
<p>The <code>paste0()</code> function is similar to <code>paste()</code>, but it doesn’t add a separator by default.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example</span></span>
<span id="cb3-2">result_no_space <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(string1, string2)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result_no_space)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "HelloWorld"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "HelloWorld"</code></pre>
</div>
</div>
<p>Here, <code>paste0(string1, string2)</code> joins “Hello” and “World” without any spaces.</p>
</section>
<section id="custom-separator" class="level3">
<h3 class="anchored" data-anchor-id="custom-separator">Custom Separator</h3>
<p>You can also specify a custom separator with <code>paste()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example</span></span>
<span id="cb5-2">result_custom_sep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(string1, string2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>)</span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result_custom_sep)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "Hello, World"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello, World"</code></pre>
</div>
</div>
<p>By setting <code>sep = ", "</code>, we add a comma and a space between the strings.</p>
</section>
</section>
<section id="concatenating-strings-with-stringr" class="level2">
<h2 class="anchored" data-anchor-id="concatenating-strings-with-stringr">Concatenating Strings with <code>stringr</code></h2>
<p>The <code>stringr</code> package offers a more consistent and user-friendly way to handle strings in R. For concatenation, we use the <code>str_c()</code> function.</p>
<section id="using-str_c" class="level3">
<h3 class="anchored" data-anchor-id="using-str_c">Using <code>str_c()</code></h3>
<p>The <code>str_c()</code> function from <code>stringr</code> is similar to <code>paste0()</code> but provides more control over the process.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load stringr package</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example</span></span>
<span id="cb7-5">result_str_c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_c</span>(string1, string2)</span>
<span id="cb7-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result_str_c)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "HelloWorld"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "HelloWorld"</code></pre>
</div>
</div>
<p>This example is equivalent to <code>paste0()</code>.</p>
</section>
<section id="custom-separator-1" class="level3">
<h3 class="anchored" data-anchor-id="custom-separator-1">Custom Separator</h3>
<p>To add a separator, use the <code>sep</code> argument in <code>str_c()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example with separator</span></span>
<span id="cb9-2">result_str_c_sep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_c</span>(string1, string2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result_str_c_sep)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "Hello World"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello World"</code></pre>
</div>
</div>
<p>Here, <code>sep = " "</code> adds a space between the strings.</p>
</section>
</section>
<section id="concatenating-strings-with-stringi" class="level2">
<h2 class="anchored" data-anchor-id="concatenating-strings-with-stringi">Concatenating Strings with <code>stringi</code></h2>
<p>The <code>stringi</code> package is another powerful tool for string manipulation in R. For concatenation, we use the <code>stri_c()</code> function.</p>
<section id="using-stri_c" class="level3">
<h3 class="anchored" data-anchor-id="using-stri_c">Using <code>stri_c()</code></h3>
<p>The <code>stri_c()</code> function works similarly to <code>paste0()</code> and <code>str_c()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load stringi package</span></span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringi)</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example</span></span>
<span id="cb11-5">result_stri_c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stri_c</span>(string1, string2)</span>
<span id="cb11-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result_stri_c)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "HelloWorld"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "HelloWorld"</code></pre>
</div>
</div>
<p>This joins “Hello” and “World” without spaces.</p>
</section>
<section id="custom-separator-2" class="level3">
<h3 class="anchored" data-anchor-id="custom-separator-2">Custom Separator</h3>
<p>To include a separator, use the <code>sep</code> argument in <code>stri_c()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example with separator</span></span>
<span id="cb13-2">result_stri_c_sep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stri_c</span>(string1, string2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result_stri_c_sep)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "Hello World"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello World"</code></pre>
</div>
</div>
<p>The <code>sep</code> argument adds a space between the strings.</p>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>String concatenation is a simple yet vital task in data manipulation. Whether you prefer base R functions like <code>paste()</code> and <code>paste0()</code>, or the more specialized <code>stringr</code> and <code>stringi</code> packages, you have multiple options to choose from. Each method has its unique advantages, and understanding them will help you handle strings more effectively in your R projects.</p>
<p>Feel free to try these examples on your own and see how they work with your data. Happy coding!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>operations</category>
  <category>strings</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-22/</guid>
  <pubDate>Mon, 22 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Simplify Regression Modeling with tidyAML’s fast_regression()</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-18/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>If you’ve ever faced the daunting task of setting up multiple regression models in R, you’ll appreciate the convenience and efficiency that <code>tidyAML</code> brings to the table. Today, we’re diving into one of its standout functions: <code>fast_regression()</code>. This function is designed to streamline the regression modeling process, allowing you to quickly create and evaluate a variety of model specifications with minimal code.</p>
</section>
<section id="introduction-to-fast_regression" class="level1">
<h1>Introduction to <code>fast_regression()</code></h1>
<p>The <code>fast_regression()</code> function is part of the <code>tidyAML</code> package, a toolkit that simplifies machine learning workflows in R. This function takes your data and recipe object and generates multiple regression models, using a variety of engines and functions from the <code>parsnip</code> package.</p>
<section id="syntax" class="level2">
<h2 class="anchored" data-anchor-id="syntax">Syntax</h2>
<p>Here’s a look at the function’s syntax:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fast_regression</span>(</span>
<span id="cb1-2">  .data,</span>
<span id="cb1-3">  .rec_obj,</span>
<span id="cb1-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_fns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>,</span>
<span id="cb1-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_eng =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>,</span>
<span id="cb1-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.split_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"initial_split"</span>,</span>
<span id="cb1-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.split_args =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb1-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.drop_na =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb1-9">)</span></code></pre></div>
</section>
<section id="arguments" class="level2">
<h2 class="anchored" data-anchor-id="arguments">Arguments</h2>
<ul>
<li><strong>.data</strong>: The data frame to be used in the regression problem.</li>
<li><strong>.rec_obj</strong>: A recipe object from the <code>recipes</code> package that defines the pre-processing steps.</li>
<li><strong>.parsnip_fns</strong>: Specifies which parsnip functions to use. The default <code>"all"</code> will create all possible regression model specifications.</li>
<li><strong>.parsnip_eng</strong>: Specifies which parsnip engines to use. The default <code>"all"</code> will create all possible regression model specifications.</li>
<li><strong>.split_type</strong>: Defines the type of data split, with <code>"initial_split"</code> as the default. Other split types supported by <code>rsample</code> can also be used.</li>
<li><strong>.split_args</strong>: Additional arguments for the split type. When set to <code>NULL</code>, default parameters for the chosen split type are used.</li>
<li><strong>.drop_na</strong>: Determines whether to drop NA values from the data. Default is <code>TRUE</code>.</li>
</ul>
</section>
</section>
<section id="example-using-fast_regression" class="level1">
<h1>Example: Using <code>fast_regression()</code></h1>
<p>Let’s see <code>fast_regression()</code> in action with a simple example. We’ll use the well-known <code>mtcars</code> dataset, and set up a basic recipe to predict miles per gallon (mpg).</p>
<p>First, ensure you have the necessary packages loaded:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyAML)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(recipes)</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(purrr)</span></code></pre></div>
</div>
<p>Next, we create a recipe object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">rec_obj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span>
<span id="cb3-2"></span>
<span id="cb3-3">rec_obj</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>outcome:    1
predictor: 10</code></pre>
</div>
</div>
<p>Now, we can run <code>fast_regression()</code> to create regression models using the <code>lm</code> and <code>glm</code> engines with a <code>linear_reg</code> parsnip function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">fast_reg_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fast_regression</span>(</span>
<span id="cb10-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.data =</span> mtcars,</span>
<span id="cb10-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.rec_obj =</span> rec_obj,</span>
<span id="cb10-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_eng =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>),</span>
<span id="cb10-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_fns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span></span>
<span id="cb10-6">)</span></code></pre></div>
</div>
<section id="output" class="level3">
<h3 class="anchored" data-anchor-id="output">Output</h3>
<p>The function returns a tibble with details about the generated models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">fast_reg_tbl</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 8
  .model_id .parsnip_engine .parsnip_mode .parsnip_fns model_spec wflw      
      &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;        &lt;list&gt;     &lt;list&gt;    
1         1 lm              regression    linear_reg   &lt;spec[+]&gt;  &lt;workflow&gt;
2         2 glm             regression    linear_reg   &lt;spec[+]&gt;  &lt;workflow&gt;
# ℹ 2 more variables: fitted_wflw &lt;list&gt;, pred_wflw &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="explanation" class="level3">
<h3 class="anchored" data-anchor-id="explanation">Explanation</h3>
<ul>
<li><strong>.model_id</strong>: A unique identifier for each model.</li>
<li><strong>.parsnip_engine</strong>: The engine used by <code>parsnip</code> (e.g., <code>lm</code>, <code>glm</code>).</li>
<li><strong>.parsnip_mode</strong>: The mode of the model, typically <code>regression</code>.</li>
<li><strong>.parsnip_fns</strong>: The <code>parsnip</code> function used (e.g., <code>linear_reg</code>).</li>
<li><strong>model_spec</strong>: The model specification.</li>
<li><strong>wflw</strong>: The workflow object.</li>
<li><strong>fitted_wflw</strong>: The fitted workflow object.</li>
<li><strong>pred_wflw</strong>: The predictions from the fitted workflow.</li>
</ul>
</section>
<section id="benefits-of-fast_regression" class="level3">
<h3 class="anchored" data-anchor-id="benefits-of-fast_regression">Benefits of <code>fast_regression()</code></h3>
<ul>
<li><strong>Efficiency</strong>: Quickly set up and evaluate multiple regression models with different specifications.</li>
<li><strong>Flexibility</strong>: Supports a wide range of engines and functions, allowing for comprehensive model exploration.</li>
<li><strong>Integration</strong>: Seamlessly integrates with the <code>recipes</code>, <code>parsnip</code>, and <code>rsample</code> packages, making it a versatile tool in your modeling arsenal.</li>
</ul>
</section>
<section id="lets-inspect" class="level3">
<h3 class="anchored" data-anchor-id="lets-inspect">Let’s Inspect</h3>
<p>Now that we have our models, let’s take a closer look at the results. We can use the <code>extract_regression_residuals()</code> function to extract the residuals from the fitted models along with the original and predicted data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract_regression_residuals</span>(fast_reg_tbl)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 32 × 4
   .model_type     .actual .predicted  .resid
   &lt;chr&gt;             &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
 1 lm - linear_reg    21.4       21.1  0.276 
 2 lm - linear_reg    21         23.9 -2.91  
 3 lm - linear_reg    19.7       18.7  1.01  
 4 lm - linear_reg    18.1       19.7 -1.55  
 5 lm - linear_reg    14.7       12.0  2.73  
 6 lm - linear_reg    24.4       23.7  0.694 
 7 lm - linear_reg    22.8       24.3 -1.48  
 8 lm - linear_reg    13.3       12.5  0.820 
 9 lm - linear_reg    10.4       13.2 -2.85  
10 lm - linear_reg    19.2       19.3 -0.0583
# ℹ 22 more rows

[[2]]
# A tibble: 32 × 4
   .model_type      .actual .predicted  .resid
   &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
 1 glm - linear_reg    21.4       21.1  0.276 
 2 glm - linear_reg    21         23.9 -2.91  
 3 glm - linear_reg    19.7       18.7  1.01  
 4 glm - linear_reg    18.1       19.7 -1.55  
 5 glm - linear_reg    14.7       12.0  2.73  
 6 glm - linear_reg    24.4       23.7  0.694 
 7 glm - linear_reg    22.8       24.3 -1.48  
 8 glm - linear_reg    13.3       12.5  0.820 
 9 glm - linear_reg    10.4       13.2 -2.85  
10 glm - linear_reg    19.2       19.3 -0.0583
# ℹ 22 more rows</code></pre>
</div>
</div>
<p>Now of course we must now visualize! Let’s plot the residuals to see how well our models are performing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract_regression_residuals</span>(fast_reg_tbl) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_regression_residuals</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-18/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-18/index_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now the residuals are plotted, we can see how well our models are performing. This is a great way to visually inspect the quality of our models and identify any potential issues.</p>
<p>Let’s look at the predicted vs actual only now:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract_wflw_pred</span>(fast_reg_tbl,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(fast_reg_tbl)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb18-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_regression_predictions</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-18/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-18/index_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>The <code>fast_regression()</code> function in <code>tidyAML</code> is a powerful addition to any data scientist’s toolkit, providing a streamlined approach to regression modeling. Whether you’re a seasoned pro or just getting started with machine learning in R, this function can save you time and effort, allowing you to focus on what really matters – interpreting and acting on your results.</p>
<p>Give <code>fast_regression()</code> a try in your next project and experience the ease and efficiency it brings to regression modeling! If you have any questions or want to share your experience, feel free to leave a comment below.</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>tidyaml</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-18/</guid>
  <pubDate>Thu, 18 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>VBA: Saving and Closing a Workbook</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-17/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this tutorial, you’ll learn how to save and close an Excel workbook using VBA (Visual Basic for Applications) and then doing it from R. We’ll create a simple VBA script that saves and closes a workbook, and then we’ll call this script from R using the <code>RDCOMClient</code> package.</p>
</section>
<section id="prerequisites" class="level1">
<h1>Prerequisites</h1>
<section id="vba-script" class="level2">
<h2 class="anchored" data-anchor-id="vba-script">VBA Script</h2>
<p>First, let’s create a simple VBA script that saves and closes a workbook. Here’s the VBA code:</p>
<pre class="vba"><code>Sub SaveAndCloseWorkbook()
    Dim wb As Workbook
    Set wb = ThisWorkbook
    wb.Save
    wb.Close
End Sub</code></pre>
</section>
<section id="explanation" class="level2">
<h2 class="anchored" data-anchor-id="explanation">Explanation:</h2>
<ul>
<li><strong>Sub SaveAndCloseWorkbook()</strong>: This line starts the subroutine named <code>SaveAndCloseWorkbook</code>.</li>
<li><strong>Dim wb As Workbook</strong>: This declares a variable <code>wb</code> as a Workbook object.</li>
<li><strong>Set wb = ThisWorkbook</strong>: This sets <code>wb</code> to refer to the workbook where the VBA code is running.</li>
<li><strong>wb.Save</strong>: This saves the workbook.</li>
<li><strong>wb.Close</strong>: This closes the workbook.</li>
</ul>
</section>
<section id="calling-vba-from-r" class="level2">
<h2 class="anchored" data-anchor-id="calling-vba-from-r">Calling VBA from R</h2>
<p>Now, let’s see how you can call this VBA script from R using the <code>RDCOMClient</code> package. This package allows R to interact with COM objects, such as Excel.</p>
<section id="step-by-step-r-code" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-r-code">Step-by-Step R Code</h4>
<ol type="1">
<li><p><strong>Install RDCOMClient</strong>: If you haven’t installed it yet, you can do so from the R console.</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RDCOMClient"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repos =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://www.omegahat.net/R"</span>)</span></code></pre></div></li>
<li><p><strong>Write the R Code</strong>: Here’s the R script to run the VBA code.</p></li>
</ol>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RDCOMClient)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new Excel application</span></span>
<span id="cb3-4">excel_app <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">COMCreate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Excel.Application"</span>)</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make the Excel application visible</span></span>
<span id="cb3-7">excel_app[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Visible"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Open an existing workbook or create a new one</span></span>
<span id="cb3-10">workbook_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C:/path/to/your/workbook.xlsx"</span></span>
<span id="cb3-11">wb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> excel_app<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Workbooks</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Open</span>(workbook_path)</span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the VBA macro</span></span>
<span id="cb3-14">excel_app<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Run</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SaveAndCloseWorkbook"</span>)</span>
<span id="cb3-15"></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Quit the Excel application</span></span>
<span id="cb3-17">excel_app<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Quit</span>()</span>
<span id="cb3-18"></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Release the COM object</span></span>
<span id="cb3-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(excel_app)</span>
<span id="cb3-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gc</span>()</span></code></pre></div>
</section>
</section>
<section id="explanation-1" class="level2">
<h2 class="anchored" data-anchor-id="explanation-1">Explanation:</h2>
<ul>
<li><strong>library(RDCOMClient)</strong>: Loads the RDCOMClient library to interact with COM objects.</li>
<li>*excel_app &lt;- COMCreate(“Excel.Application”)**: Creates a new Excel application instance.</li>
<li><strong>excel_app[[“Visible”]] &lt;- TRUE</strong>: Makes the Excel application visible (optional).</li>
<li><strong>workbook_path</strong>: Path to your Excel workbook.</li>
<li><strong>wb &lt;- excel_app<img src="https://latex.codecogs.com/png.latex?Workbooks()">Open(workbook_path)</strong>: Opens the workbook.</li>
<li><strong>excel_app$Run(“SaveAndCloseWorkbook”)</strong>: Runs the VBA macro <code>SaveAndCloseWorkbook</code>.</li>
<li><strong>excel_app$Quit()</strong>: Quits the Excel application.</li>
<li><strong>rm(excel_app)</strong> and <strong>gc()</strong>: Releases the COM object and performs garbage collection to free up memory.</li>
</ul>
</section>
</section>
<section id="try-it-yourself" class="level1">
<h1>Try It Yourself</h1>
<p>This example gives you a starting point to work with VBA and R together. Try modifying the VBA code to suit your needs, like adding more functionalities or handling different scenarios. Experimenting with this setup will give you a better understanding of how to automate Excel tasks from R.</p>
<hr>
<p>Happy coding!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>operations</category>
  <category>vba</category>
  <category>excel</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-17/</guid>
  <pubDate>Wed, 17 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>How to Extract Substring Starting from the End of a String in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-16/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hey useR’s! Today, we’re going to discuss a neat trick: extracting substrings starting from the end of a string. We’ll cover how to achieve this using base R, <code>stringr</code>, and <code>stringi</code>. By the end of this post, you’ll have several tools in your R toolbox for string manipulation. Let’s get started!</p>
</section>
<section id="extracting-substring-from-the-end-of-a-string" class="level1">
<h1>Extracting Substring from the End of a String</h1>
<section id="using-base-r" class="level2">
<h2 class="anchored" data-anchor-id="using-base-r">Using Base R</h2>
<p>First up, let’s use base R functions to extract substrings from the end of a string. The <code>substr</code> function is your friend here.</p>
<p>Here’s a simple example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define a string</span></span>
<span id="cb1-2">my_string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hello, world!"</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the last 6 characters</span></span>
<span id="cb1-5">substring_from_end <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(my_string, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(my_string) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(my_string))</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the result</span></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(substring_from_end)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "world!"</code></pre>
</div>
</div>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>nchar(my_string)</code> returns the total number of characters in <code>my_string</code>.</li>
<li><code>nchar(my_string) - 5</code> calculates the starting position of the substring, counting from the end.</li>
<li><code>substr(my_string, start, stop)</code> extracts the substring from the start position to the stop position.</li>
</ul>
</section>
<section id="using-stringr" class="level2">
<h2 class="anchored" data-anchor-id="using-stringr">Using <code>stringr</code></h2>
<p>The <code>stringr</code> package makes string manipulation more straightforward and readable. We’ll use the <code>str_sub</code> function for this task.</p>
<p>First, install and load the <code>stringr</code> package if you haven’t already:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#install.packages("stringr")</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span></code></pre></div>
</div>
<p>Now, let’s extract a substring from the end:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define a string</span></span>
<span id="cb4-2">my_string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hello, world!"</span></span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the last 6 characters using stringr</span></span>
<span id="cb4-5">substring_from_end <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(my_string, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the result</span></span>
<span id="cb4-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(substring_from_end)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "world!"</code></pre>
</div>
</div>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>str_sub(my_string, start, end)</code> extracts the substring from the start to the end position.</li>
<li>Negative indices in <code>str_sub</code> count from the end of the string. So <code>-6</code> refers to the sixth character from the end, and <code>-1</code> refers to the last character.</li>
</ul>
</section>
<section id="using-stringi" class="level2">
<h2 class="anchored" data-anchor-id="using-stringi">Using <code>stringi</code></h2>
<p>The <code>stringi</code> package is another powerful tool for string manipulation. We’ll use the <code>stri_sub</code> function here.</p>
<p>First, install and load the <code>stringi</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#install.packages("stringi")</span></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringi)</span></code></pre></div>
</div>
<p>Let’s extract our substring:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define a string</span></span>
<span id="cb7-2">my_string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hello, world!"</span></span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the last 6 characters using stringi</span></span>
<span id="cb7-5">substring_from_end <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stri_sub</span>(my_string, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the result</span></span>
<span id="cb7-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(substring_from_end)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "world!"</code></pre>
</div>
</div>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>stri_sub(my_string, from, to)</code> works similarly to <code>str_sub</code>, using <code>from</code> and <code>to</code> parameters to define the start and end positions.</li>
<li>Negative values count from the end of the string.</li>
</ul>
</section>
</section>
<section id="try-it-yourself" class="level1">
<h1>Try It Yourself!</h1>
<p>Now it’s your turn! Try these methods on your own strings. Here are a few ideas to get you started:</p>
<ul>
<li>Extract the last 3 characters of your name.</li>
<li>Extract the domain from an email address.</li>
<li>Experiment with different lengths and positions.</li>
</ul>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>We’ve explored how to extract substrings from the end of a string using base R, <code>stringr</code>, and <code>stringi</code>. Each method has its own charm, so choose the one that fits your coding style best. String manipulation is a crucial skill in data cleaning and text analysis, so keep practicing and experimenting.</p>
<hr>
<p>Happy coding! 🚀</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>operations</category>
  <category>strings</category>
  <category>regex</category>
  <category>stringr</category>
  <category>stringi</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-16/</guid>
  <pubDate>Tue, 16 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>tidyAML: Automated Machine Learning with tidymodels</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-15/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Welcome to {tidyAML} which is an R package that makes it easy to use the tidymodels ecosystem to perform automated machine learning (AutoML). This package provides a simple and intuitive interface that allows users to quickly generate machine learning models without worrying about the underlying details. It also includes a safety mechanism that ensures that the package will fail gracefully if any required extension packages are not installed on the user’s machine. With {tidyAML}, users can easily build high-quality machine learning models in just a few lines of code. Whether you are a beginner or an experienced machine learning practitioner, {tidyAML} has something to offer.</p>
<p>Some ideas are that we should be able to generate regression models on the fly without having to actually go through the process of building the specification, especially if it is a non-tuning model, meaning we are not planing on tuning hyper-parameters like penalty and cost.</p>
<p>The idea is not to re-write the excellent work the tidymodels team has done (because it’s not possible) but rather to try and make an enhanced easy to use set of functions that do what they say and can generate many models and predictions at once.</p>
<p>This is similar to the great h2o package, but, {tidyAML} does not require java to be setup properly like h2o because {tidyAML} is built on tidymodels.</p>
</section>
<section id="installation" class="level1">
<h1>Installation</h1>
<p>You can install {tidyAML} like so:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyAML"</span>)</span></code></pre></div>
<p>Or the development version from GitHub</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("devtools")</span></span>
<span id="cb2-2">devtools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install_github</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spsanderson/tidyAML"</span>)</span></code></pre></div>
<p>Part of the reason to use {tidyAML} is so that you can generate many models of your data set. One way of modeling a data set is using regression for some numeric output. There is a convienent function in tidyAML that will generate a set of non-tuning models for fast regression. Let’s take a look below.</p>
<p>First let’s load the library</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyAML)</span></code></pre></div>
</div>
<p>Now lets see the function in action.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fast_regression_parsnip_spec_tbl</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_fns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 5
   .model_id .parsnip_engine .parsnip_mode .parsnip_fns model_spec
       &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;        &lt;list&gt;    
 1         1 lm              regression    linear_reg   &lt;spec[+]&gt; 
 2         2 brulee          regression    linear_reg   &lt;spec[+]&gt; 
 3         3 gee             regression    linear_reg   &lt;spec[+]&gt; 
 4         4 glm             regression    linear_reg   &lt;spec[+]&gt; 
 5         5 glmer           regression    linear_reg   &lt;spec[+]&gt; 
 6         6 glmnet          regression    linear_reg   &lt;spec[+]&gt; 
 7         7 gls             regression    linear_reg   &lt;spec[+]&gt; 
 8         8 lme             regression    linear_reg   &lt;spec[+]&gt; 
 9         9 lmer            regression    linear_reg   &lt;spec[+]&gt; 
10        10 stan            regression    linear_reg   &lt;spec[+]&gt; 
11        11 stan_glmer      regression    linear_reg   &lt;spec[+]&gt; </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fast_regression_parsnip_spec_tbl</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_eng =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  .model_id .parsnip_engine .parsnip_mode .parsnip_fns model_spec
      &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;        &lt;list&gt;    
1         1 lm              regression    linear_reg   &lt;spec[+]&gt; 
2         2 glm             regression    linear_reg   &lt;spec[+]&gt; 
3         3 glm             regression    poisson_reg  &lt;spec[+]&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fast_regression_parsnip_spec_tbl</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_eng =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gee"</span>), </span>
<span id="cb8-2">                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_fns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  .model_id .parsnip_engine .parsnip_mode .parsnip_fns model_spec
      &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;        &lt;list&gt;    
1         1 lm              regression    linear_reg   &lt;spec[+]&gt; 
2         2 gee             regression    linear_reg   &lt;spec[+]&gt; 
3         3 glm             regression    linear_reg   &lt;spec[+]&gt; </code></pre>
</div>
</div>
<p>As shown we can easily select the models we want either by choosing the supported parsnip function like linear_reg() or by choose the desired engine, you can also use them both in conjunction with each other!</p>
<p>This function also does add a class to the output. Let’s see it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fast_regression_parsnip_spec_tbl</span>())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tidyaml_mod_spec_tbl" "fst_reg_spec_tbl"     "tidyaml_base_tbl"    
[4] "tbl_df"               "tbl"                  "data.frame"          </code></pre>
</div>
</div>
<p>We see that there are two added classes, first fst_reg_spec_tbl because this creates a set of non-tuning regression models and then tidyaml_mod_spec_tbl because this is a model specification tibble built with {tidyAML}</p>
<p>Now, what if you want to create a non-tuning model spec without using the fast_regression_parsnip_spec_tbl() function. Well, you can. The function is called create_model_spec().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_model_spec</span>(</span>
<span id="cb12-2"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_eng =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glmnet"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cubist"</span>),</span>
<span id="cb12-3"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_fns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb12-4">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span>,</span>
<span id="cb12-5">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span>,</span>
<span id="cb12-6">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span>,</span>
<span id="cb12-7">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cubist_rules"</span></span>
<span id="cb12-8">     )</span>
<span id="cb12-9"> )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  .parsnip_engine .parsnip_mode .parsnip_fns .model_spec
  &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;        &lt;list&gt;     
1 lm              regression    linear_reg   &lt;spec[+]&gt;  
2 glm             regression    linear_reg   &lt;spec[+]&gt;  
3 glmnet          regression    linear_reg   &lt;spec[+]&gt;  
4 cubist          regression    cubist_rules &lt;spec[+]&gt;  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_model_spec</span>(</span>
<span id="cb14-2"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_eng =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glmnet"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cubist"</span>),</span>
<span id="cb14-3"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_fns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb14-4">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span>,</span>
<span id="cb14-5">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span>,</span>
<span id="cb14-6">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span>,</span>
<span id="cb14-7">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cubist_rules"</span></span>
<span id="cb14-8">     ),</span>
<span id="cb14-9"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.return_tibble =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb14-10"> )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$.parsnip_engine
$.parsnip_engine[[1]]
[1] "lm"

$.parsnip_engine[[2]]
[1] "glm"

$.parsnip_engine[[3]]
[1] "glmnet"

$.parsnip_engine[[4]]
[1] "cubist"


$.parsnip_mode
$.parsnip_mode[[1]]
[1] "regression"


$.parsnip_fns
$.parsnip_fns[[1]]
[1] "linear_reg"

$.parsnip_fns[[2]]
[1] "linear_reg"

$.parsnip_fns[[3]]
[1] "linear_reg"

$.parsnip_fns[[4]]
[1] "cubist_rules"


$.model_spec
$.model_spec[[1]]
Linear Regression Model Specification (regression)

Computational engine: lm 


$.model_spec[[2]]
Linear Regression Model Specification (regression)

Computational engine: glm 


$.model_spec[[3]]
Linear Regression Model Specification (regression)

Computational engine: glmnet 


$.model_spec[[4]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! parsnip could not locate an implementation for `cubist_rules` regression
  model specifications using the `cubist` engine.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Cubist Model Specification (regression)

Computational engine: cubist </code></pre>
</div>
</div>
<p>The first example shows the output as a tibble, the second example shows the output as a list of model specs. The last one for cubist rules also shows how it will gracefully fail if the package is not loaded.</p>
<hr>
<p>Happy Coding!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>tidyaml</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-15/</guid>
  <pubDate>Mon, 15 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Exploring Random Walks with TidyDensity in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-11/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Welcome back, data enthusiasts! Today, we’re diving into the fascinating world of random walks using the TidyDensity R package. If you’re working with time series data, financial modeling, or stochastic processes, understanding random walks is essential. And with TidyDensity, implementing and visualizing these walks has never been easier.</p>
</section>
<section id="random-walks" class="level1">
<h1>Random Walks</h1>
<p>A random walk is a mathematical object that describes a path consisting of a succession of random steps. It’s a cornerstone concept in fields like physics, economics, and biology. In finance, for example, the random walk hypothesis suggests that stock market prices evolve according to a random walk and thus cannot be predicted.</p>
</section>
<section id="tidydensity-and-the-tidy_random_walk-function" class="level1">
<h1>TidyDensity and the <code>tidy_random_walk()</code> Function</h1>
<p>TidyDensity simplifies the generation and manipulation of random walks with its intuitive <code>tidy_random_walk()</code> function. This function can be used in conjunction with any <code>tidy_</code> distribution function, allowing for flexible and powerful random walk simulations.</p>
</section>
<section id="function-call" class="level1">
<h1>Function Call</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_random_walk</span>(</span>
<span id="cb1-2">  .data,</span>
<span id="cb1-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.initial_value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb1-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.sample =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb1-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb1-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.value_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cum_prod"</span></span>
<span id="cb1-7">)</span></code></pre></div>
<section id="arguments-breakdown" class="level2">
<h2 class="anchored" data-anchor-id="arguments-breakdown">Arguments Breakdown</h2>
<ul>
<li><strong><code>.data</code></strong>: The dataset from a <code>tidy_</code> distribution function. This forms the basis of your random walk.</li>
<li><strong><code>.initial_value</code></strong>: The starting value of the random walk. The default is 0, but you can set it to any numeric value.</li>
<li><strong><code>.sample</code></strong>: A boolean indicating whether to sample the <code>y</code> values from the <code>tidy_</code> distribution. Defaults to <code>FALSE</code>.</li>
<li><strong><code>.replace</code></strong>: If both <code>.sample</code> and <code>.replace</code> are <code>TRUE</code>, sampling is done with replacement. Defaults to <code>FALSE</code>.</li>
<li><strong><code>.value_type</code></strong>: Determines how the walk is computed. Options are:</li>
<li><code>"cum_prod"</code>: Computes the cumulative product of <code>y</code>.</li>
<li><code>"cum_sum"</code>: Computes the cumulative sum of <code>y</code>.</li>
</ul>
</section>
</section>
<section id="practical-examples" class="level1">
<h1>Practical Examples</h1>
<p>Let’s see <code>tidy_random_walk()</code> in action with some practical examples.</p>
<section id="example-1-simple-random-walk-with-cumulative-sum" class="level2">
<h2 class="anchored" data-anchor-id="example-1-simple-random-walk-with-cumulative-sum">Example 1: Simple Random Walk with Cumulative Sum</h2>
<p>First, let’s create a simple random walk using a normal distribution and compute the cumulative sum.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(TidyDensity)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_normal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_sims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_random_walk</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.value_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cum_sum"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_random_walk_autoplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-11/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, we generate 25 simulations of 100 points each from a normal distribution. The <code>tidy_random_walk()</code> function then computes the cumulative sum of these points, simulating a simple random walk. The <code>tidy_random_walk_autoplot()</code> function is used to visualize the random walk.</p>
</section>
<section id="example-2-random-walk-with-sampling" class="level2">
<h2 class="anchored" data-anchor-id="example-2-random-walk-with-sampling">Example 2: Random Walk with Sampling</h2>
<p>Next, we’ll explore a random walk where values are sampled.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_normal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_sims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_random_walk</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.value_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cum_sum"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.sample =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_random_walk_autoplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-11/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here, setting <code>.sample</code> to <code>TRUE</code> ensures that each step in the random walk is taken by randomly sampling from the original dataset. This can introduce additional variability and randomness to the walk.</p>
</section>
<section id="example-3-random-walk-with-sampling-and-replacement" class="level2">
<h2 class="anchored" data-anchor-id="example-3-random-walk-with-sampling-and-replacement">Example 3: Random Walk with Sampling and Replacement</h2>
<p>Finally, let’s create a random walk with sampling and replacement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_normal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_sims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_random_walk</span>(</span>
<span id="cb4-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.value_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cum_sum"</span>, </span>
<span id="cb4-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.sample =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb4-7">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_random_walk_autoplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-11/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, setting both <code>.sample</code> and <code>.replace</code> to <code>TRUE</code> ensures that values are sampled with replacement. This can be useful in bootstrapping scenarios or when simulating more complex stochastic processes.</p>
</section>
<section id="bonus-section-comparing-different-random-walk-sampling-methods" class="level2">
<h2 class="anchored" data-anchor-id="bonus-section-comparing-different-random-walk-sampling-methods">Bonus Section: Comparing Different Random Walk Sampling Methods</h2>
<p>To wrap up, let’s combine multiple random walks and visualize them using <code>ggplot2</code>. This bonus section will show you how different sampling methods impact the random walks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb5-5">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(</span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_normal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_sims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_random_walk</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.value_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cum_sum"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No_Sample"</span>),</span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_normal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_sims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_random_walk</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.value_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cum_sum"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.sample =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample_No_Replace"</span>),</span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_normal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_sims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_random_walk</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.value_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cum_sum"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.sample =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample_Replace"</span>)</span>
<span id="cb5-15">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(sim_number, x, random_walk_value, type) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low_ci =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x),</span>
<span id="cb5-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hi_ci =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x)</span>
<span id="cb5-20">  )</span>
<span id="cb5-21"></span>
<span id="cb5-22">atb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attributes</span>(df)</span>
<span id="cb5-23"></span>
<span id="cb5-24">df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, </span>
<span id="cb5-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> random_walk_value, </span>
<span id="cb5-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> sim_number, </span>
<span id="cb5-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(type))</span>
<span id="cb5-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.382</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> low_ci, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> sim_number), </span>
<span id="cb5-33">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> hi_ci, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> sim_number), </span>
<span id="cb5-35">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>type) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time"</span>,</span>
<span id="cb5-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random Walk Value"</span>,</span>
<span id="cb5-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random Walk with Different Sampling Methods"</span>,</span>
<span id="cb5-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simulations: "</span>, atb<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>all<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>.num_sims, </span>
<span id="cb5-44">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Steps: "</span>, atb<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>all<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>.n,</span>
<span id="cb5-45">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Distribution: "</span>, atb<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>all<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>dist_with_params</span>
<span id="cb5-46">                      )</span>
<span id="cb5-47">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-11/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="code-explanation" class="level2">
<h2 class="anchored" data-anchor-id="code-explanation">Code Explanation</h2>
<ol type="1">
<li><strong>Generating Data</strong>: We generate three sets of random walks using different sampling methods:</li>
</ol>
<ul>
<li>No sampling.</li>
<li>Sampling without replacement.</li>
<li>Sampling with replacement.</li>
</ul>
<p>Each set consists of 25 simulations of 100 steps.</p>
<ol start="2" type="1">
<li><p><strong>Combining Data</strong>: The results are combined into a single data frame, with a new column <code>type</code> to indicate the sampling method used.</p></li>
<li><p><strong>Calculating Confidence Intervals</strong>: We calculate the 95% confidence intervals for each step.</p></li>
<li><p><strong>Plotting</strong>: Using <code>ggplot2</code>, we plot the random walks, coloring by sampling method and adding dashed lines to indicate the confidence intervals. We also facet the plot by <code>type</code> to separate the different sampling methods visually.</p></li>
</ol>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Random walks are a powerful tool for modeling and understanding various phenomena. With TidyDensity and the <code>tidy_random_walk()</code> function, you can easily generate and visualize these processes in R. Whether you’re conducting financial analysis, simulating biological processes, or exploring theoretical concepts, TidyDensity offers a flexible and user-friendly approach.</p>
<p>Stay tuned for more tutorials and deep dives into the capabilities of TidyDensity. Happy coding!</p>
<hr>
<p>Feel free to try out these examples and explore the versatility of <code>tidy_random_walk()</code>. Share your insights and results with us in the comments below or on social media using #TidyDensity. Until next time, keep experimenting and learning!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>tidydensity</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-11/</guid>
  <pubDate>Thu, 11 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Using the FileDateTime Function in VBA from R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-10/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Welcome back to our series where we explore the synergy between R and VBA! Today, we’re diving into the <code>FileDateTime</code> function in VBA and how you can leverage it within R. This function is incredibly useful for anyone dealing with files, as it allows you to get the date and time when a file was last modified.</p>
</section>
<section id="what-is-filedatetime" class="level1">
<h1>What is <code>FileDateTime</code>?</h1>
<p>The <code>FileDateTime</code> function in VBA returns the date and time when a file was last modified. This can be particularly useful in various scenarios, such as tracking changes, logging file activities, or just keeping records up-to-date.</p>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<section id="basic-usage-of-filedatetime-in-vba" class="level2">
<h2 class="anchored" data-anchor-id="basic-usage-of-filedatetime-in-vba">Basic Usage of <code>FileDateTime</code> in VBA</h2>
<p>Let’s start with a simple example of how to use <code>FileDateTime</code> in VBA. Suppose you have a file located at <code>C:\example\myfile.txt</code>. Here’s how you can get its last modified date and time:</p>
<pre class="vba"><code>Sub GetFileDateTime()
    Dim filePath As String
    Dim fileModifiedDate As String

    filePath = "C:\example\myfile.txt"
    fileModifiedDate = FileDateTime(filePath)

    MsgBox "The file was last modified on: " &amp; fileModifiedDate
End Sub</code></pre>
<p>In this script: - <code>filePath</code> stores the path to the file. - <code>fileModifiedDate</code> gets the last modified date and time using <code>FileDateTime</code>. - <code>MsgBox</code> displays the result in a message box.</p>
</section>
<section id="executing-vba-from-r" class="level2">
<h2 class="anchored" data-anchor-id="executing-vba-from-r">Executing VBA from R</h2>
<p>To execute VBA code from R, you can use the <code>RDCOMClient</code> package, which allows R to interact with COM objects like Excel. Below is a step-by-step guide on how to achieve this:</p>
<ol type="1">
<li><p><strong>Install and Load the RDCOMClient Package</strong></p>
<p>First, ensure you have the <code>RDCOMClient</code> package installed. If not, you can install it from CRAN:</p></li>
</ol>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RDCOMClient"</span>)</span></code></pre></div>
<p>Then, load the package:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RDCOMClient)</span></code></pre></div>
<ol start="2" type="1">
<li><p><strong>Create a VBA Macro in Excel</strong></p>
<p>Open Excel and press <code>ALT + F11</code> to open the VBA editor. Create a new module and paste the <code>GetFileDateTime</code> function code. Save the Excel workbook with a <code>.xlsm</code> extension to enable macros.</p></li>
<li><p><strong>Run the VBA Macro from R</strong></p>
<p>Now, let’s write an R script to open the Excel workbook and run the macro:</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RDCOMClient)</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the path to your Excel workbook</span></span>
<span id="cb4-4">excelFilePath <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C:/Users/steve/Documents/GitHub/steveondata/posts/2024-07-10/file_date_time.xlsm"</span></span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create an Excel application object</span></span>
<span id="cb4-7">excelApp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">COMCreate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Excel.Application"</span>)</span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Open the workbook</span></span>
<span id="cb4-10">workbook <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> excelApp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Workbooks</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Open</span>(excelFilePath)</span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make Excel visible (optional)</span></span>
<span id="cb4-13">excelApp[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Visible"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb4-14"></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the macro</span></span>
<span id="cb4-16">excelApp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Run</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GetFileDateTime"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Close the workbook without saving changes</span></span>
<span id="cb6-2">workbook<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Close</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Quit the Excel application</span></span>
<span id="cb8-2">excelApp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Quit</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<p>In this R script:</p>
<ul>
<li><code>excelFilePath</code> specifies the path to your Excel workbook.</li>
<li><code>excelApp</code> creates an Excel application object.</li>
<li><code>workbook</code> opens the specified workbook.</li>
<li><code>excelApp$Run("GetFileDateTime")</code> runs the VBA macro.</li>
<li><code>workbook$Close(FALSE)</code> closes the workbook without saving changes.</li>
<li><code>excelApp$Quit()</code> quits the Excel application.</li>
</ul>
<p>Here is the message box:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-10/Screenshot.png" class="img-fluid figure-img"></p>
<figcaption>VBA FileDateTime</figcaption>
</figure>
</div>
</section>
</section>
<section id="understanding-the-workflow" class="level1">
<h1>Understanding the Workflow</h1>
<p>The above workflow shows how R can interact with Excel to execute VBA code. This approach is powerful for automating tasks that require both the statistical capabilities of R and the scripting power of VBA.</p>
</section>
<section id="try-it-yourself" class="level1">
<h1>Try It Yourself</h1>
<p>I encourage you to try this integration on your own. Modify the VBA code to suit your needs, and experiment with different R scripts to see how you can further automate your workflows. The combination of R and VBA opens up a lot of possibilities, and getting hands-on experience is the best way to learn.</p>
<p>Feel free to share your experiences or any questions you have in the comments below. Happy coding!</p>
<hr>
<p>Stay tuned for more posts where we continue to explore the exciting interplay between R and VBA!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>operations</category>
  <category>vba</category>
  <category>excel</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-10/</guid>
  <pubDate>Wed, 10 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Extracting Strings Before a Space in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-09/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hello, R users! Today, we’ll dive into a common text manipulation task: extracting strings before a space. This is a handy trick for dealing with names, addresses, or any text data where you need to isolate the first part of a string.</p>
<p>We’ll explore three approaches: using base R, <code>stringr</code>, and <code>stringi</code>. Each method offers its unique advantages, so you can choose the one that fits your style best.</p>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<section id="base-r-approach" class="level2">
<h2 class="anchored" data-anchor-id="base-r-approach">Base R Approach</h2>
<p>Let’s start with base R. The <code>sub</code> function is a versatile tool for pattern matching and replacement. To extract the string before a space, we can use a regular expression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample data</span></span>
<span id="cb1-2">text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"John Doe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jane Smith"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alice Johnson"</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract strings before the first space</span></span>
<span id="cb1-5">first_part_base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" .*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, text)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the result</span></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(first_part_base)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "John"  "Jane"  "Alice"</code></pre>
</div>
</div>
<p>In this example, the <code>sub</code> function replaces the space and everything after it with an empty string, effectively extracting the first part of each string.</p>
</section>
<section id="using-stringr" class="level2">
<h2 class="anchored" data-anchor-id="using-stringr">Using <code>stringr</code></h2>
<p>Next, let’s see how <code>stringr</code> simplifies this task. The <code>stringr</code> package, part of the tidyverse, provides a consistent and easy-to-use interface for string manipulation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load stringr package</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample data</span></span>
<span id="cb3-5">text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"John Doe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jane Smith"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alice Johnson"</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract strings before the first space</span></span>
<span id="cb3-8">first_part_stringr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_extract</span>(text, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^[^ ]+"</span>)</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the result</span></span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(first_part_stringr)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "John"  "Jane"  "Alice"</code></pre>
</div>
</div>
<p>Here, <code>str_extract</code> is used with a regular expression to match and extract the part of the string before the first space. The <code>^[^ ]+</code> pattern matches the beginning of the string (<code>^</code>) followed by one or more characters that are not a space (<code>[^ ]+</code>).</p>
</section>
<section id="using-stringi" class="level2">
<h2 class="anchored" data-anchor-id="using-stringi">Using <code>stringi</code></h2>
<p>Finally, let’s use <code>stringi</code>, a powerful package for advanced string operations. <code>stringi</code> functions are optimized for performance, making it a great choice for handling large datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load stringi package</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringi)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample data</span></span>
<span id="cb5-5">text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"John Doe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jane Smith"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alice Johnson"</span>)</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract strings before the first space</span></span>
<span id="cb5-8">first_part_stringi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stri_extract_first_regex</span>(text, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^[^ ]+"</span>)</span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the result</span></span>
<span id="cb5-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(first_part_stringi)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "John"  "Jane"  "Alice"</code></pre>
</div>
</div>
<p>With <code>stringi</code>, <code>stri_extract_first_regex</code> performs similarly to <code>str_extract</code> from <code>stringr</code>, using the same regular expression pattern.</p>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Each method—base R, <code>stringr</code>, and <code>stringi</code>—offers a straightforward way to extract strings before a space. Whether you prefer the simplicity of base R, the tidyverse consistency of <code>stringr</code>, or the performance optimization of <code>stringi</code>, you have powerful tools at your disposal.</p>
<p>I encourage you to try these examples on your own datasets. Text manipulation is a fundamental skill in data analysis, and mastering these techniques will enhance your ability to clean and prepare data for analysis.</p>
<p>Feel free to share your experiences and any additional tips you might have in the comments. Happy coding!</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To run the examples, just copy and paste the code blocks into your R script or R console.</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let me know how it goes!</span></span></code></pre></div>
<p>Until next time, keep exploring the wonders of R!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>operations</category>
  <category>strings</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-09/</guid>
  <pubDate>Tue, 09 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Unleashing the Power of TidyDensity: Simplifying Distribution Analysis in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-08/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>If you’re a data scientist or statistician who often deals with probability distributions, you know the importance of seamlessly integrating these functions into your workflow. That’s where the TidyDensity package comes into play. Designed to make producing <code>r</code>, <code>d</code>, <code>p</code>, and <code>q</code> data easy and compatible with the tidyverse, TidyDensity is a must-have tool in your R arsenal. In this post, we’ll explore the features and benefits of TidyDensity and show you why you should give it a try.</p>
</section>
<section id="why-tidydensity" class="level1">
<h1>Why TidyDensity?</h1>
<p>The primary goal of TidyDensity is to simplify the generation and manipulation of random samples (<code>r</code>), density (<code>d</code>), cumulative distribution (<code>p</code>), and quantile (<code>q</code>) functions. Traditional methods can be cumbersome and often require manual handling of data structures that don’t fit well with the tidyverse’s philosophy of tidy data. TidyDensity bridges this gap by providing functions that return results in a tidy format, making them easy to work with using dplyr, ggplot2, and other tidyverse packages.</p>
</section>
<section id="key-features" class="level1">
<h1>Key Features</h1>
<section id="seamless-integration-with-tidyverse" class="level2">
<h2 class="anchored" data-anchor-id="seamless-integration-with-tidyverse">Seamless Integration with Tidyverse</h2>
<p>TidyDensity ensures that all its output is in a tidy format, which means you can use the familiar suite of tidyverse tools to manipulate, visualize, and analyze your data. This compatibility streamlines your workflow and reduces the amount of data wrangling required.</p>
</section>
<section id="comprehensive-distribution-functions" class="level2">
<h2 class="anchored" data-anchor-id="comprehensive-distribution-functions">Comprehensive Distribution Functions</h2>
<p>Whether you’re dealing with normal, binomial, Poisson, or other distributions, TidyDensity has you covered. It includes functions for a wide range of distributions, each with options to generate random samples, calculate density, cumulative probabilities, and quantiles. This comprehensive coverage means you can rely on TidyDensity for almost any distribution-related task.</p>
</section>
<section id="easy-to-use-functions" class="level2">
<h2 class="anchored" data-anchor-id="easy-to-use-functions">Easy-to-Use Functions</h2>
<p>TidyDensity’s functions are designed with simplicity in mind. For example, to generate random samples from a normal distribution, you can use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(TidyDensity)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate random samples from a normal distribution</span></span>
<span id="cb1-4">normal_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_normal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_sims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View the first few rows</span></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(normal_samples)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  sim_number     x       y    dx       dy      p       q
  &lt;fct&gt;      &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 1              1 -1.50   -3.15 0.000182 0.0664 -1.50  
2 1              2  0.370  -3.08 0.000325 0.644   0.370 
3 1              3  0.558  -3.01 0.000561 0.712   0.558 
4 1              4 -1.28   -2.95 0.000938 0.101  -1.28  
5 1              5  0.0298 -2.88 0.00153  0.512   0.0298
6 1              6  0.189  -2.82 0.00241  0.575   0.189 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(normal_samples)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> sim_number       x                y                  dx         
 1:100      Min.   :  1.00   Min.   :-2.45677   Min.   :-3.5658  
 2:100      1st Qu.: 25.75   1st Qu.:-0.68839   1st Qu.:-1.5753  
 3:100      Median : 50.50   Median :-0.02975   Median : 0.1216  
 4:100      Mean   : 50.50   Mean   :-0.02445   Mean   : 0.1223  
 5:100      3rd Qu.: 75.25   3rd Qu.: 0.66779   3rd Qu.: 1.8087  
            Max.   :100.00   Max.   : 3.10887   Max.   : 4.3583  
       dy                  p                 q           
 Min.   :0.0001153   Min.   :0.00701   Min.   :-2.45677  
 1st Qu.:0.0198717   1st Qu.:0.24560   1st Qu.:-0.68839  
 Median :0.1003394   Median :0.48813   Median :-0.02975  
 Mean   :0.1468798   Mean   :0.49049   Mean   :-0.02445  
 3rd Qu.:0.2658815   3rd Qu.:0.74787   3rd Qu.: 0.66779  
 Max.   :0.4688206   Max.   :0.99906   Max.   : 3.10887  </code></pre>
</div>
</div>
<p>This code generates a tidy data frame with 100 random samples from a normal distribution with a mean of 0 and standard deviation of 1. You can then use dplyr and ggplot2 to manipulate and visualize this data effortlessly.</p>
</section>
<section id="practical-example" class="level2">
<h2 class="anchored" data-anchor-id="practical-example">Practical Example</h2>
<p>Let’s walk through a practical example to demonstrate how TidyDensity can be used in a typical data analysis workflow. Suppose you’re interested in analyzing the distribution of a sample dataset and visualizing its density.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load required libraries</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(TidyDensity)</span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate random samples from a normal distribution</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb5-7">normal_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_normal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the density of the samples</span></span>
<span id="cb5-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_autoplot</span>(normal_samples)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-08/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, we generate 1,000 random samples from a normal distribution with a mean of 5 and a standard deviation of 2. We then use ggplot2 to create a density plot, providing a clear visual representation of the distribution.</p>
</section>
</section>
<section id="try-tidydensity" class="level1">
<h1>Try TidyDensity!</h1>
<p>If you’re looking for a package that simplifies working with distributions while staying true to the tidyverse principles, TidyDensity is the solution you need. Its ease of use, comprehensive functionality, and seamless integration with the tidyverse make it an invaluable tool for anyone working with probability distributions in R.</p>
<p>I encourage you to try TidyDensity in your next project. Whether you’re conducting a detailed statistical analysis or simply need to generate random samples for simulation purposes, TidyDensity will make your life easier and your code cleaner.</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>TidyDensity is more than just another R package; it’s a tool designed to enhance your data analysis workflow by making distribution functions easy to use and compatible with the tidyverse. Give it a try and experience the difference it can make in your projects. For more information and detailed documentation, visit the <a href="https://www.spsanderson.com/TidyDensity/index.html">TidyDensity index page</a>.</p>
<hr>
<p>Happy coding!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>tidydensity</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-08/</guid>
  <pubDate>Mon, 08 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Exploring Linear Models with R and Exporting to Excel</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-07/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Today, we’re going to walk through an example of fitting a linear model in R, summarizing the results, and exporting the findings to an Excel file. This workflow is useful for documenting and sharing your statistical analysis.</p>
<p>Let’s break down the code step by step.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<section id="step-1-loading-the-necessary-libraries" class="level2">
<h2 class="anchored" data-anchor-id="step-1-loading-the-necessary-libraries">Step 1: Loading the Necessary Libraries</h2>
<p>First, we need to load the <code>openxlsx</code> library, which helps us create and manipulate Excel files. If you don’t have it installed, you can get it using <code>install.packages("openxlsx")</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(openxlsx)</span></code></pre></div>
</div>
<p>This line of code loads the <code>openxlsx</code> library into R so we can use its functions later.</p>
</section>
<section id="step-2-fitting-the-linear-model" class="level2">
<h2 class="anchored" data-anchor-id="step-2-fitting-the-linear-model">Step 2: Fitting the Linear Model</h2>
<p>Next, we fit a linear model using the built-in <code>mtcars</code> dataset. We model <code>mpg</code> (miles per gallon) based on all other available variables in the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span></code></pre></div>
</div>
<p>Here, <code>lm</code> stands for linear model. The <code>mpg ~ .</code> part means we want to predict <code>mpg</code> using all other variables in the <code>mtcars</code> dataset.</p>
</section>
<section id="step-3-summarizing-the-model" class="level2">
<h2 class="anchored" data-anchor-id="step-3-summarizing-the-model">Step 3: Summarizing the Model</h2>
<p>We obtain a summary of our linear model, which includes details like coefficients, R-squared values, and the F-statistic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">model_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)</span></code></pre></div>
</div>
<p>This code generates a summary of the linear model we just created, giving us important statistics about the model’s performance.</p>
</section>
<section id="step-4-extracting-key-components" class="level2">
<h2 class="anchored" data-anchor-id="step-4-extracting-key-components">Step 4: Extracting Key Components</h2>
<p>We extract essential parts of the summary for easy access and to organize them in our Excel file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">coefficients <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model_summary<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>coefficients</span>
<span id="cb4-2">r_squared <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model_summary<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>r.squared</span>
<span id="cb4-3">adj_r_squared <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model_summary<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>adj.r.squared</span>
<span id="cb4-4">f_statistic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model_summary<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fstatistic</span>
<span id="cb4-5">p_value <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pf</span>(</span>
<span id="cb4-6">  f_statistic[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb4-7">  f_statistic[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], </span>
<span id="cb4-8">  f_statistic[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], </span>
<span id="cb4-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lower.tail =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb4-10">  )</span>
<span id="cb4-11">model_formula <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb4-12">  model_summary[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"terms"</span>]][[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, </span>
<span id="cb4-13">  model_summary[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"terms"</span>]][[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>,</span>
<span id="cb4-14">  model_summary[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"terms"</span>]])[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]</span></code></pre></div>
</div>
<ul>
<li><code>coefficients</code>: The estimated coefficients of the model.</li>
<li><code>r_squared</code>: How well the model explains the variability of the data.</li>
<li><code>adj_r_squared</code>: Adjusted version of R-squared for the number of predictors.</li>
<li><code>f_statistic</code>: Overall significance of the model.</li>
<li><code>p_value</code>: Probability value indicating the significance of the F-statistic.</li>
<li><code>model_formula</code>: The formula used to fit the model.</li>
</ul>
</section>
<section id="step-5-creating-and-populating-the-workbook" class="level2">
<h2 class="anchored" data-anchor-id="step-5-creating-and-populating-the-workbook">Step 5: Creating and Populating the Workbook</h2>
<p>Now, we create a new Excel workbook and add a worksheet to it. We then write our extracted model summary components to this worksheet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">wb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">createWorkbook</span>()</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">addWorksheet</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficients"</span>, </span>
<span id="cb5-5">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, coefficients, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb5-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rowNames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R-Squared"</span>, </span>
<span id="cb5-10">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(coefficients) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, r_squared, </span>
<span id="cb5-12">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(coefficients) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-13"></span>
<span id="cb5-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adjusted R-Squared"</span>, </span>
<span id="cb5-15">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(coefficients) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, adj_r_squared, </span>
<span id="cb5-17">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(coefficients) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-18"></span>
<span id="cb5-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F-Statistic"</span>, </span>
<span id="cb5-20">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(coefficients) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, f_statistic[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb5-22">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(coefficients) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p-Value"</span>, </span>
<span id="cb5-25">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(coefficients) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, p_value, </span>
<span id="cb5-27">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(coefficients) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-28"></span>
<span id="cb5-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Formula"</span>, </span>
<span id="cb5-30">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(coefficients) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeData</span>(wb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Summary"</span>, model_formula, </span>
<span id="cb5-32">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startRow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(coefficients) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startCol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
</div>
<ul>
<li><code>createWorkbook()</code>: Creates a new Excel workbook.</li>
<li><code>addWorksheet(wb, "Model Summary")</code>: Adds a new sheet named “Model Summary” to the workbook.</li>
<li><code>writeData</code>: Writes data to the specified location in the sheet. Here, we write various parts of the model summary in different rows and columns.</li>
</ul>
</section>
<section id="step-6-saving-the-workbook" class="level2">
<h2 class="anchored" data-anchor-id="step-6-saving-the-workbook">Step 6: Saving the Workbook</h2>
<p>Finally, we save our workbook to a file named <code>lm_model_summary.xlsx</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveWorkbook</span>(</span>
<span id="cb6-2">  wb, </span>
<span id="cb6-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getwd</span>(),<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lm_model_summary.xlsx"</span>), </span>
<span id="cb6-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">overwrite =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-5">  )</span></code></pre></div>
</div>
<p>This line saves the workbook to your working directory with the specified file name.</p>
<p>Here is a screenshot:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-07-07/lm_model_summary.png" class="img-fluid figure-img"></p>
<figcaption>Excel Screenshot</figcaption>
</figure>
</div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>This example shows how to fit a linear model in R, extract meaningful summary statistics, and save those results in an Excel file. It’s a simple yet powerful way to document your analyses and share them with others.</p>
<p>Feel free to modify the code to fit your own datasets and models. Experimenting with different variables and models can provide deeper insights into your data. Happy coding!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>excel</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-07/</guid>
  <pubDate>Sun, 07 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Automate Your R Scripts with taskscheduleR</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-06/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Today, let’s dive into a nifty R package called <code>taskscheduleR</code> that can automate running your R scripts. Whether you need to execute a task every hour or just once a day, <code>taskscheduleR</code> has you covered. This package leverages the Windows Task Scheduler, making it a breeze to schedule and automate repetitive tasks directly from R. Let’s walk through a couple of examples from my new book, “Extending Excel with Python and R”.</p>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<section id="example-1-hourly-script-execution" class="level2">
<h2 class="anchored" data-anchor-id="example-1-hourly-script-execution">Example 1: Hourly Script Execution</h2>
<p>First, let’s set up a task that runs a script every hour. Here’s the code:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(taskscheduleR)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a task scheduler job that runs the script every hour</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">taskscheduler_create</span>(</span>
<span id="cb1-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">taskname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hello World Hourly"</span>,</span>
<span id="cb1-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rscript =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello_world.R"</span>,</span>
<span id="cb1-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">schedule =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0 * * * *"</span></span>
<span id="cb1-8">)</span></code></pre></div>
<p>In this snippet, we use the <code>taskscheduler_create()</code> function to create a new task. Let’s break down the arguments:</p>
<ul>
<li><code>taskname</code>: A unique name for the task, in this case, “Hello World Hourly”.</li>
<li><code>rscript</code>: The path to the R script you want to run, here it’s “hello_world.R”.</li>
<li><code>schedule</code>: This is the cron expression for scheduling. <code>0 * * * *</code> means the script will run at the start of every hour.</li>
</ul>
</section>
<section id="example-2-daily-script-execution-at-a-specific-time" class="level2">
<h2 class="anchored" data-anchor-id="example-2-daily-script-execution-at-a-specific-time">Example 2: Daily Script Execution at a Specific Time</h2>
<p>Now, let’s set up a task that runs the script once a day at 10:00 AM. Here’s how you can do it:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a task scheduler job that runs the script once a day at 10:00 AM</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">taskscheduler_create</span>(</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">taskname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hello World Daily"</span>,</span>
<span id="cb2-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rscript =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello_world.R"</span>,</span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">schedule =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0 10 * * *"</span></span>
<span id="cb2-6">)</span></code></pre></div>
<p>In this example, the <code>schedule</code> argument <code>0 10 * * *</code> ensures the script runs daily at 10:00 AM.</p>
</section>
</section>
<section id="why-automate" class="level1">
<h1>Why Automate?</h1>
<p>Scheduling routine tasks can save you a lot of time and reduce the chances of forgetting to run an important script. Whether it’s updating a report, fetching data, or performing backups, automation ensures that these tasks run consistently and accurately without manual intervention.</p>
</section>
<section id="give-it-a-try" class="level1">
<h1>Give It a Try!</h1>
<p>I encourage you to experiment with <code>taskscheduleR</code> and see how it can fit into your workflow. Whether you’re new to automation or looking for ways to optimize your existing processes, this package offers a simple yet powerful solution.</p>
<p>If you found this helpful and want to learn more about extending your Excel capabilities with R and Python, check out my new book, “Extending Excel with Python and R”. It’s packed with practical examples and detailed explanations to help you get the most out of these powerful tools.</p>
<ul>
<li><strong>Amazon:</strong> <a href="https://packt.link/oTyZJ">Extending Excel with Python and R</a></li>
<li><strong>Packt:</strong> <a href="https://www.packtpub.com/en-us/product/extending-excel-with-python-and-r-9781804610695">Extending Excel with Python and R</a></li>
</ul>
<p>Happy coding!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>operations</category>
  <category>automation</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-06/</guid>
  <pubDate>Sat, 06 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Mastering Zoom Functionality in Excel with VBA</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-03/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>When working with large datasets in Excel, the ability to zoom in and out quickly can significantly enhance your productivity. If you often find yourself adjusting the zoom level manually, why not automate it with VBA? In this blog post, we’ll explore how to use the zoom functionality in VBA to control the zoom level of your worksheets efficiently.</p>
</section>
<section id="why-use-zoom-in-excel" class="level1">
<h1>Why Use Zoom in Excel?</h1>
<p>Zooming in Excel allows you to get a closer look at your data or see more of your worksheet at once. Whether you’re focusing on a specific section of data or getting an overview of your entire sheet, zooming can help you navigate and analyze your information more effectively.</p>
</section>
<section id="getting-started-with-zoom-in-vba" class="level1">
<h1>Getting Started with Zoom in VBA</h1>
<p>To control the zoom level in Excel using VBA, you’ll primarily work with the <code>ActiveWindow.Zoom</code> property. This property allows you to set the zoom level to any value between 10% and 400%.</p>
<section id="basic-zoom-in-and-zoom-out" class="level2">
<h2 class="anchored" data-anchor-id="basic-zoom-in-and-zoom-out">Basic Zoom In and Zoom Out</h2>
<p>Let’s start with simple macros to zoom in and zoom out.</p>
<p><strong>Zoom In:</strong></p>
<pre class="vba"><code>Sub ZoomIn()
    Dim currentZoom As Integer
    currentZoom = ActiveWindow.Zoom
    If currentZoom &lt; 400 Then
        ActiveWindow.Zoom = currentZoom + 10
    End If
End Sub</code></pre>
<p><strong>Zoom Out:</strong></p>
<pre class="vba"><code>Sub ZoomOut()
    Dim currentZoom As Integer
    currentZoom = ActiveWindow.Zoom
    If currentZoom &gt; 10 Then
        ActiveWindow.Zoom = currentZoom - 10
    End If
End Sub</code></pre>
<p>In these macros, <code>ZoomIn</code> increases the current zoom level by 10%, while <code>ZoomOut</code> decreases it by 10%. The code ensures that the zoom level stays within the permissible range of 10% to 400%.</p>
</section>
<section id="setting-a-specific-zoom-level" class="level2">
<h2 class="anchored" data-anchor-id="setting-a-specific-zoom-level">Setting a Specific Zoom Level</h2>
<p>Sometimes, you might need to set the zoom level to a specific percentage. You can do this easily with the following macro:</p>
<pre class="vba"><code>Sub SetZoomLevel(zoomLevel As Integer)
    If zoomLevel &gt;= 10 And zoomLevel &lt;= 400 Then
        ActiveWindow.Zoom = zoomLevel
    Else
        MsgBox "Please enter a zoom level between 10 and 400."
    End If
End Sub</code></pre>
<p>You can call this macro with any desired zoom level. For example:</p>
<pre class="vba"><code>Sub ZoomToSpecificLevel()
    Call SetZoomLevel(150) ' Sets the zoom level to 150%
End Sub</code></pre>
</section>
<section id="resetting-the-zoom-level" class="level2">
<h2 class="anchored" data-anchor-id="resetting-the-zoom-level">Resetting the Zoom Level</h2>
<p>If you need to reset the zoom level to its default setting (usually 100%), you can use the following macro:</p>
<pre class="vba"><code>Sub ResetZoom()
    ActiveWindow.Zoom = 100
End Sub</code></pre>
</section>
<section id="applying-zoom-to-a-specific-worksheet" class="level2">
<h2 class="anchored" data-anchor-id="applying-zoom-to-a-specific-worksheet">Applying Zoom to a Specific Worksheet</h2>
<p>The above examples modify the zoom level of the currently active window. If you want to set the zoom level for a specific worksheet, you can activate that sheet first and then set the zoom level:</p>
<pre class="vba"><code>Sub ZoomSpecificSheet(sheetName As String, zoomLevel As Integer)
    Worksheets(sheetName).Activate
    If zoomLevel &gt;= 10 And zoomLevel &lt;= 400 Then
        ActiveWindow.Zoom = zoomLevel
    Else
        MsgBox "Please enter a zoom level between 10 and 400."
    End If
End Sub</code></pre>
</section>
<section id="using-zoom-with-user-forms" class="level2">
<h2 class="anchored" data-anchor-id="using-zoom-with-user-forms">Using Zoom with User Forms</h2>
<p>Zoom functionality isn’t limited to worksheets. You can also control the zoom level of user forms in VBA. This is especially useful if your user form contains detailed information or numerous controls.</p>
<pre class="vba"><code>Sub ZoomUserForm(zoomLevel As Double)
    With UserForm1
        .Zoom = zoomLevel
    End With
End Sub</code></pre>
<p>Call this macro with a zoom level between 10 and 400 to adjust the user form’s zoom.</p>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Whether you need to zoom in for a closer look, zoom out to see more data, or set a specific zoom level, VBA provides a simple and powerful way to control your view.</p>
<p>By incorporating these macros into your workflow, you can easily adjust your zoom settings without leaving the keyboard. Experiment with these examples, and you’ll soon find the perfect zoom levels to enhance your productivity in Excel.</p>
<hr>
<p>Happy coding!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>vba</category>
  <category>excel</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-03/</guid>
  <pubDate>Wed, 03 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>How to Extract String After a Specific Character in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-02/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Welcome back, R Programmers! Today, we’ll explore a common task: extracting a substring after a specific character in R. Whether you’re cleaning data or transforming strings, this skill is quite handy. We’ll look at three approaches: using base R, <code>stringr</code>, and <code>stringi</code>. Let’s dive in!</p>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<section id="using-base-r" class="level2">
<h2 class="anchored" data-anchor-id="using-base-r">Using Base R</h2>
<p>Base R provides several functions to manipulate strings. Here, we’ll use <code>sub</code> and <code>strsplit</code> to extract a substring after a specific character.</p>
<section id="example-1-using-sub" class="level3">
<h3 class="anchored" data-anchor-id="example-1-using-sub">Example 1: Using <code>sub</code></h3>
<p>The <code>sub</code> function allows us to replace parts of a string based on a pattern. Here’s how to extract the part after a specific character, say a hyphen (<code>-</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example string</span></span>
<span id="cb1-2">string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data-science"</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract substring after the hyphen</span></span>
<span id="cb1-5">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*-"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, string)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "science"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "science"</code></pre>
</div>
</div>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>.*-</code> is a regular expression where <code>.*</code> matches any character (except for line terminators) zero or more times, and <code>-</code> matches the hyphen.</li>
<li><code>""</code> is the replacement, effectively removing everything up to and including the hyphen.</li>
</ul>
</section>
<section id="example-2-using-strsplit" class="level3">
<h3 class="anchored" data-anchor-id="example-2-using-strsplit">Example 2: Using <code>strsplit</code></h3>
<p>The <code>strsplit</code> function splits a string into substrings based on a delimiter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example string</span></span>
<span id="cb3-2">string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello-world"</span></span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the string at the hyphen</span></span>
<span id="cb3-5">parts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(string, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the part after the hyphen</span></span>
<span id="cb3-8">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> parts[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb3-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "world"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "world"</code></pre>
</div>
</div>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>strsplit(string, "-")</code> splits the string into parts at the hyphen, returning a list.</li>
<li><code>[[1]]</code> extracts the first element of the list.</li>
<li><code>[2]</code> extracts the second part of the split string.</li>
</ul>
</section>
</section>
<section id="using-stringr" class="level2">
<h2 class="anchored" data-anchor-id="using-stringr">Using <code>stringr</code></h2>
<p>The <code>stringr</code> package, part of the tidyverse, provides consistent and easy-to-use string functions.</p>
<section id="example-1-using-str_extract" class="level3">
<h3 class="anchored" data-anchor-id="example-1-using-str_extract">Example 1: Using <code>str_extract</code></h3>
<p>The <code>str_extract</code> function extracts matching patterns from a string.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example string</span></span>
<span id="cb5-4">string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apple-pie"</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract substring after the hyphen</span></span>
<span id="cb5-7">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_extract</span>(string, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(?&lt;=-).*"</span>)</span>
<span id="cb5-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "pie"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "pie"</code></pre>
</div>
</div>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>(?&lt;=-)</code> is a look behind assertion, ensuring the match occurs after a hyphen.</li>
<li><code>.*</code> matches any character zero or more times.</li>
</ul>
</section>
<section id="example-2-using-str_split" class="level3">
<h3 class="anchored" data-anchor-id="example-2-using-str_split">Example 2: Using <code>str_split</code></h3>
<p>Similar to <code>strsplit</code> in base R, <code>str_split</code> splits a string based on a pattern.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example string</span></span>
<span id="cb7-2">string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"open-source"</span></span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the string at the hyphen</span></span>
<span id="cb7-5">parts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(string, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the part after the hyphen</span></span>
<span id="cb7-8">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> parts[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb7-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "source"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "source"</code></pre>
</div>
</div>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>str_split(string, "-")</code> splits the string into parts at the hyphen, returning a list.</li>
<li><code>[[1]]</code> extracts the first element of the list.</li>
<li><code>[2]</code> extracts the second part of the split string.</li>
</ul>
</section>
</section>
<section id="using-stringi" class="level2">
<h2 class="anchored" data-anchor-id="using-stringi">Using <code>stringi</code></h2>
<p>The <code>stringi</code> package is another powerful tool for string manipulation, providing high-performance functions.</p>
<section id="example-1-using-stri_extract" class="level3">
<h3 class="anchored" data-anchor-id="example-1-using-stri_extract">Example 1: Using <code>stri_extract</code></h3>
<p>The <code>stri_extract</code> function extracts substrings based on patterns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringi)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example string</span></span>
<span id="cb9-4">string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"front-end"</span></span>
<span id="cb9-5"></span>
<span id="cb9-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract substring after the hyphen</span></span>
<span id="cb9-7">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stri_extract</span>(string, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regex =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(?&lt;=-).*"</span>)</span>
<span id="cb9-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "end"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "end"</code></pre>
</div>
</div>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>regex = "(?&lt;=-).*"</code> uses a regular expression where <code>(?&lt;=-)</code> is a lookbehind assertion ensuring the match occurs after a hyphen, and <code>.*</code> matches any character zero or more times.</li>
</ul>
</section>
<section id="example-2-using-stri_split" class="level3">
<h3 class="anchored" data-anchor-id="example-2-using-stri_split">Example 2: Using <code>stri_split</code></h3>
<p>Similar to <code>strsplit</code> and <code>str_split</code>, <code>stri_split</code> splits a string based on a pattern.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example string</span></span>
<span id="cb11-2">string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"full-stack"</span></span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the string at the hyphen</span></span>
<span id="cb11-5">parts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stri_split</span>(string, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regex =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the part after the hyphen</span></span>
<span id="cb11-8">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> parts[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb11-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output: "stack"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "stack"</code></pre>
</div>
</div>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>stri_split(string, regex = "-")</code> splits the string into parts at the hyphen, returning a list.</li>
<li><code>[[1]]</code> extracts the first element of the list.</li>
<li><code>[2]</code> extracts the second part of the split string.</li>
</ul>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>There you have it—three different ways to extract a substring after a specific character in R. Each method has its own benefits and can be handy depending on your specific needs. Give these examples a try and see which one works best for your data!</p>
<hr>
<p>Happy coding!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>operations</category>
  <category>strings</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-02/</guid>
  <pubDate>Tue, 02 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Unlocking the Power of Administrative Data with healthyR.data</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-07-01/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hello, fellow data enthusiasts! Today, I’m excited to share insights into the <strong>{ healthyR.data }</strong> package, an essential tool in the healthyverse that will streamline your data exploration and testing processes. Whether you’re a seasoned data scientist or just starting out in data analytics, this package is designed to be valuable for everyone.</p>
<section id="what-is-healthyr.data" class="level2">
<h2 class="anchored" data-anchor-id="what-is-healthyr.data">What is { healthyR.data }?</h2>
<p>The <strong>{ healthyR.data }</strong> package serves two primary purposes: providing a robust administrative data set for testing functions in the <strong>{ healthyR }</strong> package and facilitating the download of important data from the Centers for Medicare and Medicaid Services (CMS), a division of the Department of Health and Human Services (HHS). This package is your resource for comprehensive data that can enhance your analytical capabilities and simplify your testing procedures.</p>
</section>
<section id="key-features" class="level2">
<h2 class="anchored" data-anchor-id="key-features">Key Features</h2>
<section id="comprehensive-administrative-data-set" class="level3">
<h3 class="anchored" data-anchor-id="comprehensive-administrative-data-set">1. Comprehensive Administrative Data Set</h3>
<p>One of the main features of <strong>{ healthyR.data }</strong> is its extensive administrative data set. This data set is carefully curated to include a variety of scenarios and variables commonly found in healthcare data analysis. This makes it an excellent tool for testing the functions of the <strong>{ healthyR }</strong> package, ensuring your analytical methods are reliable and effective.</p>
</section>
<section id="cms-data-access" class="level3">
<h3 class="anchored" data-anchor-id="cms-data-access">2. CMS Data Access</h3>
<p>In addition to its built-in data set, <strong>{ healthyR.data }</strong> allows you to download data directly from CMS. This feature is especially useful for healthcare analysts who need up-to-date and detailed data for their analyses. With <strong>{ healthyR.data }</strong>, you can easily access a wealth of information to drive insightful analysis.</p>
</section>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>To start using <strong>{ healthyR.data }</strong>, you can install it from CRAN with the following command:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"healthyR.data"</span>)</span></code></pre></div>
<p>Once installed, load the package with:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(healthyR.data)</span></code></pre></div>
</section>
<section id="functions" class="level2">
<h2 class="anchored" data-anchor-id="functions">Functions</h2>
<p>Load the libraries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(healthyR.data)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DT)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Functions and their arguments for healthyR</span></span>
<span id="cb4-2"></span>
<span id="cb4-3">pat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%&gt;%"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"as_label"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"as_name"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enquo"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enquos"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"expr"</span>,</span>
<span id="cb4-4">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sym"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"syms"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"healthyR_data"</span>)</span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls.str</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"package:healthyR.data"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>fns <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> pat) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">params =</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(fns, formalArgs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(fns) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">func_with_params =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toString</span>(params)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">func_with_params =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(</span>
<span id="cb4-13">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(</span>
<span id="cb4-14">        func_with_params, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">("</span>), </span>
<span id="cb4-15">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(fns, func_with_params), </span>
<span id="cb4-16">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(fns, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>, func_with_params, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>)</span>
<span id="cb4-17">    )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(fns, func_with_params) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(fns)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">datatable</span>(</span>
<span id="cb4-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#class = 'cell-boarder-stripe',</span></span>
<span id="cb4-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Function"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Full Call"</span>),</span>
<span id="cb4-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb4-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">autowidth =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb4-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pageLength =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb4-26">    )</span>
<span id="cb4-27">  )</span></code></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-0f7976018fc39b19273a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0f7976018fc39b19273a">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26"],["current_asc_data","current_asc_oas_cahps_data","current_comp_death_data","current_hai_data","current_hcahps_data","current_hosp_data","current_hosp_data_dict","current_hvbp_data","current_ipfqr_data","current_maternal_data","current_medicare_hospital_spending_data","current_oqr_oas_cahps_data","current_outpatient_imaging_efficiency_data","current_payments_data","current_pch_hai_hospital_data","current_pch_hcahps_data","current_pch_oncology_measures_hospital_data","current_pch_outcomes_data","current_timely_and_effective_care_data","current_unplanned_hospital_vists_data","current_va_data","fetch_cms_data","fetch_provider_data","get_cms_meta_data","get_provider_meta_data","is_valid_url"],["current_asc_datac(\".data\", \".data_sets\")","current_asc_oas_cahps_datac(\".data\", \".data_sets\")","current_comp_death_datac(\".data\", \".data_sets\")","current_hai_datac(\".data\", \".data_sets\")","current_hcahps_datac(\".data\", \".data_sets\")","current_hosp_data(path)","current_hosp_data_dict(.open_folder)","current_hvbp_datac(\".data\", \".data_sets\")","current_ipfqr_datac(\".data\", \".data_sets\")","current_maternal_datac(\".data\", \".data_sets\")","current_medicare_hospital_spending_datac(\".data\", \".data_sets\")","current_oqr_oas_cahps_datac(\".data\", \".data_sets\")","current_outpatient_imaging_efficiency_datac(\".data\", \".data_sets\")","current_payments_datac(\".data\", \".data_sets\")","current_pch_hai_hospital_data(.data)","current_pch_hcahps_datac(\".data\", \".data_sets\")","current_pch_oncology_measures_hospital_data(.data)","current_pch_outcomes_datac(\".data\", \".data_sets\")","current_timely_and_effective_care_datac(\".data\", \".data_sets\")","current_unplanned_hospital_vists_datac(\".data\", \".data_sets\")","current_va_datac(\".data\", \".data_sets\")","fetch_cms_data(.data_link)","fetch_provider_datac(\".data_link\", \".limit\")","get_cms_meta_datac(\".title\", \".modified_date\", \".keyword\", \".identifier\", \".data_version\", \".media_type\")","get_provider_meta_datac(\".identifier\", \".title\", \".description\", \".keyword\", \".issued\", \".modified\", \".released\", \".theme\", \".media_type\")","is_valid_url(url)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Function<\/th>\n      <th>Full Call<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"autowidth":true,"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"fns","targets":1},{"name":"func_with_params","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="using-the-administrative-data-set" class="level2">
<h2 class="anchored" data-anchor-id="using-the-administrative-data-set">Using the Administrative Data Set</h2>
<p>The administrative data set included in <strong>{ healthyR.data }</strong> is ready for your analytical projects. Here’s a quick example:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the healthyR.data package</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(healthyR.data)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Explore the dataset</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"healthyR_data"</span>)</span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(healthyR_data)</span></code></pre></div>
<p>This will give you a look at the data and its structure, providing a strong foundation for your analysis.</p>
</section>
<section id="downloading-cms-data" class="level2">
<h2 class="anchored" data-anchor-id="downloading-cms-data">Downloading CMS Data</h2>
<p>Accessing CMS data is simple with <strong>{ healthyR.data }</strong>. The package includes functions that allow you to download various datasets directly from the CMS website. Here’s how:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download CMS data</span></span>
<span id="cb6-2">cms_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_cms_meta_data</span>()</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View the downloaded data</span></span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(cms_data)</span></code></pre></div>
<p>This function fetches the latest data from CMS, ensuring your analyses are based on current information.</p>
</section>
<section id="latest-updates-and-features" class="level2">
<h2 class="anchored" data-anchor-id="latest-updates-and-features">Latest Updates and Features</h2>
<p>The <strong>{ healthyR.data }</strong> package is continually updated, with new features and improvements added regularly. The latest version, 1.1.0, includes several enhancements that make the package even more powerful and user-friendly. For a detailed overview of the latest updates, check out the <a href="https://www.spsanderson.com/healthyR.data/news/index.html#healthyrdata-110">NEWS</a> section.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In summary, <strong>{ healthyR.data }</strong> is a versatile package that provides essential tools for healthcare data analysis. Whether you’re testing functions from the <strong>{ healthyR }</strong> package or downloading the latest CMS data, <strong>{ healthyR.data }</strong> has you covered. I encourage you to download the package and explore how it can enhance your analytical projects.</p>
<p>Happy coding, and may your data always be insightful!</p>
<hr>
<p>For more information and detailed documentation, visit the <a href="https://www.spsanderson.com/healthyR.data/reference/index.html">reference page</a>. Stay tuned for more updates and tips on how to get the most out of the healthyverse packages!</p>


</section>
</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>healthyrdata</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-07-01/</guid>
  <pubDate>Mon, 01 Jul 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>How to Execute VBA Code in Excel via R using RDCOMClient</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-06-28/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hey everyone,</p>
<p>Today, I want to share a neat way to bridge the gap between R and Excel using VBA. Specifically, we’ll look at how to run VBA code in Excel directly from R. This can be incredibly useful if you’re looking to automate repetitive tasks or leverage the power of VBA while working within the R environment.</p>
<p>We’ll use the <code>RDCOMClient</code> library, which allows R to control COM (Component Object Model) objects, such as an Excel application. If you’ve ever found yourself toggling between R and Excel, this method will streamline your workflow significantly.</p>
<section id="what-well-do" class="level2">
<h2 class="anchored" data-anchor-id="what-well-do">What We’ll Do</h2>
<p>We’ll write a VBA macro that populates cells A1:A10 with random numbers and then run this macro from R.</p>
</section>
<section id="step-by-step-guide" class="level2">
<h2 class="anchored" data-anchor-id="step-by-step-guide">Step-by-Step Guide</h2>
<section id="install-and-load-rdcomclient" class="level4">
<h4 class="anchored" data-anchor-id="install-and-load-rdcomclient">1. Install and Load <code>RDCOMClient</code></h4>
<p>First, you’ll need to install the <code>RDCOMClient</code> package. It’s not available on CRAN, so you have to install it from the <code>omegahat</code> repository.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RDCOMClient"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repos =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://www.omegahat.net/R"</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RDCOMClient)</span></code></pre></div>
</section>
<section id="set-up-excel-and-vba-macro" class="level4">
<h4 class="anchored" data-anchor-id="set-up-excel-and-vba-macro">2. Set Up Excel and VBA Macro</h4>
<p>Open Excel and press <code>ALT + F11</code> to open the VBA editor. Insert a new module and add the following VBA code:</p>
<pre class="vba"><code>Sub FillRandomNumbers()
    Dim i As Integer
    For i = 1 To 10
        Cells(i, 1).Value = Rnd()
    Next i
End Sub</code></pre>
<p>This macro fills cells A1 to A10 with random numbers.</p>
</section>
<section id="run-the-vba-macro-from-r" class="level4">
<h4 class="anchored" data-anchor-id="run-the-vba-macro-from-r">3. Run the VBA Macro from R</h4>
<p>Now, let’s write the R code to open Excel, run the macro, and then close Excel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the RDCOMClient library</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RDCOMClient)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new instance of Excel application</span></span>
<span id="cb3-5">excel_app <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">COMCreate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Excel.Application"</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make Excel visible (optional)</span></span>
<span id="cb3-8">excel_app[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Visible"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add a new workbook</span></span>
<span id="cb3-11">wb_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Users</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">steve</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Documents</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">GitHub</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">steveondata</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">posts</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2024-06-28</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">vba_rand_from_r.xlsm"</span></span>
<span id="cb3-12">workbook <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> excel_app[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Workbooks"</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Open</span>(wb_path)</span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reference the first sheet</span></span>
<span id="cb3-15">sheet <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> workbook<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Worksheets</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the macro</span></span>
<span id="cb3-18">excel_app<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Run</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FillRandomNumbers"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save the workbook (optional)</span></span>
<span id="cb5-2">workbook<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">SaveAs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Users</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">steve</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Documents</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">GitHub</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">steveondata</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">posts</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2024-06-28</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">random_numbers.xlsm"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Close Excel</span></span>
<span id="cb7-2">excel_app<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Quit</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Release the COM object</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(excel_app)</span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(sheet)</span>
<span id="cb9-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(workbook)</span>
<span id="cb9-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gc</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used (Mb) gc trigger (Mb) max used (Mb)
Ncells  666819 35.7    1477710   79  1122664 60.0
Vcells 1220653  9.4    8388608   64  1770896 13.6</code></pre>
</div>
</div>
</section>
<section id="explanation" class="level3">
<h3 class="anchored" data-anchor-id="explanation">Explanation</h3>
<ol type="1">
<li><strong>Initialize Excel Application</strong>: <code>COMCreate("Excel.Application")</code> starts a new instance of Excel.</li>
<li><strong>Make Excel Visible</strong>: This step is optional but useful for debugging.</li>
<li><strong>Add Workbook and Reference Worksheet</strong>: We create a new workbook and reference the first sheet.</li>
<li><strong>Run the Macro</strong>: <code>excel_app$Run("FillRandomNumbers")</code> executes the macro.</li>
<li><strong>Save Workbook</strong>: Optionally save the workbook with the generated random numbers.</li>
<li><strong>Close and Clean Up</strong>: Close Excel and clean up the COM object to free up resources.</li>
</ol>
</section>
</section>
</section>
<section id="did-it-work" class="level1">
<h1>Did it work?</h1>
<p>Let’s make sure this actually worked.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readxl)</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_excel</span>(</span>
<span id="cb11-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Users</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">steve</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Documents</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">GitHub</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">steveondata</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">posts</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2024-06-28</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">random_numbers.xlsm"</span>,</span>
<span id="cb11-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb11-6">)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 1
     ...1
    &lt;dbl&gt;
 1 0.706 
 2 0.533 
 3 0.580 
 4 0.290 
 5 0.302 
 6 0.775 
 7 0.0140
 8 0.761 
 9 0.814 
10 0.709 </code></pre>
</div>
</div>
</section>
<section id="try-it-yourself" class="level1">
<h1>Try It Yourself</h1>
<p>Give this a try and see how you can extend it to your own needs. Whether it’s automating report generation, data cleaning, or complex calculations, integrating R with VBA can enhance your productivity significantly. The <code>RDCOMClient</code> package opens up a world of possibilities for combining the strengths of R and Excel.</p>
<p>Feel free to share your experiences or ask questions in the comments.</p>
<hr>
<p>Happy coding!</p>
<p>Steve</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>vba</category>
  <category>excel</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-06-28/</guid>
  <pubDate>Fri, 28 Jun 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Exploring Random Walks and Brownian Motions with healthyR.ts</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-06-27/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In the world of time series analysis, Random Walks, Brownian Motion, and Geometric Brownian Motion are fundamental concepts used in various fields, including finance, physics, and biology. Today, we’ll explore these concepts using functions from the <code>healthyR.ts</code> package.</p>
<section id="random-walks" class="level2">
<h2 class="anchored" data-anchor-id="random-walks">Random Walks</h2>
<p>A Random Walk is a path that consists of a series of random steps. It’s a simple but powerful concept used to model seemingly unpredictable paths, such as stock prices or animal movements.</p>
<p>Let’s generate and plot some Random Walks using the <code>ts_random_walk()</code> function from <code>healthyR.ts</code>.</p>
<section id="function-syntax" class="level3">
<h3 class="anchored" data-anchor-id="function-syntax">Function Syntax</h3>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_random_walk</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb1-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.sd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb1-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_walks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb1-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.periods =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb1-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.initial_value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb1-7">)</span></code></pre></div>
<ul>
<li><code>.mean</code>: The desired mean of the random walks.</li>
<li><code>.sd</code>: The standard deviation of the random walks.</li>
<li><code>.num_walks</code>: The number of random walks you want to generate.</li>
<li><code>.periods</code>: The length of the random walk(s) you want to generate.</li>
<li><code>.initial_value</code>: The initial value where the random walks should start.</li>
</ul>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(healthyR.ts)</span>
<span id="cb2-3"></span>
<span id="cb2-4">random_walk_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_random_walk</span>(</span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.sd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, </span>
<span id="cb2-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_walks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.periods =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, </span>
<span id="cb2-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.initial_value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb2-10">  )</span>
<span id="cb2-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(random_walk_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
    run     x       y cum_y
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1     1     1  0.0725 1072.
2     1     2  0.182  1267.
3     1     3  0.110  1407.
4     1     4  0.0275 1445.
5     1     5 -0.0546 1367.
6     1     6  0.0712 1464.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">random_walk_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> random_walk_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb4-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb4-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cum_y,</span>
<span id="cb4-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(run),</span>
<span id="cb4-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(run)</span>
<span id="cb4-8">    )</span>
<span id="cb4-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_random_walk_ggplot_layers</span>(random_walk_data)</span>
<span id="cb4-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(random_walk_plot)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/2024-06-27/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code generates 10 random walks over 100 periods, starting from an initial value of 1000. The resulting plot visualizes the paths of these random walks, each represented by a different color.</p>
</section>
</section>
<section id="brownian-motion" class="level2">
<h2 class="anchored" data-anchor-id="brownian-motion">Brownian Motion</h2>
<p>Brownian Motion, also known as Wiener Process, is a continuous-time stochastic process that is often used to model random movements in physics and finance.</p>
<section id="function-syntax-1" class="level3">
<h3 class="anchored" data-anchor-id="function-syntax-1">Function Syntax</h3>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_brownian_motion</span>(</span>
<span id="cb5-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.time =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb5-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_sims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.delta_time =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.initial_value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.return_tibble =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb5-7">)</span></code></pre></div>
<ul>
<li><code>.time</code>: Total time of the simulation.</li>
<li><code>.num_sims</code>: Total number of simulations.</li>
<li><code>.delta_time</code>: Time step size.</li>
<li><code>.initial_value</code>: Initial value of the simulation.</li>
<li><code>.return_tibble</code>: Return a tibble (TRUE) or a matrix (FALSE).</li>
</ul>
</section>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1">Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">brownian_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_brownian_motion</span>(</span>
<span id="cb6-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.time =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb6-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_sims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb6-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.delta_time =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb6-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.initial_value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.return_tibble =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-7">)</span>
<span id="cb6-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(brownian_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  sim_number       t     y
  &lt;fct&gt;        &lt;int&gt; &lt;dbl&gt;
1 sim_number 1     1     0
2 sim_number 2     1     0
3 sim_number 3     1     0
4 sim_number 4     1     0
5 sim_number 5     1     0
6 sim_number 6     1     0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">brownian_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_brownian_motion_plot</span>(</span>
<span id="cb8-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.data =</span> brownian_data,</span>
<span id="cb8-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.date_col =</span> t,</span>
<span id="cb8-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.value_col =</span> y,</span>
<span id="cb8-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.interactive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb8-6">)</span>
<span id="cb8-7">brownian_plot</span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-90783e5499734b017fec" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-90783e5499734b017fec">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],"y":[0,-1.9624214170529242,-0.73051815627696404,-0.94330170435097305,-0.16222708913014852,0.99745673430599546,1.9409239809615535,0.71221295433491061,1.4786397225334338,1.2562164176791044,-0.035475712206262222,1.1053603053023053,0.70975993708259588,1.5197775842341685,2.0504144236893578,3.3110742128880184,2.8140442027863908,1.6699115825594308,0.47473800573630254,1.2296220261121631,1.0470668173488287,1.2021717015750677,1.4749166216859912,0.66542496489868874,1.773305267150916,-1.0482130156806131,-0.21945267889293979,-0.94078112847439099,-0.19129563478451356,-1.2945316705849965,0.58818636201713459,1.2102402240046921,-0.0055032015802701229,-1.0862923791426708,0.37918169947704333,0.4034847466037082,0.44039184968089923,-0.090052083109810555,-0.96972280759464624,-0.75658902847997833,0.67974703962421779,1.0151065594255702,0.13538241388670047,0.91197937834347287,1.526029973964357,2.2565409036357726,1.6016477664018389,2.5116840879479012,3.1895607748769672,2.542644373502748,1.3471580388010824,2.7016552751010692,2.3309834745713811,3.6931279855307317,3.0722579882747088,1.9177421070696639,3.2735186017008235,2.8615833757597176,2.0538415350375558,1.4032654802863633,1.2921363581856797,1.0666085988207674,2.3419108081203324,2.6953087117985226,4.1276707867980846,4.7180819358947597,3.1905445986697152,2.2033481439104268,2.3692673279157508,2.5048653619906638,3.4434138697627157,3.8870240588144416,5.3356536462376898,5.6812156116646024,5.3071789085428112,4.7752876658745276,5.7789288781473216,5.7187487676472122,6.14568724775161,6.4031934307633112,6.1013681581671664,7.1227209849467696,9.6490937544601501,9.2785613810770133,8.1491769375369252,7.6183376796761131,6.3251158701972718,4.8738469742432073,5.5208485317204268,6.2958507535156985,6.6331183993600389,6.9802489642053933,5.5549635428732653,3.6909888414694603,3.2486991626131387,3.2127163120037268,2.7965534248996922,2.6804223006407741,2.2992973287096352,2.8789127286595866,4.5612975891058243],"text":["t:   1<br />y:   0.000000000<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:   2<br />y:  -1.962421417<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:   3<br />y:  -0.730518156<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:   4<br />y:  -0.943301704<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:   5<br />y:  -0.162227089<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:   6<br />y:   0.997456734<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:   7<br />y:   1.940923981<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:   8<br />y:   0.712212954<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:   9<br />y:   1.478639723<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  10<br />y:   1.256216418<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  11<br />y:  -0.035475712<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  12<br />y:   1.105360305<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  13<br />y:   0.709759937<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  14<br />y:   1.519777584<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  15<br />y:   2.050414424<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  16<br />y:   3.311074213<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  17<br />y:   2.814044203<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  18<br />y:   1.669911583<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  19<br />y:   0.474738006<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  20<br />y:   1.229622026<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  21<br />y:   1.047066817<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  22<br />y:   1.202171702<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  23<br />y:   1.474916622<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  24<br />y:   0.665424965<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  25<br />y:   1.773305267<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  26<br />y:  -1.048213016<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  27<br />y:  -0.219452679<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  28<br />y:  -0.940781128<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  29<br />y:  -0.191295635<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  30<br />y:  -1.294531671<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  31<br />y:   0.588186362<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  32<br />y:   1.210240224<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  33<br />y:  -0.005503202<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  34<br />y:  -1.086292379<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  35<br />y:   0.379181699<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  36<br />y:   0.403484747<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  37<br />y:   0.440391850<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  38<br />y:  -0.090052083<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  39<br />y:  -0.969722808<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  40<br />y:  -0.756589028<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  41<br />y:   0.679747040<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  42<br />y:   1.015106559<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  43<br />y:   0.135382414<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  44<br />y:   0.911979378<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  45<br />y:   1.526029974<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  46<br />y:   2.256540904<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  47<br />y:   1.601647766<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  48<br />y:   2.511684088<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  49<br />y:   3.189560775<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  50<br />y:   2.542644374<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  51<br />y:   1.347158039<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  52<br />y:   2.701655275<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  53<br />y:   2.330983475<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  54<br />y:   3.693127986<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  55<br />y:   3.072257988<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  56<br />y:   1.917742107<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  57<br />y:   3.273518602<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  58<br />y:   2.861583376<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  59<br />y:   2.053841535<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  60<br />y:   1.403265480<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  61<br />y:   1.292136358<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  62<br />y:   1.066608599<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  63<br />y:   2.341910808<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  64<br />y:   2.695308712<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  65<br />y:   4.127670787<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  66<br />y:   4.718081936<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  67<br />y:   3.190544599<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  68<br />y:   2.203348144<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  69<br />y:   2.369267328<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  70<br />y:   2.504865362<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  71<br />y:   3.443413870<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  72<br />y:   3.887024059<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  73<br />y:   5.335653646<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  74<br />y:   5.681215612<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  75<br />y:   5.307178909<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  76<br />y:   4.775287666<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  77<br />y:   5.778928878<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  78<br />y:   5.718748768<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  79<br />y:   6.145687248<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  80<br />y:   6.403193431<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  81<br />y:   6.101368158<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  82<br />y:   7.122720985<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  83<br />y:   9.649093754<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  84<br />y:   9.278561381<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  85<br />y:   8.149176938<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  86<br />y:   7.618337680<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  87<br />y:   6.325115870<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  88<br />y:   4.873846974<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  89<br />y:   5.520848532<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  90<br />y:   6.295850754<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  91<br />y:   6.633118399<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  92<br />y:   6.980248964<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  93<br />y:   5.554963543<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  94<br />y:   3.690988841<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  95<br />y:   3.248699163<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  96<br />y:   3.212716312<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  97<br />y:   2.796553425<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  98<br />y:   2.680422301<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  99<br />y:   2.299297329<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 100<br />y:   2.878912729<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 101<br />y:   4.561297589<br />sim_number: sim_number 1<br />sim_number: sim_number 1"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"sim_number 1","legendgroup":"sim_number 1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],"y":[0,0.73894405105159455,-1.8106752859226867,-1.5701963961362513,-2.7597267120506848,-4.6336448837347382,-3.8827295224518168,-2.8454050636128176,-1.845201252487719,-1.0461378601870204,0.9880626937883259,0.85464033393447225,0.69983951889194418,-0.37264198207659832,0.32708283838767133,0.22230457858218827,-0.51946668118377548,-0.72121427445660058,-0.95623799531240827,-1.6019276513778378,-0.55829885222678821,-1.5189736054586707,-2.9383745135695727,-1.8916227960491503,-2.5809289634133155,-0.99712751376045339,-1.8325981721424802,-1.7226730026101555,-1.6521636965550679,-1.5964624503299201,-1.6499917350710922,-3.2347582731892981,-4.2804883142534678,-4.3988577704371519,-5.1891084697669738,-5.5948120113533042,-5.1432463663581931,-4.6840473897767732,-6.7287722449635803,-5.4248758403667328,-4.0863007548658468,-5.8396115222166047,-6.1078833776411052,-6.2987918248857948,-6.8570146886567551,-7.2481422705064782,-6.5244784275606031,-5.3779379292365821,-3.942865202341125,-3.3999940831528161,-2.8191282426065163,-3.7016446952243638,-3.370510200039925,-3.958588446294502,-3.9592486107422964,-4.1812503680586222,-4.2187530017107839,-4.180206561239773,-3.3930888261128676,-3.589427133745648,-3.3607969941001237,-3.0956956238439974,-4.1807524695249283,-4.3810481685073714,-4.635536236845061,-3.9425234108608413,-5.2065839011375381,-5.011557051664421,-5.0951677489913658,-3.262069381472545,-3.3781932452277887,-3.2899139701178428,-2.557735040748764,-2.130644188656913,-3.0715626473925877,-4.1370351051877945,-3.3035332973226663,-4.6548266174557069,-5.7115093130444308,-8.0069344465226475,-7.4661099266054913,-8.4654640512809856,-8.8377541784832463,-10.336549705436815,-10.470593850037869,-11.255235679732374,-11.550524090355587,-11.839111119766841,-11.555126047767265,-11.183855530600693,-10.491888577789256,-10.528806448080022,-9.5351483703945998,-10.89600008683532,-11.889320519083981,-10.302321625325154,-10.622460662875921,-10.980366368459357,-9.7620186206820794,-9.1195102601041018,-9.3705366701399964],"text":["t:   1<br />y:   0.000000000<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:   2<br />y:   0.738944051<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:   3<br />y:  -1.810675286<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:   4<br />y:  -1.570196396<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:   5<br />y:  -2.759726712<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:   6<br />y:  -4.633644884<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:   7<br />y:  -3.882729522<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:   8<br />y:  -2.845405064<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:   9<br />y:  -1.845201252<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  10<br />y:  -1.046137860<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  11<br />y:   0.988062694<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  12<br />y:   0.854640334<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  13<br />y:   0.699839519<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  14<br />y:  -0.372641982<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  15<br />y:   0.327082838<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  16<br />y:   0.222304579<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  17<br />y:  -0.519466681<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  18<br />y:  -0.721214274<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  19<br />y:  -0.956237995<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  20<br />y:  -1.601927651<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  21<br />y:  -0.558298852<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  22<br />y:  -1.518973605<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  23<br />y:  -2.938374514<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  24<br />y:  -1.891622796<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  25<br />y:  -2.580928963<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  26<br />y:  -0.997127514<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  27<br />y:  -1.832598172<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  28<br />y:  -1.722673003<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  29<br />y:  -1.652163697<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  30<br />y:  -1.596462450<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  31<br />y:  -1.649991735<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  32<br />y:  -3.234758273<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  33<br />y:  -4.280488314<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  34<br />y:  -4.398857770<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  35<br />y:  -5.189108470<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  36<br />y:  -5.594812011<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  37<br />y:  -5.143246366<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  38<br />y:  -4.684047390<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  39<br />y:  -6.728772245<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  40<br />y:  -5.424875840<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  41<br />y:  -4.086300755<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  42<br />y:  -5.839611522<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  43<br />y:  -6.107883378<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  44<br />y:  -6.298791825<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  45<br />y:  -6.857014689<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  46<br />y:  -7.248142271<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  47<br />y:  -6.524478428<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  48<br />y:  -5.377937929<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  49<br />y:  -3.942865202<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  50<br />y:  -3.399994083<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  51<br />y:  -2.819128243<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  52<br />y:  -3.701644695<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  53<br />y:  -3.370510200<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  54<br />y:  -3.958588446<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  55<br />y:  -3.959248611<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  56<br />y:  -4.181250368<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  57<br />y:  -4.218753002<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  58<br />y:  -4.180206561<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  59<br />y:  -3.393088826<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  60<br />y:  -3.589427134<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  61<br />y:  -3.360796994<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  62<br />y:  -3.095695624<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  63<br />y:  -4.180752470<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  64<br />y:  -4.381048169<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  65<br />y:  -4.635536237<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  66<br />y:  -3.942523411<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  67<br />y:  -5.206583901<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  68<br />y:  -5.011557052<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  69<br />y:  -5.095167749<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  70<br />y:  -3.262069381<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  71<br />y:  -3.378193245<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  72<br />y:  -3.289913970<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  73<br />y:  -2.557735041<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  74<br />y:  -2.130644189<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  75<br />y:  -3.071562647<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  76<br />y:  -4.137035105<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  77<br />y:  -3.303533297<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  78<br />y:  -4.654826617<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  79<br />y:  -5.711509313<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  80<br />y:  -8.006934447<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  81<br />y:  -7.466109927<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  82<br />y:  -8.465464051<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  83<br />y:  -8.837754178<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  84<br />y: -10.336549705<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  85<br />y: -10.470593850<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  86<br />y: -11.255235680<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  87<br />y: -11.550524090<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  88<br />y: -11.839111120<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  89<br />y: -11.555126048<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  90<br />y: -11.183855531<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  91<br />y: -10.491888578<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  92<br />y: -10.528806448<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  93<br />y:  -9.535148370<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  94<br />y: -10.896000087<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  95<br />y: -11.889320519<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  96<br />y: -10.302321625<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  97<br />y: -10.622460663<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  98<br />y: -10.980366368<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  99<br />y:  -9.762018621<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 100<br />y:  -9.119510260<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 101<br />y:  -9.370536670<br />sim_number: sim_number 2<br />sim_number: sim_number 2"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"sim_number 2","legendgroup":"sim_number 2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],"y":[0,-0.21850378218756183,-0.19131807609387091,0.30115320089626152,-0.45790522050691485,0.36974320517546366,1.1952546316903765,2.2154244587406029,4.1857666452105695,3.2722239765874881,3.1062428420175618,3.0212046112821649,2.1573247737362085,2.3536881367201583,3.2928728727584975,2.2641012692308382,1.6730982355390007,1.8802865498518389,2.9734252319383123,4.2644956961315881,3.4529352744236448,2.6086750340354485,3.1312963195920411,1.2035415866068997,1.9207749798222102,2.6054799022466328,1.3146168400014258,1.8359536549522266,3.1567461645276156,2.8311561216406824,3.4976513087818741,3.1146040132868404,3.7419696639608651,3.2940416237915353,3.5434800919886049,3.2187824354654029,3.1635484899667108,2.8517066748209925,2.3792102865418907,2.3998048764627553,2.9579124614297392,3.1693124103378048,4.5355238716439699,3.9293553983388074,4.4706552986619474,4.7733558485726606,4.7027794155773783,4.031459754497825,3.586500173365601,3.3466787456620399,1.6060116298938327,0.30464013478253993,-0.10802707887941364,-0.4664772379481863,-1.6946589580519873,-0.6015337236172853,-0.23694733145077268,0.056152997604782609,-0.27352659510862759,0.0035098549964135556,-0.4514245546297721,-0.44449642882640916,-0.37349473662745913,-0.87001771120236615,-2.1086069362342754,-1.7447437342548349,0.63988785202179022,0.30002255036447573,0.61240520417832178,-0.65167421364496814,-0.76964789562270319,0.42179557842206433,-1.5823514672508279,-3.572696673506929,-3.2068822130595662,-2.8604878429413061,-3.0333153401479733,-4.1486909243178758,-3.7771268010456853,-3.7943534252602653,-4.0923847040433534,-2.9038608236032966,-3.6878718392092313,-3.3820449513041586,-3.8235297159327546,-5.1101564182736752,-4.8062409992346602,-5.1698893239357187,-6.3042867811094832,-4.6712937149187468,-4.9808897570790513,-4.8978551515594715,-3.8027191365799746,-4.2230675759249765,-3.5704900451969364,-2.5298974123250813,-2.6782148147951519,-4.1238895934717359,-6.5612327922000908,-6.0016157569768183,-6.67759368809085],"text":["t:   1<br />y:   0.000000000<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:   2<br />y:  -0.218503782<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:   3<br />y:  -0.191318076<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:   4<br />y:   0.301153201<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:   5<br />y:  -0.457905221<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:   6<br />y:   0.369743205<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:   7<br />y:   1.195254632<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:   8<br />y:   2.215424459<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:   9<br />y:   4.185766645<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  10<br />y:   3.272223977<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  11<br />y:   3.106242842<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  12<br />y:   3.021204611<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  13<br />y:   2.157324774<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  14<br />y:   2.353688137<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  15<br />y:   3.292872873<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  16<br />y:   2.264101269<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  17<br />y:   1.673098236<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  18<br />y:   1.880286550<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  19<br />y:   2.973425232<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  20<br />y:   4.264495696<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  21<br />y:   3.452935274<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  22<br />y:   2.608675034<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  23<br />y:   3.131296320<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  24<br />y:   1.203541587<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  25<br />y:   1.920774980<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  26<br />y:   2.605479902<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  27<br />y:   1.314616840<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  28<br />y:   1.835953655<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  29<br />y:   3.156746165<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  30<br />y:   2.831156122<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  31<br />y:   3.497651309<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  32<br />y:   3.114604013<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  33<br />y:   3.741969664<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  34<br />y:   3.294041624<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  35<br />y:   3.543480092<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  36<br />y:   3.218782435<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  37<br />y:   3.163548490<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  38<br />y:   2.851706675<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  39<br />y:   2.379210287<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  40<br />y:   2.399804876<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  41<br />y:   2.957912461<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  42<br />y:   3.169312410<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  43<br />y:   4.535523872<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  44<br />y:   3.929355398<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  45<br />y:   4.470655299<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  46<br />y:   4.773355849<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  47<br />y:   4.702779416<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  48<br />y:   4.031459754<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  49<br />y:   3.586500173<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  50<br />y:   3.346678746<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  51<br />y:   1.606011630<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  52<br />y:   0.304640135<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  53<br />y:  -0.108027079<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  54<br />y:  -0.466477238<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  55<br />y:  -1.694658958<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  56<br />y:  -0.601533724<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  57<br />y:  -0.236947331<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  58<br />y:   0.056152998<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  59<br />y:  -0.273526595<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  60<br />y:   0.003509855<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  61<br />y:  -0.451424555<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  62<br />y:  -0.444496429<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  63<br />y:  -0.373494737<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  64<br />y:  -0.870017711<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  65<br />y:  -2.108606936<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  66<br />y:  -1.744743734<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  67<br />y:   0.639887852<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  68<br />y:   0.300022550<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  69<br />y:   0.612405204<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  70<br />y:  -0.651674214<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  71<br />y:  -0.769647896<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  72<br />y:   0.421795578<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  73<br />y:  -1.582351467<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  74<br />y:  -3.572696674<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  75<br />y:  -3.206882213<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  76<br />y:  -2.860487843<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  77<br />y:  -3.033315340<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  78<br />y:  -4.148690924<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  79<br />y:  -3.777126801<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  80<br />y:  -3.794353425<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  81<br />y:  -4.092384704<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  82<br />y:  -2.903860824<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  83<br />y:  -3.687871839<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  84<br />y:  -3.382044951<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  85<br />y:  -3.823529716<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  86<br />y:  -5.110156418<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  87<br />y:  -4.806240999<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  88<br />y:  -5.169889324<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  89<br />y:  -6.304286781<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  90<br />y:  -4.671293715<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  91<br />y:  -4.980889757<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  92<br />y:  -4.897855152<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  93<br />y:  -3.802719137<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  94<br />y:  -4.223067576<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  95<br />y:  -3.570490045<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  96<br />y:  -2.529897412<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  97<br />y:  -2.678214815<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  98<br />y:  -4.123889593<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  99<br />y:  -6.561232792<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 100<br />y:  -6.001615757<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 101<br />y:  -6.677593688<br />sim_number: sim_number 3<br />sim_number: sim_number 3"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"sim_number 3","legendgroup":"sim_number 3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],"y":[0,1.5890863983545738,2.5399298030906157,2.5484654141022292,2.1850379771767323,2.991640960674594,3.7236117894587255,3.4348797067581955,3.2385851547547539,3.1001293615707661,3.8751394081338533,3.3836503515637633,3.1098947177699436,2.6625041364974198,1.7118811614983755,1.5433940803238089,-0.71712909833128047,-1.1450355972775872,-0.49838362301820649,-0.48694487475376458,0.16379334235662191,-1.0459301013847226,-3.188592076269924,-3.9803742444322094,-3.9199577802856687,-3.8243531195461267,-3.9115845372091096,-4.7254996109594138,-4.4678925196301007,-4.4620361825022608,-5.2405805130867167,-5.9208299321782896,-6.3891976754167281,-7.8019129289774325,-9.8011488425782201,-10.043500865829637,-11.30733294960686,-11.401571853233648,-11.125570047563011,-10.771380893830528,-10.580308770375593,-9.8365241894881645,-10.351959916923933,-11.357126673677477,-10.909995172176451,-9.514783374720448,-7.0430016042347914,-7.683858481947337,-6.6346297496539419,-7.0460212576965704,-7.8479894188482344,-6.4796478695330757,-3.8641499243392858,-3.1910412368332333,-4.633416777935687,-6.0945674166746153,-6.229031308447432,-7.1295697141476317,-7.0913501389788927,-5.8270040833246304,-5.9734379407838611,-6.9086727446165908,-8.555955024840026,-8.3366120318081016,-7.7876908753266827,-8.5584412872620046,-8.9637321844100786,-8.8330919208056535,-8.5438868662786511,-8.7407731456711684,-9.5139365511776095,-10.341146364674747,-10.23728334245085,-11.177770632416255,-10.45052172274641,-8.5722041430242832,-9.1525973832151717,-8.9271789633927945,-8.0914613697076874,-8.3026991957341156,-8.9153452650217702,-9.7159653458458024,-11.357695025571571,-11.869617510782589,-9.5350900152839024,-11.341930872173746,-10.796644649225531,-11.736534422552404,-12.007877170207344,-12.76376095426318,-12.836353688696875,-14.349245683179458,-13.633570352654717,-11.658931272737744,-10.458057924355501,-10.959967389910711,-11.888806887796827,-12.151803335458872,-13.361144362191798,-13.213392394179856,-14.046914815270203],"text":["t:   1<br />y:   0.000000000<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:   2<br />y:   1.589086398<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:   3<br />y:   2.539929803<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:   4<br />y:   2.548465414<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:   5<br />y:   2.185037977<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:   6<br />y:   2.991640961<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:   7<br />y:   3.723611789<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:   8<br />y:   3.434879707<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:   9<br />y:   3.238585155<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  10<br />y:   3.100129362<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  11<br />y:   3.875139408<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  12<br />y:   3.383650352<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  13<br />y:   3.109894718<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  14<br />y:   2.662504136<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  15<br />y:   1.711881161<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  16<br />y:   1.543394080<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  17<br />y:  -0.717129098<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  18<br />y:  -1.145035597<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  19<br />y:  -0.498383623<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  20<br />y:  -0.486944875<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  21<br />y:   0.163793342<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  22<br />y:  -1.045930101<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  23<br />y:  -3.188592076<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  24<br />y:  -3.980374244<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  25<br />y:  -3.919957780<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  26<br />y:  -3.824353120<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  27<br />y:  -3.911584537<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  28<br />y:  -4.725499611<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  29<br />y:  -4.467892520<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  30<br />y:  -4.462036183<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  31<br />y:  -5.240580513<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  32<br />y:  -5.920829932<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  33<br />y:  -6.389197675<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  34<br />y:  -7.801912929<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  35<br />y:  -9.801148843<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  36<br />y: -10.043500866<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  37<br />y: -11.307332950<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  38<br />y: -11.401571853<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  39<br />y: -11.125570048<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  40<br />y: -10.771380894<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  41<br />y: -10.580308770<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  42<br />y:  -9.836524189<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  43<br />y: -10.351959917<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  44<br />y: -11.357126674<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  45<br />y: -10.909995172<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  46<br />y:  -9.514783375<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  47<br />y:  -7.043001604<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  48<br />y:  -7.683858482<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  49<br />y:  -6.634629750<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  50<br />y:  -7.046021258<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  51<br />y:  -7.847989419<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  52<br />y:  -6.479647870<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  53<br />y:  -3.864149924<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  54<br />y:  -3.191041237<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  55<br />y:  -4.633416778<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  56<br />y:  -6.094567417<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  57<br />y:  -6.229031308<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  58<br />y:  -7.129569714<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  59<br />y:  -7.091350139<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  60<br />y:  -5.827004083<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  61<br />y:  -5.973437941<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  62<br />y:  -6.908672745<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  63<br />y:  -8.555955025<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  64<br />y:  -8.336612032<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  65<br />y:  -7.787690875<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  66<br />y:  -8.558441287<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  67<br />y:  -8.963732184<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  68<br />y:  -8.833091921<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  69<br />y:  -8.543886866<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  70<br />y:  -8.740773146<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  71<br />y:  -9.513936551<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  72<br />y: -10.341146365<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  73<br />y: -10.237283342<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  74<br />y: -11.177770632<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  75<br />y: -10.450521723<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  76<br />y:  -8.572204143<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  77<br />y:  -9.152597383<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  78<br />y:  -8.927178963<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  79<br />y:  -8.091461370<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  80<br />y:  -8.302699196<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  81<br />y:  -8.915345265<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  82<br />y:  -9.715965346<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  83<br />y: -11.357695026<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  84<br />y: -11.869617511<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  85<br />y:  -9.535090015<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  86<br />y: -11.341930872<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  87<br />y: -10.796644649<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  88<br />y: -11.736534423<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  89<br />y: -12.007877170<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  90<br />y: -12.763760954<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  91<br />y: -12.836353689<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  92<br />y: -14.349245683<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  93<br />y: -13.633570353<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  94<br />y: -11.658931273<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  95<br />y: -10.458057924<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  96<br />y: -10.959967390<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  97<br />y: -11.888806888<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  98<br />y: -12.151803335<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  99<br />y: -13.361144362<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 100<br />y: -13.213392394<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 101<br />y: -14.046914815<br />sim_number: sim_number 4<br />sim_number: sim_number 4"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"sim_number 4","legendgroup":"sim_number 4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],"y":[0,1.4458437853730648,2.0902689344761285,2.2179933042577971,2.9080073814556986,1.8578989755108268,2.1042607022134292,-0.33743666642655262,0.81409738537207121,-0.785005383821896,-1.9929906910855106,-1.5404634651652604,-2.3194123443612495,-2.2619188020135415,-1.8030765172131411,-1.984364510771953,-2.3689188744860901,-2.0449737308934757,-2.481450936240535,-1.7330577847337201,-2.1095054378599398,-2.3649620416809669,-1.8103803945914372,-1.5830651948716279,-2.5765892879285777,-3.4133027184751774,-2.5495547082420611,-2.2944208120904812,-3.419186077388118,-4.6377278554715371,-3.3346441647647183,-3.806014572884711,-2.8981972467649566,-2.5661429106059477,-1.5396287959852424,-2.9252169228387279,-0.57155673814465358,-0.53086615117071323,-0.1974597351361882,1.1237746470893981,1.4917811031194532,0.8142308779352504,2.3820639049031516,1.7715437994530072,2.7590515525837938,5.0212161378077012,6.5921866797494708,6.3909322825850987,8.1865723303561673,9.1677639992055617,8.4250992230635866,8.5832597650129294,9.7239160301228136,7.4788379998081105,6.7239851273748554,7.4298457399869706,9.0375792644489774,10.328334315104218,10.40221165665848,11.064231615636494,11.911392898607135,11.558776450731388,11.066872343212525,12.589010059096987,10.212698545351387,11.432295984623549,11.195503512914666,12.807062929168698,9.9447937290645054,10.145668903343955,10.646015017565716,13.678021718943977,14.866544758264677,14.76741515643914,14.972834360936821,15.108710312956058,15.43004765561099,14.538916201435537,13.280623268153304,12.542612339657165,12.176837137645784,12.240169808242666,11.146058448037721,10.661136171005797,11.343318873854097,10.35771712673416,9.6242959723469585,10.520661965687694,10.066939918141552,10.340082536300057,10.980804457428173,11.690626043898009,10.541886644506008,10.614860736332064,10.026241949091009,10.053791044763008,9.3957654468961724,8.4239851239160917,7.6846823564765856,7.5546789464396022,8.3898549749194],"text":["t:   1<br />y:   0.000000000<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:   2<br />y:   1.445843785<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:   3<br />y:   2.090268934<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:   4<br />y:   2.217993304<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:   5<br />y:   2.908007381<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:   6<br />y:   1.857898976<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:   7<br />y:   2.104260702<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:   8<br />y:  -0.337436666<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:   9<br />y:   0.814097385<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  10<br />y:  -0.785005384<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  11<br />y:  -1.992990691<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  12<br />y:  -1.540463465<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  13<br />y:  -2.319412344<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  14<br />y:  -2.261918802<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  15<br />y:  -1.803076517<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  16<br />y:  -1.984364511<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  17<br />y:  -2.368918874<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  18<br />y:  -2.044973731<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  19<br />y:  -2.481450936<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  20<br />y:  -1.733057785<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  21<br />y:  -2.109505438<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  22<br />y:  -2.364962042<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  23<br />y:  -1.810380395<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  24<br />y:  -1.583065195<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  25<br />y:  -2.576589288<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  26<br />y:  -3.413302718<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  27<br />y:  -2.549554708<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  28<br />y:  -2.294420812<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  29<br />y:  -3.419186077<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  30<br />y:  -4.637727855<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  31<br />y:  -3.334644165<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  32<br />y:  -3.806014573<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  33<br />y:  -2.898197247<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  34<br />y:  -2.566142911<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  35<br />y:  -1.539628796<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  36<br />y:  -2.925216923<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  37<br />y:  -0.571556738<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  38<br />y:  -0.530866151<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  39<br />y:  -0.197459735<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  40<br />y:   1.123774647<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  41<br />y:   1.491781103<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  42<br />y:   0.814230878<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  43<br />y:   2.382063905<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  44<br />y:   1.771543799<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  45<br />y:   2.759051553<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  46<br />y:   5.021216138<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  47<br />y:   6.592186680<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  48<br />y:   6.390932283<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  49<br />y:   8.186572330<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  50<br />y:   9.167763999<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  51<br />y:   8.425099223<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  52<br />y:   8.583259765<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  53<br />y:   9.723916030<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  54<br />y:   7.478838000<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  55<br />y:   6.723985127<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  56<br />y:   7.429845740<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  57<br />y:   9.037579264<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  58<br />y:  10.328334315<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  59<br />y:  10.402211657<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  60<br />y:  11.064231616<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  61<br />y:  11.911392899<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  62<br />y:  11.558776451<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  63<br />y:  11.066872343<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  64<br />y:  12.589010059<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  65<br />y:  10.212698545<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  66<br />y:  11.432295985<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  67<br />y:  11.195503513<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  68<br />y:  12.807062929<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  69<br />y:   9.944793729<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  70<br />y:  10.145668903<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  71<br />y:  10.646015018<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  72<br />y:  13.678021719<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  73<br />y:  14.866544758<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  74<br />y:  14.767415156<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  75<br />y:  14.972834361<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  76<br />y:  15.108710313<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  77<br />y:  15.430047656<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  78<br />y:  14.538916201<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  79<br />y:  13.280623268<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  80<br />y:  12.542612340<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  81<br />y:  12.176837138<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  82<br />y:  12.240169808<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  83<br />y:  11.146058448<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  84<br />y:  10.661136171<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  85<br />y:  11.343318874<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  86<br />y:  10.357717127<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  87<br />y:   9.624295972<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  88<br />y:  10.520661966<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  89<br />y:  10.066939918<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  90<br />y:  10.340082536<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  91<br />y:  10.980804457<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  92<br />y:  11.690626044<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  93<br />y:  10.541886645<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  94<br />y:  10.614860736<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  95<br />y:  10.026241949<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  96<br />y:  10.053791045<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  97<br />y:   9.395765447<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  98<br />y:   8.423985124<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  99<br />y:   7.684682356<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 100<br />y:   7.554678946<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 101<br />y:   8.389854975<br />sim_number: sim_number 5<br />sim_number: sim_number 5"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"sim_number 5","legendgroup":"sim_number 5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],"y":[0,-0.85946702758767812,-0.77405768882782511,-0.94820558001623423,-0.0085248868849960163,-0.31562405784189401,-1.3265829547567707,-2.5200747945755397,-1.5357836669061631,-1.191325123410423,-0.76418913784495834,-0.80717372912619467,-0.83282192446745928,0.028981849203606268,-0.59976521427844376,-1.0298828936473072,-0.00670912843545899,-1.5445794096526089,-1.0671139386659358,0.034664479593431628,-0.061299872877629578,-0.13458338754137386,0.8077472698913738,1.0766983680905413,0.78616225393765171,2.0538922538334372,1.4002056090655848,0.38997168366117879,0.35784060774639465,-0.47670428125217684,-0.46666389749274112,0.12216143451358627,-0.11865543765007475,0.24158938200854346,0.85300489723873918,1.8125843153514507,0.64115027194771324,1.6869759294792703,-0.077368507140314124,-0.025508447335086032,0.094905895687308367,-1.2594973956184188,0.87661812879494438,0.068652600985527751,0.81260826497491079,1.5098674788411965,1.5875764865691468,4.4636048220098195,3.7554321775335469,4.7011023531475686,4.3021644216171078,4.4002924785154613,2.361058575901656,4.0416711337199445,2.1291905840792493,3.0185588326410611,2.8844917252891866,2.1186407797166611,3.3370913419942418,2.4730469340667351,2.1568049401631697,2.3715060820491756,4.8030009544863166,5.7002216322287911,6.7675360950730878,8.334246586708149,9.5550327116890177,7.594188390084871,7.1552320925964636,9.1526845007427706,8.2057273433202287,8.8707950718153938,8.5197061936965213,8.8101919803586295,8.0847647180771354,6.4033326767272314,6.4753230662680004,5.163925705842896,5.5256649117063166,5.2913945912306408,4.340901208531438,3.1310770225799498,4.7082609143678207,3.6977217531223117,4.4067968993892919,2.1980113606147316,0.9921946019670842,1.5018383233619714,0.59827152470757772,0.23802186427535021,0.79348194042731679,0.85126417930469755,-0.3791264893958266,0.18739073523559269,0.12884073093248372,-0.88217740198667727,-0.56744669593277353,0.0087533288637070463,1.3820120205727606,1.2600608875632993,2.0510799906874397],"text":["t:   1<br />y:   0.000000000<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:   2<br />y:  -0.859467028<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:   3<br />y:  -0.774057689<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:   4<br />y:  -0.948205580<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:   5<br />y:  -0.008524887<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:   6<br />y:  -0.315624058<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:   7<br />y:  -1.326582955<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:   8<br />y:  -2.520074795<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:   9<br />y:  -1.535783667<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  10<br />y:  -1.191325123<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  11<br />y:  -0.764189138<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  12<br />y:  -0.807173729<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  13<br />y:  -0.832821924<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  14<br />y:   0.028981849<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  15<br />y:  -0.599765214<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  16<br />y:  -1.029882894<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  17<br />y:  -0.006709128<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  18<br />y:  -1.544579410<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  19<br />y:  -1.067113939<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  20<br />y:   0.034664480<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  21<br />y:  -0.061299873<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  22<br />y:  -0.134583388<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  23<br />y:   0.807747270<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  24<br />y:   1.076698368<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  25<br />y:   0.786162254<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  26<br />y:   2.053892254<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  27<br />y:   1.400205609<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  28<br />y:   0.389971684<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  29<br />y:   0.357840608<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  30<br />y:  -0.476704281<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  31<br />y:  -0.466663897<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  32<br />y:   0.122161435<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  33<br />y:  -0.118655438<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  34<br />y:   0.241589382<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  35<br />y:   0.853004897<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  36<br />y:   1.812584315<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  37<br />y:   0.641150272<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  38<br />y:   1.686975929<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  39<br />y:  -0.077368507<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  40<br />y:  -0.025508447<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  41<br />y:   0.094905896<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  42<br />y:  -1.259497396<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  43<br />y:   0.876618129<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  44<br />y:   0.068652601<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  45<br />y:   0.812608265<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  46<br />y:   1.509867479<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  47<br />y:   1.587576487<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  48<br />y:   4.463604822<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  49<br />y:   3.755432178<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  50<br />y:   4.701102353<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  51<br />y:   4.302164422<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  52<br />y:   4.400292479<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  53<br />y:   2.361058576<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  54<br />y:   4.041671134<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  55<br />y:   2.129190584<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  56<br />y:   3.018558833<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  57<br />y:   2.884491725<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  58<br />y:   2.118640780<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  59<br />y:   3.337091342<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  60<br />y:   2.473046934<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  61<br />y:   2.156804940<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  62<br />y:   2.371506082<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  63<br />y:   4.803000954<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  64<br />y:   5.700221632<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  65<br />y:   6.767536095<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  66<br />y:   8.334246587<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  67<br />y:   9.555032712<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  68<br />y:   7.594188390<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  69<br />y:   7.155232093<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  70<br />y:   9.152684501<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  71<br />y:   8.205727343<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  72<br />y:   8.870795072<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  73<br />y:   8.519706194<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  74<br />y:   8.810191980<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  75<br />y:   8.084764718<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  76<br />y:   6.403332677<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  77<br />y:   6.475323066<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  78<br />y:   5.163925706<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  79<br />y:   5.525664912<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  80<br />y:   5.291394591<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  81<br />y:   4.340901209<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  82<br />y:   3.131077023<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  83<br />y:   4.708260914<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  84<br />y:   3.697721753<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  85<br />y:   4.406796899<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  86<br />y:   2.198011361<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  87<br />y:   0.992194602<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  88<br />y:   1.501838323<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  89<br />y:   0.598271525<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  90<br />y:   0.238021864<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  91<br />y:   0.793481940<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  92<br />y:   0.851264179<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  93<br />y:  -0.379126489<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  94<br />y:   0.187390735<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  95<br />y:   0.128840731<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  96<br />y:  -0.882177402<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  97<br />y:  -0.567446696<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  98<br />y:   0.008753329<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  99<br />y:   1.382012021<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 100<br />y:   1.260060888<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 101<br />y:   2.051079991<br />sim_number: sim_number 6<br />sim_number: sim_number 6"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"sim_number 6","legendgroup":"sim_number 6","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],"y":[0,1.6998430575974921,-0.21082306072430024,-2.802715233778581,-3.1336040605527744,-4.936956212999422,-5.6895997208259743,-6.8899041499983307,-8.1937729944371238,-7.317263464587537,-6.3798227620934345,-4.6992798499468895,-4.4178234459757544,-3.5030273258167268,-3.4987576303258283,-3.2335225016975353,-2.4678765315791593,-2.3477854163821132,-3.2999038294525147,-4.2701773377110896,-4.0596187477259091,-3.4160519525423543,-2.0487332338238984,-2.1604132489136401,-1.0145672686184406,-1.7794355160984703,-3.3314747388815902,-2.2655676681616832,-4.0785367203109191,-3.3919012981645551,-4.1835101503280452,-3.9760182702670952,-4.7540215691304528,-4.2408890561085588,-3.7666380836390863,-5.7019455065565241,-7.5291003728973207,-8.6410073994391325,-9.210467231244543,-9.4006193109252649,-9.5891597023011208,-10.780753890580909,-9.6357953662966018,-9.0721371247955247,-8.8796582980252232,-9.3231188402701566,-11.352917239640714,-10.239760434419885,-10.420418515560463,-8.579244608729466,-7.9676699056036,-8.9862476214267062,-9.5097897745715407,-10.746417711720632,-12.808971115316075,-11.277186398473784,-12.309785628077641,-12.460361403084786,-12.669795087660169,-13.206391395354919,-13.724648173405718,-15.498148219964612,-15.2147512676235,-15.09943301193147,-16.615091365761202,-17.239761846179693,-17.451618707052365,-17.415134638256614,-16.567152200342122,-17.287147062244003,-15.02986194221452,-15.473958915784946,-15.239982214975832,-15.296840809903935,-14.95512787831116,-13.319658080571394,-13.246049023685446,-13.606780091252752,-12.787964714194146,-14.01713622700348,-14.876887733360052,-15.782447139173181,-15.029996160825032,-15.082852989204904,-15.378553166785593,-15.982692178063216,-16.355902631527165,-16.995616634472292,-17.223515553892081,-18.069435243993386,-17.938834649985214,-17.539583218752711,-17.791742905486267,-18.739765140499433,-17.950936363834412,-18.783682179940158,-17.690582590599426,-16.177192416784308,-17.165160916222273,-18.56792750872507,-16.812187911257016],"text":["t:   1<br />y:   0.000000000<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:   2<br />y:   1.699843058<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:   3<br />y:  -0.210823061<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:   4<br />y:  -2.802715234<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:   5<br />y:  -3.133604061<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:   6<br />y:  -4.936956213<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:   7<br />y:  -5.689599721<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:   8<br />y:  -6.889904150<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:   9<br />y:  -8.193772994<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  10<br />y:  -7.317263465<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  11<br />y:  -6.379822762<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  12<br />y:  -4.699279850<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  13<br />y:  -4.417823446<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  14<br />y:  -3.503027326<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  15<br />y:  -3.498757630<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  16<br />y:  -3.233522502<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  17<br />y:  -2.467876532<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  18<br />y:  -2.347785416<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  19<br />y:  -3.299903829<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  20<br />y:  -4.270177338<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  21<br />y:  -4.059618748<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  22<br />y:  -3.416051953<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  23<br />y:  -2.048733234<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  24<br />y:  -2.160413249<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  25<br />y:  -1.014567269<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  26<br />y:  -1.779435516<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  27<br />y:  -3.331474739<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  28<br />y:  -2.265567668<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  29<br />y:  -4.078536720<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  30<br />y:  -3.391901298<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  31<br />y:  -4.183510150<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  32<br />y:  -3.976018270<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  33<br />y:  -4.754021569<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  34<br />y:  -4.240889056<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  35<br />y:  -3.766638084<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  36<br />y:  -5.701945507<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  37<br />y:  -7.529100373<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  38<br />y:  -8.641007399<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  39<br />y:  -9.210467231<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  40<br />y:  -9.400619311<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  41<br />y:  -9.589159702<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  42<br />y: -10.780753891<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  43<br />y:  -9.635795366<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  44<br />y:  -9.072137125<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  45<br />y:  -8.879658298<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  46<br />y:  -9.323118840<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  47<br />y: -11.352917240<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  48<br />y: -10.239760434<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  49<br />y: -10.420418516<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  50<br />y:  -8.579244609<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  51<br />y:  -7.967669906<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  52<br />y:  -8.986247621<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  53<br />y:  -9.509789775<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  54<br />y: -10.746417712<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  55<br />y: -12.808971115<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  56<br />y: -11.277186398<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  57<br />y: -12.309785628<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  58<br />y: -12.460361403<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  59<br />y: -12.669795088<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  60<br />y: -13.206391395<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  61<br />y: -13.724648173<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  62<br />y: -15.498148220<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  63<br />y: -15.214751268<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  64<br />y: -15.099433012<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  65<br />y: -16.615091366<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  66<br />y: -17.239761846<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  67<br />y: -17.451618707<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  68<br />y: -17.415134638<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  69<br />y: -16.567152200<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  70<br />y: -17.287147062<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  71<br />y: -15.029861942<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  72<br />y: -15.473958916<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  73<br />y: -15.239982215<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  74<br />y: -15.296840810<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  75<br />y: -14.955127878<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  76<br />y: -13.319658081<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  77<br />y: -13.246049024<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  78<br />y: -13.606780091<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  79<br />y: -12.787964714<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  80<br />y: -14.017136227<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  81<br />y: -14.876887733<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  82<br />y: -15.782447139<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  83<br />y: -15.029996161<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  84<br />y: -15.082852989<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  85<br />y: -15.378553167<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  86<br />y: -15.982692178<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  87<br />y: -16.355902632<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  88<br />y: -16.995616634<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  89<br />y: -17.223515554<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  90<br />y: -18.069435244<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  91<br />y: -17.938834650<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  92<br />y: -17.539583219<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  93<br />y: -17.791742905<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  94<br />y: -18.739765140<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  95<br />y: -17.950936364<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  96<br />y: -18.783682180<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  97<br />y: -17.690582591<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  98<br />y: -16.177192417<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  99<br />y: -17.165160916<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 100<br />y: -18.567927509<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 101<br />y: -16.812187911<br />sim_number: sim_number 7<br />sim_number: sim_number 7"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"sim_number 7","legendgroup":"sim_number 7","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],"y":[0,0.21724390925242765,0.93445416786636226,1.1000444654791905,0.8517387076764309,1.0566297552562052,0.53404045920894716,1.4033547468079575,1.6302497460861265,-0.73775387476299958,-0.50580254880875575,-1.1947092488593223,-2.5010159896737276,-2.8301511670239154,-2.5697594586327432,-1.9225257982330992,-1.2942375826638306,-0.21542508104599986,-0.8785128736514487,0.72137519008269679,-0.47328126433371764,-2.3227445616070348,-1.5081910106434202,-2.0308454058727108,-1.065092696250616,0.013982939605361816,0.82994587868274172,0.16361063588992023,2.6452774400708905,1.9200195912560154,1.8106060264405683,1.5013919279627064,1.4993854638266688,2.8926127785572868,2.6639579909521873,2.8057371167454663,1.7091603916603788,0.73309126152001014,0.029561963879996753,1.3769807331685149,1.4964482954546694,2.3808273993984295,1.2655106922644579,-0.55441075597738709,0.49248276782010192,-0.89847292416552349,-1.0217937933149688,-1.1613482672225273,-0.48021308289435527,-0.94672154155429045,-0.44889650896544026,-0.34923196439664284,1.4498455573382829,0.77582882160822075,1.0588919228280538,0.88476379247371562,2.3837181080081167,2.1084147673484432,1.3997222689656799,2.1862899222416239,1.9581704294483828,2.9555232096451127,3.0694262943241859,4.362589874590209,2.9060946349757022,2.9778243576440127,2.5203974814884234,3.511999468842212,2.4402529685640544,0.8595012538607204,0.59355938950081744,-0.49512390028672099,-0.81657487939435069,-0.17374673027071907,0.46133261346510956,-0.22313129799472931,-0.48914574574709141,0.21811640003774618,0.63047080348054541,0.36033608097938746,0.60396669946757553,0.48780405595891524,1.8454086094258386,1.1149337638060806,2.4603364681946336,2.1691812619494404,2.4747700699834043,3.2371409097700803,2.7637776886781404,1.8636875516942937,2.3051774531801357,3.1196761633062864,0.6998274691649381,1.7836166845250778,0.24401752747638789,-1.4877687535274045,-0.40226007626553167,-1.5635165312801216,-0.86326989512120078,-2.0984647258430122,-2.3126733576076521],"text":["t:   1<br />y:   0.000000000<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:   2<br />y:   0.217243909<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:   3<br />y:   0.934454168<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:   4<br />y:   1.100044465<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:   5<br />y:   0.851738708<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:   6<br />y:   1.056629755<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:   7<br />y:   0.534040459<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:   8<br />y:   1.403354747<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:   9<br />y:   1.630249746<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  10<br />y:  -0.737753875<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  11<br />y:  -0.505802549<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  12<br />y:  -1.194709249<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  13<br />y:  -2.501015990<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  14<br />y:  -2.830151167<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  15<br />y:  -2.569759459<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  16<br />y:  -1.922525798<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  17<br />y:  -1.294237583<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  18<br />y:  -0.215425081<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  19<br />y:  -0.878512874<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  20<br />y:   0.721375190<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  21<br />y:  -0.473281264<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  22<br />y:  -2.322744562<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  23<br />y:  -1.508191011<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  24<br />y:  -2.030845406<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  25<br />y:  -1.065092696<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  26<br />y:   0.013982940<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  27<br />y:   0.829945879<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  28<br />y:   0.163610636<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  29<br />y:   2.645277440<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  30<br />y:   1.920019591<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  31<br />y:   1.810606026<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  32<br />y:   1.501391928<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  33<br />y:   1.499385464<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  34<br />y:   2.892612779<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  35<br />y:   2.663957991<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  36<br />y:   2.805737117<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  37<br />y:   1.709160392<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  38<br />y:   0.733091262<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  39<br />y:   0.029561964<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  40<br />y:   1.376980733<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  41<br />y:   1.496448295<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  42<br />y:   2.380827399<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  43<br />y:   1.265510692<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  44<br />y:  -0.554410756<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  45<br />y:   0.492482768<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  46<br />y:  -0.898472924<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  47<br />y:  -1.021793793<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  48<br />y:  -1.161348267<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  49<br />y:  -0.480213083<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  50<br />y:  -0.946721542<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  51<br />y:  -0.448896509<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  52<br />y:  -0.349231964<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  53<br />y:   1.449845557<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  54<br />y:   0.775828822<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  55<br />y:   1.058891923<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  56<br />y:   0.884763792<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  57<br />y:   2.383718108<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  58<br />y:   2.108414767<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  59<br />y:   1.399722269<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  60<br />y:   2.186289922<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  61<br />y:   1.958170429<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  62<br />y:   2.955523210<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  63<br />y:   3.069426294<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  64<br />y:   4.362589875<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  65<br />y:   2.906094635<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  66<br />y:   2.977824358<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  67<br />y:   2.520397481<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  68<br />y:   3.511999469<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  69<br />y:   2.440252969<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  70<br />y:   0.859501254<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  71<br />y:   0.593559390<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  72<br />y:  -0.495123900<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  73<br />y:  -0.816574879<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  74<br />y:  -0.173746730<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  75<br />y:   0.461332613<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  76<br />y:  -0.223131298<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  77<br />y:  -0.489145746<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  78<br />y:   0.218116400<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  79<br />y:   0.630470803<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  80<br />y:   0.360336081<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  81<br />y:   0.603966699<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  82<br />y:   0.487804056<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  83<br />y:   1.845408609<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  84<br />y:   1.114933764<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  85<br />y:   2.460336468<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  86<br />y:   2.169181262<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  87<br />y:   2.474770070<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  88<br />y:   3.237140910<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  89<br />y:   2.763777689<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  90<br />y:   1.863687552<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  91<br />y:   2.305177453<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  92<br />y:   3.119676163<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  93<br />y:   0.699827469<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  94<br />y:   1.783616685<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  95<br />y:   0.244017527<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  96<br />y:  -1.487768754<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  97<br />y:  -0.402260076<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  98<br />y:  -1.563516531<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  99<br />y:  -0.863269895<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 100<br />y:  -2.098464726<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 101<br />y:  -2.312673358<br />sim_number: sim_number 8<br />sim_number: sim_number 8"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"sim_number 8","legendgroup":"sim_number 8","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],"y":[0,0.78631162683777134,0.12409826569792648,-0.46645373976103188,-1.9382933067197974,-0.8348712186387196,-0.8993467214130757,-1.0158595786445122,-1.6785826428465509,-2.5057414540403729,-2.6032478005895228,-3.6625074090781764,-3.4078064821555056,-2.8731781367246425,-3.3594498201303011,-3.8773799682392709,-2.3871247807116709,-3.7851046806419966,-4.4682489133077725,-3.1701935918909552,-2.0226975181683624,-3.0125117342319654,-1.6543099932538485,-3.8522418734087238,-4.8131929382352343,-4.1521652482928086,-5.3624138483399406,-5.8757841393807055,-8.4411334168161716,-8.0516582145358235,-7.874836523319706,-7.2673263173070035,-6.464158489612279,-6.2745659752082696,-7.2735585403794873,-6.1025398384829055,-4.9292059913273949,-4.3359146121348742,-6.0123714850598491,-6.6354340998157797,-7.9790529073855589,-6.8817195196570315,-5.0829381653222869,-6.1995348265286481,-4.939080999878823,-5.2176684413579313,-4.8777138112628711,-4.8267195292397487,-4.7625811868152592,-6.5715642707771664,-4.5853548934844959,-4.0921530877026973,-4.4797357362403698,-5.0725328180206564,-6.2263309035856427,-5.3118066124401695,-4.9508883483485553,-5.6683459493425596,-3.5551183589859385,-3.0063125813065161,-2.0912160770552597,-2.0955097062058763,-1.4335554231409555,-1.9326146813768701,-0.24849389093463514,-0.55478376237233717,-2.0244737164369706,-3.3856338177976451,-3.3209888644431955,-4.4878208926818592,-4.823502979918497,-4.4152359708799667,-5.1359096171730849,-5.4979381210929859,-5.0164515292018201,-5.1980248196221854,-4.2537834704650628,-3.1313887112573973,-3.5354497912226197,-2.588507909661161,-2.1100919750952092,-2.7780297401035048,-3.6662849530517412,-6.2160905385462577,-5.7769420584336162,-7.1431555978232986,-8.4334899542220434,-8.1152028688116165,-7.5552892830261547,-6.4806383375396219,-5.6771988158516402,-4.4631331468936439,-4.9528462634301853,-4.3318374748568527,-4.8986267913616297,-6.5260113957988741,-7.8726835122637215,-7.0887707361241734,-5.2888738512668692,-4.8821407985085967,-4.8151167743373007],"text":["t:   1<br />y:   0.000000000<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:   2<br />y:   0.786311627<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:   3<br />y:   0.124098266<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:   4<br />y:  -0.466453740<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:   5<br />y:  -1.938293307<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:   6<br />y:  -0.834871219<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:   7<br />y:  -0.899346721<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:   8<br />y:  -1.015859579<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:   9<br />y:  -1.678582643<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  10<br />y:  -2.505741454<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  11<br />y:  -2.603247801<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  12<br />y:  -3.662507409<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  13<br />y:  -3.407806482<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  14<br />y:  -2.873178137<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  15<br />y:  -3.359449820<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  16<br />y:  -3.877379968<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  17<br />y:  -2.387124781<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  18<br />y:  -3.785104681<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  19<br />y:  -4.468248913<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  20<br />y:  -3.170193592<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  21<br />y:  -2.022697518<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  22<br />y:  -3.012511734<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  23<br />y:  -1.654309993<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  24<br />y:  -3.852241873<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  25<br />y:  -4.813192938<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  26<br />y:  -4.152165248<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  27<br />y:  -5.362413848<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  28<br />y:  -5.875784139<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  29<br />y:  -8.441133417<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  30<br />y:  -8.051658215<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  31<br />y:  -7.874836523<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  32<br />y:  -7.267326317<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  33<br />y:  -6.464158490<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  34<br />y:  -6.274565975<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  35<br />y:  -7.273558540<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  36<br />y:  -6.102539838<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  37<br />y:  -4.929205991<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  38<br />y:  -4.335914612<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  39<br />y:  -6.012371485<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  40<br />y:  -6.635434100<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  41<br />y:  -7.979052907<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  42<br />y:  -6.881719520<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  43<br />y:  -5.082938165<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  44<br />y:  -6.199534827<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  45<br />y:  -4.939081000<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  46<br />y:  -5.217668441<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  47<br />y:  -4.877713811<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  48<br />y:  -4.826719529<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  49<br />y:  -4.762581187<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  50<br />y:  -6.571564271<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  51<br />y:  -4.585354893<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  52<br />y:  -4.092153088<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  53<br />y:  -4.479735736<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  54<br />y:  -5.072532818<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  55<br />y:  -6.226330904<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  56<br />y:  -5.311806612<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  57<br />y:  -4.950888348<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  58<br />y:  -5.668345949<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  59<br />y:  -3.555118359<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  60<br />y:  -3.006312581<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  61<br />y:  -2.091216077<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  62<br />y:  -2.095509706<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  63<br />y:  -1.433555423<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  64<br />y:  -1.932614681<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  65<br />y:  -0.248493891<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  66<br />y:  -0.554783762<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  67<br />y:  -2.024473716<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  68<br />y:  -3.385633818<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  69<br />y:  -3.320988864<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  70<br />y:  -4.487820893<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  71<br />y:  -4.823502980<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  72<br />y:  -4.415235971<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  73<br />y:  -5.135909617<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  74<br />y:  -5.497938121<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  75<br />y:  -5.016451529<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  76<br />y:  -5.198024820<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  77<br />y:  -4.253783470<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  78<br />y:  -3.131388711<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  79<br />y:  -3.535449791<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  80<br />y:  -2.588507910<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  81<br />y:  -2.110091975<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  82<br />y:  -2.778029740<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  83<br />y:  -3.666284953<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  84<br />y:  -6.216090539<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  85<br />y:  -5.776942058<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  86<br />y:  -7.143155598<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  87<br />y:  -8.433489954<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  88<br />y:  -8.115202869<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  89<br />y:  -7.555289283<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  90<br />y:  -6.480638338<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  91<br />y:  -5.677198816<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  92<br />y:  -4.463133147<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  93<br />y:  -4.952846263<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  94<br />y:  -4.331837475<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  95<br />y:  -4.898626791<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  96<br />y:  -6.526011396<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  97<br />y:  -7.872683512<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  98<br />y:  -7.088770736<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  99<br />y:  -5.288873851<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 100<br />y:  -4.882140799<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 101<br />y:  -4.815116774<br />sim_number: sim_number 9<br />sim_number: sim_number 9"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"sim_number 9","legendgroup":"sim_number 9","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],"y":[0,0.31814793965239285,1.3041400580936617,1.5233498232987897,2.5586496384124122,2.1865801082906562,3.403182342144643,2.877623656049638,3.4372673741815976,1.8041538093180221,2.7804434040913115,4.0645500450393186,5.6397783405452806,5.9085667311745675,6.3909554558146198,6.2938026454236731,5.684171049902389,7.0582388144943726,7.2311331983997729,6.5983629868219289,7.6424041663655258,9.2703358828132387,7.2766400521714161,5.8638403532321073,5.1979158986993426,6.5626383628474763,6.2886847175893301,7.8705468489257884,7.4931089000067219,7.7983288129084043,7.2675384505802567,7.2078603209875878,8.2577550117892855,7.6897906609348627,8.5649471834522544,8.4165031111026991,8.4731536709586326,8.8479058275772413,8.5011141217527761,8.9519913937693705,8.548899345758306,7.582155930389141,6.2487901606204179,5.567752082820582,5.1917230337055251,5.0399205746044107,6.2273989535574685,5.7865120401065653,7.5263030454480022,9.4260232910349284,10.079681451563618,9.506525964484549,10.635501575634008,9.9244319581458864,9.7125517723116577,8.5765916148994297,7.7042992005327129,7.9606388909506993,7.832772352406951,7.9518173584922449,7.5006315192074746,8.230160186264845,8.4362557856884308,8.3447415189748604,10.436400859347639,10.738420468541086,12.387681919445312,13.36395297598752,14.607286122036205,15.078385602927241,15.000422747228448,12.56158057169247,12.931390833057904,12.795067129525613,12.040512536400287,11.986737390791866,12.735283891194129,10.787379029543212,10.455075159259211,10.867251224193678,11.04928716220549,11.719701600346442,13.013241049174006,13.741907070706217,12.231721072407439,11.756922549818734,13.545339647768024,12.902791418058204,12.387202208613896,11.822095218572342,12.979816162609056,12.69560685467925,12.387458670581459,12.633145821521079,12.703338098203888,12.498757822677481,11.840919648366977,10.153840878048149,8.8881786498832405,8.2136119996167061,10.359670933742002],"text":["t:   1<br />y:   0.000000000<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:   2<br />y:   0.318147940<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:   3<br />y:   1.304140058<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:   4<br />y:   1.523349823<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:   5<br />y:   2.558649638<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:   6<br />y:   2.186580108<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:   7<br />y:   3.403182342<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:   8<br />y:   2.877623656<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:   9<br />y:   3.437267374<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  10<br />y:   1.804153809<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  11<br />y:   2.780443404<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  12<br />y:   4.064550045<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  13<br />y:   5.639778341<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  14<br />y:   5.908566731<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  15<br />y:   6.390955456<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  16<br />y:   6.293802645<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  17<br />y:   5.684171050<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  18<br />y:   7.058238814<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  19<br />y:   7.231133198<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  20<br />y:   6.598362987<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  21<br />y:   7.642404166<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  22<br />y:   9.270335883<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  23<br />y:   7.276640052<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  24<br />y:   5.863840353<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  25<br />y:   5.197915899<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  26<br />y:   6.562638363<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  27<br />y:   6.288684718<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  28<br />y:   7.870546849<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  29<br />y:   7.493108900<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  30<br />y:   7.798328813<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  31<br />y:   7.267538451<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  32<br />y:   7.207860321<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  33<br />y:   8.257755012<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  34<br />y:   7.689790661<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  35<br />y:   8.564947183<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  36<br />y:   8.416503111<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  37<br />y:   8.473153671<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  38<br />y:   8.847905828<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  39<br />y:   8.501114122<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  40<br />y:   8.951991394<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  41<br />y:   8.548899346<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  42<br />y:   7.582155930<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  43<br />y:   6.248790161<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  44<br />y:   5.567752083<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  45<br />y:   5.191723034<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  46<br />y:   5.039920575<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  47<br />y:   6.227398954<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  48<br />y:   5.786512040<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  49<br />y:   7.526303045<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  50<br />y:   9.426023291<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  51<br />y:  10.079681452<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  52<br />y:   9.506525964<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  53<br />y:  10.635501576<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  54<br />y:   9.924431958<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  55<br />y:   9.712551772<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  56<br />y:   8.576591615<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  57<br />y:   7.704299201<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  58<br />y:   7.960638891<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  59<br />y:   7.832772352<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  60<br />y:   7.951817358<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  61<br />y:   7.500631519<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  62<br />y:   8.230160186<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  63<br />y:   8.436255786<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  64<br />y:   8.344741519<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  65<br />y:  10.436400859<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  66<br />y:  10.738420469<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  67<br />y:  12.387681919<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  68<br />y:  13.363952976<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  69<br />y:  14.607286122<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  70<br />y:  15.078385603<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  71<br />y:  15.000422747<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  72<br />y:  12.561580572<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  73<br />y:  12.931390833<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  74<br />y:  12.795067130<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  75<br />y:  12.040512536<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  76<br />y:  11.986737391<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  77<br />y:  12.735283891<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  78<br />y:  10.787379030<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  79<br />y:  10.455075159<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  80<br />y:  10.867251224<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  81<br />y:  11.049287162<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  82<br />y:  11.719701600<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  83<br />y:  13.013241049<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  84<br />y:  13.741907071<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  85<br />y:  12.231721072<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  86<br />y:  11.756922550<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  87<br />y:  13.545339648<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  88<br />y:  12.902791418<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  89<br />y:  12.387202209<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  90<br />y:  11.822095219<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  91<br />y:  12.979816163<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  92<br />y:  12.695606855<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  93<br />y:  12.387458671<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  94<br />y:  12.633145822<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  95<br />y:  12.703338098<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  96<br />y:  12.498757823<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  97<br />y:  11.840919648<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  98<br />y:  10.153840878<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  99<br />y:   8.888178650<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 100<br />y:   8.213612000<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 101<br />y:  10.359670934<br />sim_number: sim_number 10<br />sim_number: sim_number 10"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"sim_number 10","legendgroup":"sim_number 10","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Brownian Motion","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4,106],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,24.999999999999996,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"t","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-20.494368671717716,17.140734147388546],"tickmode":"array","ticktext":["-20","-10","0","10"],"tickvals":[-20,-10,0,10.000000000000004],"categoryorder":"array","categoryarray":["-20","-10","0","10"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"y","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"305c7327a99":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"305c7327a99","visdat":{"305c7327a99":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This code simulates 10 paths of Brownian Motion over 100 time units, starting from an initial value of 0. The <code>ts_brownian_motion_plot()</code> function creates a static plot of these simulations.</p>
</section>
</section>
<section id="geometric-brownian-motion" class="level2">
<h2 class="anchored" data-anchor-id="geometric-brownian-motion">Geometric Brownian Motion</h2>
<p>Geometric Brownian Motion (GBM) is a variation of Brownian Motion where the logarithm of the variable follows a Brownian Motion. It is commonly used to model stock prices in the Black-Scholes option pricing model.</p>
<section id="function-syntax-2" class="level3">
<h3 class="anchored" data-anchor-id="function-syntax-2">Function Syntax</h3>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_geometric_brownian_motion</span>(</span>
<span id="cb9-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_sims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb9-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.time =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>,</span>
<span id="cb9-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb9-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.sigma =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb9-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.initial_value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb9-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.delta_time =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span>,</span>
<span id="cb9-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.return_tibble =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb9-9">)</span></code></pre></div>
<ul>
<li><code>.num_sims</code>: Total number of simulations.</li>
<li><code>.time</code>: Total time of the simulation.</li>
<li><code>.mean</code>: Expected return.</li>
<li><code>.sigma</code>: Volatility.</li>
<li><code>.initial_value</code>: Initial value of the simulation.</li>
<li><code>.delta_time</code>: Time step size.</li>
<li><code>.return_tibble</code>: Return a tibble (TRUE) or a matrix (FALSE).</li>
</ul>
</section>
<section id="example-2" class="level3">
<h3 class="anchored" data-anchor-id="example-2">Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">gbm_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_geometric_brownian_motion</span>(</span>
<span id="cb10-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_sims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb10-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.time =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, </span>
<span id="cb10-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.mean =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, </span>
<span id="cb10-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.sigma =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, </span>
<span id="cb10-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.initial_value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb10-7">  )</span>
<span id="cb10-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(gbm_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  sim_number       t     y
  &lt;fct&gt;        &lt;int&gt; &lt;dbl&gt;
1 sim_number 1     1   100
2 sim_number 2     1   100
3 sim_number 3     1   100
4 sim_number 4     1   100
5 sim_number 5     1   100
6 sim_number 6     1   100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">gbm_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_brownian_motion_plot</span>(</span>
<span id="cb12-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.data =</span> gbm_data,</span>
<span id="cb12-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.date_col =</span> t,</span>
<span id="cb12-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.value_col =</span> y,</span>
<span id="cb12-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.interactive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb12-6">)</span>
<span id="cb12-7">gbm_plot</span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-1a786d48a890c280887c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1a786d48a890c280887c">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"y":[100,101.33943025414851,101.870521011931,101.4799354300584,100.12864462722116,99.904284081141739,101.16624451791229,101.5282715045236,100.11170466463639,100.15853775677895,98.705662942034778,99.266609005782954,99.052628534330253,99.540586043582721,99.063823736388372,99.249490028773849,99.021185646473285,98.073498449427362,97.351278726790724,96.113355203238811,96.330601241804786,96.59915945357794,97.766242102758383,97.537182508708241,97.637610259231451,98.033818018495566],"text":["t:  1<br />y: 100.00000<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  2<br />y: 101.33943<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  3<br />y: 101.87052<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  4<br />y: 101.47994<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  5<br />y: 100.12864<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  6<br />y:  99.90428<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  7<br />y: 101.16624<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  8<br />y: 101.52827<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t:  9<br />y: 100.11170<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 10<br />y: 100.15854<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 11<br />y:  98.70566<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 12<br />y:  99.26661<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 13<br />y:  99.05263<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 14<br />y:  99.54059<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 15<br />y:  99.06382<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 16<br />y:  99.24949<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 17<br />y:  99.02119<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 18<br />y:  98.07350<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 19<br />y:  97.35128<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 20<br />y:  96.11336<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 21<br />y:  96.33060<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 22<br />y:  96.59916<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 23<br />y:  97.76624<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 24<br />y:  97.53718<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 25<br />y:  97.63761<br />sim_number: sim_number 1<br />sim_number: sim_number 1","t: 26<br />y:  98.03382<br />sim_number: sim_number 1<br />sim_number: sim_number 1"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"sim_number 1","legendgroup":"sim_number 1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"y":[100,99.295862539341456,98.871418683651996,98.405358628116247,96.888772777595875,97.604428594453637,95.982582379695501,97.353503162193036,95.77354862079585,93.933763379615968,94.140905181770847,96.1773392272015,96.972058018469966,96.714959086955233,95.7682058549685,95.037927048393328,96.258086614192464,95.088394215471283,94.287080727265192,94.669862417364087,93.019951874848573,93.256945620149466,93.274043721382114,92.400651180002825,92.45290149066193,92.764617175560289],"text":["t:  1<br />y: 100.00000<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  2<br />y:  99.29586<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  3<br />y:  98.87142<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  4<br />y:  98.40536<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  5<br />y:  96.88877<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  6<br />y:  97.60443<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  7<br />y:  95.98258<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  8<br />y:  97.35350<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t:  9<br />y:  95.77355<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 10<br />y:  93.93376<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 11<br />y:  94.14091<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 12<br />y:  96.17734<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 13<br />y:  96.97206<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 14<br />y:  96.71496<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 15<br />y:  95.76821<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 16<br />y:  95.03793<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 17<br />y:  96.25809<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 18<br />y:  95.08839<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 19<br />y:  94.28708<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 20<br />y:  94.66986<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 21<br />y:  93.01995<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 22<br />y:  93.25695<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 23<br />y:  93.27404<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 24<br />y:  92.40065<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 25<br />y:  92.45290<br />sim_number: sim_number 2<br />sim_number: sim_number 2","t: 26<br />y:  92.76462<br />sim_number: sim_number 2<br />sim_number: sim_number 2"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"sim_number 2","legendgroup":"sim_number 2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"y":[100,98.465203389206209,97.557507980531824,97.103586957916036,98.084507043168799,97.597541551740704,98.393255071786612,98.143014756792041,98.217798810365665,97.731281793613832,96.46627824583733,94.883099865259624,95.412574648190883,95.573504107245924,94.578353930588804,92.835377920924429,91.686525150260266,89.93430463648717,91.326896555670203,90.770855064899024,90.523493527691841,92.524584363175961,91.261676200334307,91.99132647889401,91.793910964223414,91.444493600490347],"text":["t:  1<br />y: 100.00000<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  2<br />y:  98.46520<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  3<br />y:  97.55751<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  4<br />y:  97.10359<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  5<br />y:  98.08451<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  6<br />y:  97.59754<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  7<br />y:  98.39326<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  8<br />y:  98.14301<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t:  9<br />y:  98.21780<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 10<br />y:  97.73128<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 11<br />y:  96.46628<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 12<br />y:  94.88310<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 13<br />y:  95.41257<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 14<br />y:  95.57350<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 15<br />y:  94.57835<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 16<br />y:  92.83538<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 17<br />y:  91.68653<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 18<br />y:  89.93430<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 19<br />y:  91.32690<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 20<br />y:  90.77086<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 21<br />y:  90.52349<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 22<br />y:  92.52458<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 23<br />y:  91.26168<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 24<br />y:  91.99133<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 25<br />y:  91.79391<br />sim_number: sim_number 3<br />sim_number: sim_number 3","t: 26<br />y:  91.44449<br />sim_number: sim_number 3<br />sim_number: sim_number 3"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"sim_number 3","legendgroup":"sim_number 3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"y":[100,98.812410644529635,98.49262255808155,96.748802750231121,96.588184429325381,95.456331712000321,96.059193750914673,96.738227374317233,96.094542341806118,95.110170113057791,96.035400276166627,94.970789004295426,95.458507284312446,95.020459498601582,95.065614993159102,94.800653370251354,94.952897995886701,94.499897154647456,95.736980427035206,95.87380975169026,95.943570284386681,95.886205137091707,98.015719595034753,97.102520598999405,96.633350953435112,97.309111279420563],"text":["t:  1<br />y: 100.00000<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  2<br />y:  98.81241<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  3<br />y:  98.49262<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  4<br />y:  96.74880<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  5<br />y:  96.58818<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  6<br />y:  95.45633<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  7<br />y:  96.05919<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  8<br />y:  96.73823<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t:  9<br />y:  96.09454<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 10<br />y:  95.11017<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 11<br />y:  96.03540<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 12<br />y:  94.97079<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 13<br />y:  95.45851<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 14<br />y:  95.02046<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 15<br />y:  95.06561<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 16<br />y:  94.80065<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 17<br />y:  94.95290<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 18<br />y:  94.49990<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 19<br />y:  95.73698<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 20<br />y:  95.87381<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 21<br />y:  95.94357<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 22<br />y:  95.88621<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 23<br />y:  98.01572<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 24<br />y:  97.10252<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 25<br />y:  96.63335<br />sim_number: sim_number 4<br />sim_number: sim_number 4","t: 26<br />y:  97.30911<br />sim_number: sim_number 4<br />sim_number: sim_number 4"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"sim_number 4","legendgroup":"sim_number 4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"y":[100,100.22137414394827,100.05673796471136,99.150862598641922,97.784108511268002,98.052787041701222,97.899234155844525,97.198694275397415,97.533592488552713,99.528528630328694,100.55552732455182,100.6964291743151,99.907484098096432,100.292735576298,100.56348988765484,101.73120535129561,106.1528972119085,105.08962421431494,105.95570793409202,106.69347763892237,106.5913340403783,104.37306827540998,104.48154825276539,104.52902841651672,103.58863827148248,104.30414119557385],"text":["t:  1<br />y: 100.00000<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  2<br />y: 100.22137<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  3<br />y: 100.05674<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  4<br />y:  99.15086<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  5<br />y:  97.78411<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  6<br />y:  98.05279<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  7<br />y:  97.89923<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  8<br />y:  97.19869<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t:  9<br />y:  97.53359<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 10<br />y:  99.52853<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 11<br />y: 100.55553<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 12<br />y: 100.69643<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 13<br />y:  99.90748<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 14<br />y: 100.29274<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 15<br />y: 100.56349<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 16<br />y: 101.73121<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 17<br />y: 106.15290<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 18<br />y: 105.08962<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 19<br />y: 105.95571<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 20<br />y: 106.69348<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 21<br />y: 106.59133<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 22<br />y: 104.37307<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 23<br />y: 104.48155<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 24<br />y: 104.52903<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 25<br />y: 103.58864<br />sim_number: sim_number 5<br />sim_number: sim_number 5","t: 26<br />y: 104.30414<br />sim_number: sim_number 5<br />sim_number: sim_number 5"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"sim_number 5","legendgroup":"sim_number 5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"y":[100,100.72342851322999,102.6485406943568,101.41125204304717,101.02192524374836,100.10869524746063,100.93174980404591,98.587333488685317,98.145550204281051,98.049011664557625,98.520864521515392,99.604173760941251,100.23441936317026,100.67906496088111,101.97577334597487,102.66890634262437,101.08777698675951,99.193021938968826,100.8581998551637,100.95088700583194,100.11488640745181,101.99626724883481,101.65517848171302,103.65319382211315,103.42319967513754,103.36838092211266],"text":["t:  1<br />y: 100.00000<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  2<br />y: 100.72343<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  3<br />y: 102.64854<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  4<br />y: 101.41125<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  5<br />y: 101.02193<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  6<br />y: 100.10870<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  7<br />y: 100.93175<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  8<br />y:  98.58733<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t:  9<br />y:  98.14555<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 10<br />y:  98.04901<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 11<br />y:  98.52086<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 12<br />y:  99.60417<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 13<br />y: 100.23442<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 14<br />y: 100.67906<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 15<br />y: 101.97577<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 16<br />y: 102.66891<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 17<br />y: 101.08778<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 18<br />y:  99.19302<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 19<br />y: 100.85820<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 20<br />y: 100.95089<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 21<br />y: 100.11489<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 22<br />y: 101.99627<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 23<br />y: 101.65518<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 24<br />y: 103.65319<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 25<br />y: 103.42320<br />sim_number: sim_number 6<br />sim_number: sim_number 6","t: 26<br />y: 103.36838<br />sim_number: sim_number 6<br />sim_number: sim_number 6"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"sim_number 6","legendgroup":"sim_number 6","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"y":[100,100.43105954514328,101.11449021547115,98.726786264471968,96.40650135741312,97.677185973965109,95.582119206693605,95.24489059516371,94.937825522140116,96.801293773432448,98.759811401037908,98.097725150391668,96.969190737567018,97.632782509284411,97.653352723620102,98.208820605535365,98.002552573592723,96.626402944320603,96.907605179576947,98.038547240688217,97.606889236376801,96.036207909332504,98.709738456293792,98.71939567110104,98.459849095002582,99.338188824882394],"text":["t:  1<br />y: 100.00000<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  2<br />y: 100.43106<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  3<br />y: 101.11449<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  4<br />y:  98.72679<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  5<br />y:  96.40650<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  6<br />y:  97.67719<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  7<br />y:  95.58212<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  8<br />y:  95.24489<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t:  9<br />y:  94.93783<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 10<br />y:  96.80129<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 11<br />y:  98.75981<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 12<br />y:  98.09773<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 13<br />y:  96.96919<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 14<br />y:  97.63278<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 15<br />y:  97.65335<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 16<br />y:  98.20882<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 17<br />y:  98.00255<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 18<br />y:  96.62640<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 19<br />y:  96.90761<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 20<br />y:  98.03855<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 21<br />y:  97.60689<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 22<br />y:  96.03621<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 23<br />y:  98.70974<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 24<br />y:  98.71940<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 25<br />y:  98.45985<br />sim_number: sim_number 7<br />sim_number: sim_number 7","t: 26<br />y:  99.33819<br />sim_number: sim_number 7<br />sim_number: sim_number 7"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"sim_number 7","legendgroup":"sim_number 7","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"y":[100,98.191727411700953,97.827687366165478,96.932498086779688,96.85704920072979,95.754755133543952,96.503507754633674,96.627057508649045,96.810159120178213,98.182074912714526,98.557348094275739,98.808630512239731,98.775567833546305,97.792624075352094,98.215281566285796,99.385986690190293,99.100640804650183,100.28143734516318,99.356005166309643,99.705438887524892,99.656941910252769,100.84145659334123,99.831915411673748,99.496723739110791,100.21354608342104,98.373622503388148],"text":["t:  1<br />y: 100.00000<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  2<br />y:  98.19173<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  3<br />y:  97.82769<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  4<br />y:  96.93250<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  5<br />y:  96.85705<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  6<br />y:  95.75476<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  7<br />y:  96.50351<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  8<br />y:  96.62706<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t:  9<br />y:  96.81016<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 10<br />y:  98.18207<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 11<br />y:  98.55735<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 12<br />y:  98.80863<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 13<br />y:  98.77557<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 14<br />y:  97.79262<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 15<br />y:  98.21528<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 16<br />y:  99.38599<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 17<br />y:  99.10064<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 18<br />y: 100.28144<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 19<br />y:  99.35601<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 20<br />y:  99.70544<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 21<br />y:  99.65694<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 22<br />y: 100.84146<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 23<br />y:  99.83192<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 24<br />y:  99.49672<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 25<br />y: 100.21355<br />sim_number: sim_number 8<br />sim_number: sim_number 8","t: 26<br />y:  98.37362<br />sim_number: sim_number 8<br />sim_number: sim_number 8"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"sim_number 8","legendgroup":"sim_number 8","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"y":[100,100.39053238335289,99.805118194596659,99.312960470266603,99.229127012472802,99.225804385273577,99.52525654099901,97.954854068476777,97.623759970107088,95.900779497575527,97.496236539149976,95.893732943142453,94.817796883125851,95.963928894961299,97.008074071148442,96.93405296222069,97.02450094249383,97.568460195749722,97.771742122783039,97.842585285589024,99.219821582420181,99.715653506178,99.718274017666488,100.1619225961656,100.30980308932821,99.669637300081547],"text":["t:  1<br />y: 100.00000<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  2<br />y: 100.39053<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  3<br />y:  99.80512<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  4<br />y:  99.31296<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  5<br />y:  99.22913<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  6<br />y:  99.22580<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  7<br />y:  99.52526<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  8<br />y:  97.95485<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t:  9<br />y:  97.62376<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 10<br />y:  95.90078<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 11<br />y:  97.49624<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 12<br />y:  95.89373<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 13<br />y:  94.81780<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 14<br />y:  95.96393<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 15<br />y:  97.00807<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 16<br />y:  96.93405<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 17<br />y:  97.02450<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 18<br />y:  97.56846<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 19<br />y:  97.77174<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 20<br />y:  97.84259<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 21<br />y:  99.21982<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 22<br />y:  99.71565<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 23<br />y:  99.71827<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 24<br />y: 100.16192<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 25<br />y: 100.30980<br />sim_number: sim_number 9<br />sim_number: sim_number 9","t: 26<br />y:  99.66964<br />sim_number: sim_number 9<br />sim_number: sim_number 9"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"sim_number 9","legendgroup":"sim_number 9","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"y":[100,99.617842433177842,100.37115451131739,99.175615509122281,99.792753210925056,99.320522026537091,100.8335808473893,99.848916569995467,99.269018658323574,100.0049469940694,99.333623160513469,98.983517639295101,99.514444857846613,100.07570024943294,98.669066990036669,99.181136458808155,99.046175452794202,99.78298526950104,101.09746341965911,100.09129934112902,99.94986040571078,99.136626800632811,98.962403687323103,99.193984198490341,99.04746811151881,98.411441276430381],"text":["t:  1<br />y: 100.00000<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  2<br />y:  99.61784<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  3<br />y: 100.37115<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  4<br />y:  99.17562<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  5<br />y:  99.79275<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  6<br />y:  99.32052<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  7<br />y: 100.83358<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  8<br />y:  99.84892<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t:  9<br />y:  99.26902<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 10<br />y: 100.00495<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 11<br />y:  99.33362<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 12<br />y:  98.98352<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 13<br />y:  99.51444<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 14<br />y: 100.07570<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 15<br />y:  98.66907<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 16<br />y:  99.18114<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 17<br />y:  99.04618<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 18<br />y:  99.78299<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 19<br />y: 101.09746<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 20<br />y: 100.09130<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 21<br />y:  99.94986<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 22<br />y:  99.13663<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 23<br />y:  98.96240<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 24<br />y:  99.19398<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 25<br />y:  99.04747<br />sim_number: sim_number 10<br />sim_number: sim_number 10","t: 26<br />y:  98.41144<br />sim_number: sim_number 10<br />sim_number: sim_number 10"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"sim_number 10","legendgroup":"sim_number 10","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Geometric Brownian Motion","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.25,27.25],"tickmode":"array","ticktext":["0","10","20"],"tickvals":[0,10,20],"categoryorder":"array","categoryarray":["0","10","20"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"t","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[89.096345986365407,107.53143628904414],"tickmode":"array","ticktext":["90","95","100","105"],"tickvals":[90,95,100,105],"categoryorder":"array","categoryarray":["90","95","100","105"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"y","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"305c4b157ecf":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"305c4b157ecf","visdat":{"305c4b157ecf":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This code simulates 10 paths of Geometric Brownian Motion over 25 time units with an expected return of 0.05 and volatility of 0.2. The <code>ts_brownian_motion_plot()</code> function again helps in visualizing the simulations.</p>
</section>
</section>
</section>
<section id="your-turn" class="level1">
<h1>Your Turn!</h1>
<p>These functions offer a straightforward way to simulate and visualize complex stochastic processes. I encourage you to tweak the parameters, run your own simulations, and explore how different settings affect the outcomes. Whether you’re modeling stock prices or random movements in nature, these tools can provide valuable insights.</p>
<p>Feel free to check out the detailed documentation of these functions <a href="https://www.spsanderson.com/healthyR.ts/reference/index.html">here</a> and experiment with your own datasets.</p>
<hr>
<p>Happy coding!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>healthyrts</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-06-27/</guid>
  <pubDate>Thu, 27 Jun 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>How to Run a Macro When a Cell Value Changes in VBA</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-06-26/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hello, everyone! Today, we’ll be diving into a practical example of how to run a macro when a cell value changes in VBA. This is particularly useful when you need to trigger certain actions based on user input or dynamic data changes in your Excel sheets. Let’s get started!</p>
</section>
<section id="setting-up-the-worksheet-change-event" class="level1">
<h1>Setting Up the Worksheet Change Event</h1>
<p>To run a macro when a cell value changes, we need to use the <code>Worksheet_Change</code> event. This event is triggered every time a cell value in a specific worksheet changes.</p>
<p>Here’s the basic structure of the <code>Worksheet_Change</code> event:</p>
<pre class="vba"><code>Private Sub Worksheet_Change(ByVal Target As Range)
    ' Your code here
End Sub</code></pre>
<p>In this event, <code>Target</code> refers to the range of cells that have changed. We’ll use this to identify if the change occurred in the cell or range of cells we are interested in.</p>
</section>
<section id="example-scenario" class="level1">
<h1>Example Scenario</h1>
<p>Imagine we want to run a macro whenever the value in cell A1 changes. We’ll write a simple macro that displays a message box when this happens.</p>
<section id="step-by-step-guide" class="level2">
<h2 class="anchored" data-anchor-id="step-by-step-guide">Step-by-Step Guide</h2>
<ol type="1">
<li><strong>Open the VBA Editor:</strong>
<ul>
<li>Press <code>ALT + F11</code> to open the VBA editor.</li>
</ul></li>
<li><strong>Insert the Code:</strong>
<ul>
<li>In the VBA editor, find the sheet where you want to apply the change event. For example, <code>Sheet1</code>.</li>
<li>Double-click on <code>Sheet1</code> to open its code window.</li>
<li>Insert the following code:</li>
</ul></li>
</ol>
<pre class="vba"><code>Private Sub Worksheet_Change(ByVal Target As Range)
    ' Check if the changed cell is A1
    If Not Intersect(Target, Me.Range("A1")) Is Nothing Then
        ' Run your macro here
        Call MyMacro
    End If
End Sub</code></pre>
</section>
<section id="explanation" class="level2">
<h2 class="anchored" data-anchor-id="explanation">Explanation</h2>
<ul>
<li><p><strong>Worksheet_Change Event:</strong> This event gets triggered whenever any cell value in <code>Sheet1</code> changes.</p></li>
<li><p><strong>Intersect Function:</strong> We use the <code>Intersect</code> function to check if the changed cell (<code>Target</code>) overlaps with cell A1 (<code>Me.Range("A1")</code>). If there is an intersection (i.e., the changed cell is A1), the condition returns <code>True</code>.</p></li>
<li><p><strong>Call MyMacro:</strong> When the condition is <code>True</code>, we call another macro named <code>MyMacro</code>. This is where you define what actions you want to perform when cell A1 changes.</p></li>
</ul>
</section>
<section id="defining-the-macro" class="level2">
<h2 class="anchored" data-anchor-id="defining-the-macro">Defining the Macro</h2>
<p>Next, let’s define the <code>MyMacro</code> that gets called when cell A1 changes. For simplicity, we’ll make it display a message box.</p>
<pre class="vba"><code>Sub MyMacro()
    MsgBox "Cell A1 has changed!"
End Sub</code></pre>
</section>
<section id="putting-it-all-together" class="level2">
<h2 class="anchored" data-anchor-id="putting-it-all-together">Putting It All Together</h2>
<p>Here’s the complete code for <code>Sheet1</code>:</p>
<pre class="vba"><code>Private Sub Worksheet_Change(ByVal Target As Range)
    ' Check if the changed cell is A1
    If Not Intersect(Target, Me.Range("A1")) Is Nothing Then
        ' Run your macro here
        Call MyMacro
    End If
End Sub

Sub MyMacro()
    MsgBox "Cell A1 has changed!"
End Sub</code></pre>
</section>
<section id="testing-the-macro" class="level2">
<h2 class="anchored" data-anchor-id="testing-the-macro">Testing the Macro</h2>
<p>To test the macro:</p>
<ol type="1">
<li>Close the VBA editor and go back to Excel.</li>
<li>Change the value in cell A1.</li>
<li>You should see a message box saying, “Cell A1 has changed!”</li>
</ol>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>By using the <code>Worksheet_Change</code> event, you can easily set up macros to run whenever specific cell values change. This can be incredibly useful for automating tasks and making your Excel workbooks more dynamic and interactive.</p>
<p>I hope you found this guide helpful! If you have any questions or want to share how you use this in your projects, feel free to leave a comment below.</p>
<p>Happy coding!</p>
</section>
<section id="reference" class="level1">
<h1>Reference</h1>
<p><a href="https://learn.microsoft.com/en-us/office/vba/api/excel.worksheet.change">https://learn.microsoft.com/en-us/office/vba/api/excel.worksheet.change</a></p>
<hr>
<p>That’s it for today! Remember to keep experimenting and exploring new ways to automate your Excel tasks using VBA. See you next time!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>vba</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-06-26/</guid>
  <pubDate>Wed, 26 Jun 2024 04:00:00 GMT</pubDate>
</item>
<item>
  <title>How to Extract Strings Between Specific Characters in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2024-06-25/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hello, R enthusiasts! Today, we’re jumping into a common text processing task: extracting strings between specific characters. This is a great skill for data cleaning and manipulation, especially when working with raw text data. I’m going to show you how to achieve this using base R, the <code>stringr</code> package, and the <code>stringi</code> package. Let’s go!</p>
<section id="extracting-strings-using-base-r" class="level2">
<h2 class="anchored" data-anchor-id="extracting-strings-using-base-r">Extracting Strings Using Base R</h2>
<p>Base R provides several ways to extract substrings, including <code>sub</code> and <code>gregexpr</code>. Here, we’ll use <code>sub</code> and <code>gsub</code> for some examples.</p>
<section id="example-1-base-r-with-sub" class="level3">
<h3 class="anchored" data-anchor-id="example-1-base-r-with-sub">Example 1: Base R with <code>sub</code></h3>
<p>Suppose you have a string and you want to extract the text between two characters, say <code>[</code> and <code>]</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample string</span></span>
<span id="cb1-2">text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Extract this [text] from the string."</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using sub to extract text between square brackets</span></span>
<span id="cb1-5">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[(.*?)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">].*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, text)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the result</span></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "text"</code></pre>
</div>
</div>
</section>
<section id="example-2-base-r-with-gsub" class="level3">
<h3 class="anchored" data-anchor-id="example-2-base-r-with-gsub">Example 2: Base R with <code>gsub</code></h3>
<p>Now, let’s extract text between parentheses <code>(</code> and <code>)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example string</span></span>
<span id="cb3-2">text2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a sample (extract this part) string."</span></span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract string between parentheses using base R</span></span>
<span id="cb3-5">extracted_base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">((.*)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">).*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, text2)</span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(extracted_base)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "extract this part"</code></pre>
</div>
</div>
<p>In these examples, <code>sub</code> and <code>gsub</code> use regular expressions to find the text between the specified characters and replace the entire string with the extracted part. The pattern <code>.*\\[(.*?)\\].*</code> and <code>.*\\((.*)\\).*</code> break down as follows: - <code>.*</code> matches any character (except for line terminators) zero or more times. - <code>\\[</code> matches the literal <code>[</code> and <code>\\(</code> matches the literal <code>(</code>. - <code>(.*?)</code> and <code>(.*)</code> are non-greedy matches for any character (.) zero or more times. - <code>\\]</code> matches the literal <code>]</code> and <code>\\)</code> matches the literal <code>)</code>. - <code>\\1</code> in the replacement string refers to the first capture group, i.e., the text between <code>[ ]</code> and <code>( )</code>.</p>
</section>
</section>
<section id="extracting-strings-using-stringr" class="level2">
<h2 class="anchored" data-anchor-id="extracting-strings-using-stringr">Extracting Strings Using <code>stringr</code></h2>
<p>The <code>stringr</code> package, part of the tidyverse, makes string manipulation more straightforward with consistent functions.</p>
<section id="example-1-using-stringrstr_extract" class="level3">
<h3 class="anchored" data-anchor-id="example-1-using-stringrstr_extract">Example 1: Using <code>stringr::str_extract</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the stringr package</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using str_extract to extract text between square brackets</span></span>
<span id="cb5-5">result_str_extract <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_extract</span>(text, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(?&lt;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[).*?(?=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">])"</span>)</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the result</span></span>
<span id="cb5-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result_str_extract)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "text"</code></pre>
</div>
</div>
</section>
<section id="example-2-using-stringr-to-extract-text-between-parentheses" class="level3">
<h3 class="anchored" data-anchor-id="example-2-using-stringr-to-extract-text-between-parentheses">Example 2: Using <code>stringr</code> to extract text between parentheses</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example using stringr</span></span>
<span id="cb7-2">extracted_str <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_extract</span>(text2, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(.*?</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>)</span>
<span id="cb7-3">extracted_str <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(extracted_str, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(extracted_str)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "extract this part"</code></pre>
</div>
</div>
<p>The <code>str_extract</code> function extracts the first substring matching a regex pattern. Here, <code>(?&lt;=\\[).*?(?=\\])</code> and <code>\\(.*?\\)</code> use lookbehind <code>(?&lt;=\\[)</code> and lookahead <code>(?=\\])</code> assertions to match text between <code>[</code> and <code>]</code>, and simple matching for text between <code>(</code> and <code>)</code>. <code>str_sub</code> is then used to remove the enclosing parentheses.</p>
</section>
</section>
<section id="extracting-strings-using-stringi" class="level2">
<h2 class="anchored" data-anchor-id="extracting-strings-using-stringi">Extracting Strings Using <code>stringi</code></h2>
<p>The <code>stringi</code> package provides robust and efficient tools for string manipulation.</p>
<section id="example-1-using-stringistri_extract" class="level3">
<h3 class="anchored" data-anchor-id="example-1-using-stringistri_extract">Example 1: Using <code>stringi::stri_extract</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the stringi package</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringi)</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using stri_extract to extract text between square brackets</span></span>
<span id="cb9-5">result_stri_extract <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stri_extract</span>(text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regex =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(?&lt;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[).*?(?=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">])"</span>)</span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the result</span></span>
<span id="cb9-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result_stri_extract)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "text"</code></pre>
</div>
</div>
</section>
<section id="example-2-using-stringi-to-extract-text-between-parentheses" class="level3">
<h3 class="anchored" data-anchor-id="example-2-using-stringi-to-extract-text-between-parentheses">Example 2: Using <code>stringi</code> to extract text between parentheses</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example using stringi</span></span>
<span id="cb11-2">extracted_stri <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> stringi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stri_extract_first_regex</span>(text2, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(.*?</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>)</span>
<span id="cb11-3">extracted_stri <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> stringi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stri_sub</span>(extracted_stri, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(extracted_stri)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "extract this part"</code></pre>
</div>
</div>
<p>The <code>stri_extract</code> function from <code>stringi</code> works similarly to <code>str_extract</code>, utilizing regex patterns for text extraction. It’s highly optimized for performance, especially with large datasets. <code>stri_sub</code> is used to remove the enclosing parentheses.</p>
</section>
</section>
<section id="your-turn" class="level2">
<h2 class="anchored" data-anchor-id="your-turn">Your Turn!</h2>
<p>Experimenting with these functions and patterns on your own datasets will help you understand their nuances. Here are a few additional exercises to solidify your understanding:</p>
<ul>
<li>Extract text between parentheses <code>(</code> and <code>)</code>.</li>
<li>Extract text between the first and last occurrences of a specific character in a string.</li>
<li>Extract all occurrences of text between two characters in a string.</li>
</ul>
<p>Feel free to use the examples provided as a template for your own tasks.</p>
<p>Happy coding!</p>
<hr>
<section id="bonus-combining-methods" class="level3">
<h3 class="anchored" data-anchor-id="bonus-combining-methods">Bonus: Combining Methods</h3>
<p>For more complex scenarios, you might need to combine different methods. Here’s a quick example of how you can handle multiple extractions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample string with multiple patterns</span></span>
<span id="cb13-2">text_multiple <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Here is [text1] and here is (text2)."</span></span>
<span id="cb13-3"></span>
<span id="cb13-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using gregexpr and regmatches to extract all matches</span></span>
<span id="cb13-5">matches <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regmatches</span>(</span>
<span id="cb13-6">  text_multiple, </span>
<span id="cb13-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gregexpr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(?&lt;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[).*?(?=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">])|(?&lt;=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">().*?(?=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">))"</span>, </span>
<span id="cb13-8">           text_multiple, </span>
<span id="cb13-9">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perl =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb13-10">  )</span>
<span id="cb13-11"></span>
<span id="cb13-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the matches</span></span>
<span id="cb13-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(matches))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "text1" "text2"</code></pre>
</div>
</div>
<p>This example uses <code>gregexpr</code> to find all matches and <code>regmatches</code> to extract them.</p>
<hr>
<p>Until next time, keep exploring and enjoying the power of R!</p>


</section>
</section>
</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>operations</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2024-06-25/</guid>
  <pubDate>Tue, 25 Jun 2024 04:00:00 GMT</pubDate>
</item>
</channel>
</rss>
