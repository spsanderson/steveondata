<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Steve&#39;s Data Tips and Tricks</title>
<link>https://www.spsanderson.com/steveondata/index.html</link>
<atom:link href="https://www.spsanderson.com/steveondata/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.3.433</generator>
<lastBuildDate>Mon, 18 Dec 2023 05:00:00 GMT</lastBuildDate>
<item>
  <title>Exploring Variance Inflation Factor (VIF) in R: A Practical Guide</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-12-18/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hey there fellow R enthusiasts! Today, we’re diving into the fascinating world of Variance Inflation Factor (VIF) and how to calculate it using R. VIF is a crucial metric that helps us understand the level of multicollinearity among predictors in a regression model. So, buckle up your seatbelts, and let’s embark on this coding adventure!</p>
</section>
<section id="setting-the-stage" class="level1">
<h1>Setting the Stage</h1>
<p>Let’s start by setting up our stage. We’ll use a linear regression model with the <code>mtcars</code> dataset. Here’s the model we’re going to work with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Setting up the model</span></span>
<span id="cb1-2">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> disp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> hp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> wt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> drat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span></code></pre></div>
</div>
</section>
<section id="calculating-vif-with-car-library" class="level1">
<h1>Calculating VIF with <code>car</code> library</h1>
<p>Now, the exciting part! We’ll employ the <code>car</code> library to compute the VIF using the <code>vif</code> function. VIF measures how much the variance of an estimated regression coefficient increases if your predictors are correlated. It’s a handy tool to identify collinearity issues in your model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Installing and loading the 'car' library</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("car")</span></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(car)</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculating VIF</span></span>
<span id="cb2-6">vif_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vif</span>(model)</span>
<span id="cb2-7">vif_values</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    disp       hp       wt     drat 
8.209402 2.894373 5.096601 2.279547 </code></pre>
</div>
</div>
</section>
<section id="visualizing-the-model-and-residuals" class="level1">
<h1>Visualizing the Model and Residuals</h1>
<p>To gain deeper insights, let’s visualize our model and its residuals. Visualizations often provide a clearer picture of what’s happening under the hood.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualizing the model</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Fit"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-18/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These plots will give us a sense of how well our model fits the data and whether there are any patterns in the residuals.</p>
</section>
<section id="visualizing-vif" class="level1">
<h1>Visualizing VIF</h1>
<p>Now, let’s bring our VIF into the spotlight. We’ll use a barplot to showcase the VIF values for each predictor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualizing VIF</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">barplot</span>(vif_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance Inflation Factor (VIF)"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-18/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This barplot will help us identify predictors that might be causing multicollinearity issues in our model.</p>
</section>
<section id="correlation-matrix-and-visualization" class="level1">
<h1>Correlation Matrix and Visualization</h1>
<p>To complete our journey, let’s create a correlation matrix of the predictors and visualize it. Understanding the correlations between variables is crucial in regression analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Creating a correlation matrix</span></span>
<span id="cb6-2">cor_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor</span>(mtcars[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"disp"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hp"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wt"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drat"</span>)])</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualizing the correlation matrix</span></span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image</span>(cor_matrix, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Correlation Matrix"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>))(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>))</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-18/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This visualization will give us a colorful snapshot of how our predictors are correlated.</p>
</section>
<section id="wrapping-up" class="level1">
<h1>Wrapping Up</h1>
<p>And there you have it, folks! We’ve explored the ins and outs of calculating VIF in R, visualized our model, checked residuals, and even took a colorful glance at predictor correlations. These tools are invaluable in ensuring the health and accuracy of our regression models.</p>
<p>Feel free to tweak and play around with the code, and don’t forget to share your findings with the R community. Happy coding!</p>
<p>Keep calm and code in R, Steve</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-12-18/index.html</guid>
  <pubDate>Mon, 18 Dec 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Demystifying Odds Ratios in Logistic Regression: Your R Recipe for Loan Defaults</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-12-15/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Ever wondered why some individuals default on loans while others don’t? Logistic regression can shed light on this, and calculating odds ratios in R is the secret sauce. So, strap on your data aprons, folks, and let’s cook up some insights!</p>
</section>
<section id="what-are-odds-ratios" class="level1">
<h1>What are Odds Ratios?</h1>
<p>Imagine a loan officer flipping a coin to decide whether to approve your loan. Odds ratios tell you how much more likely one factor (like your income) makes the “heads” (approval) side appear compared to another (like your student status).</p>
<p>In logistic regression, odds ratios compare the odds of an event (loan default, in our case) for two groups defined by a specific variable. They’re like multipliers: greater than 1 means something increases the chances of default, while less than 1 means it decreases them.</p>
</section>
<section id="the-r-recipe-with-islr-flavor" class="level1">
<h1>The R Recipe (with ISLR Flavor)</h1>
<ol type="1">
<li><strong>Gather your ingredients:</strong> Load the ISLR package and the <code>Default</code> dataset. This data tells us whether individuals defaulted on loans, their student status, bank balance, and income.</li>
<li><strong>Whip up the model:</strong> Use the <code>glm()</code> function with <code>family='binomial'</code> to fit a logistic regression model that predicts loan defaults based on student status, balance, and income. Think of it as the base for your delicious insights.</li>
<li><strong>Extract the spices:</strong> Use the <code>summary()</code> function to access the estimated coefficients for each variable. These are the secret ingredients that give your model flavor.</li>
<li><strong>Unleash the magic of exponentiation:</strong> Apply the <code>exp()</code> function to transform the coefficients back to the odds ratio scale. Remember, logistic regression operates on log-odds, so we need to break the code.</li>
<li><strong>Savor the results:</strong> Analyze the odds ratios. Are they greater than 1? Those factors increase default odds. Less than 1? They decrease them. A value near 1 suggests little to no effect.</li>
</ol>
</section>
<section id="example-time" class="level1">
<h1>Example Time</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load ISLR package and data</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ISLR)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(Default)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  default student   balance    income
1      No      No  729.5265 44361.625
2      No     Yes  817.1804 12106.135
3      No      No 1073.5492 31767.139
4      No      No  529.2506 35704.494
5      No      No  785.6559 38463.496
6      No     Yes  919.5885  7491.559</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit the model</span></span>
<span id="cb3-2">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(default<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>student<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>balance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>income, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'binomial'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>Default)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#disable scientific notation for model summary</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scipen=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">999</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract and exponentiate coefficients</span></span>
<span id="cb3-8">odds_ratios <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(model))</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the odds ratios</span></span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Odds ratios:"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odds ratios:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(odds_ratios)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)    studentYes       balance        income 
0.00001903854 0.52373166965 1.00575299051 1.00000303345 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Odds ratios with confidence intervals:"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odds ratios with confidence intervals:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Odds_Ratio =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(model), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">confint</span>(model)))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>               Odds_Ratio          2.5 %       97.5 %
(Intercept) 0.00001903854 0.000007074481 0.0000487808
studentYes  0.52373166965 0.329882707270 0.8334223982
balance     1.00575299051 1.005308940686 1.0062238757
income      1.00000303345 0.999986952969 1.0000191246</code></pre>
</div>
</div>
<p>Interpretation time! Being a student decreases default with log odds by -0.646, while higher income leaves log odds basically flat.</p>
<p><strong>Go Forth and Experiment!</strong></p>
<p>This is just the tip of the iceberg! Play around with different models, variables, and visualizations using RStudio. Remember, the more you experiment, the better you’ll understand the magic of odds ratios and logistic regression. Now, go forth and analyze!</p>
<p><strong>Bonus Tip:</strong> Check out the <code>confint()</code> function to calculate confidence intervals for your odds ratios. This adds another layer of spice to your statistical analysis!</p>
<p>So, there you have it! Odds ratios in R, made easy with the ISLR package and a dash of culinary magic. Remember, the key ingredients are understanding, practice, and a sprinkle of creativity. Bon appétit, data chefs!</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-12-15/index.html</guid>
  <pubDate>Fri, 15 Dec 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Decoding the Mystery: How to Interpret Regression Output in R Like a Champ</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-12-14/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Ever run an R regression and stared at the output, feeling like you’re deciphering an ancient scroll? Fear not, fellow data enthusiasts! Today, we’ll crack the code and turn those statistics into meaningful insights.</p>
<p><strong>Let’s grab our trusty R arsenal and set up the scene:</strong></p>
<ul>
<li><strong>Dataset:</strong> <code>mtcars</code> (a classic car dataset in R)</li>
<li><strong>Regression:</strong> Linear model with <code>mpg</code> as the dependent variable (miles per gallon) and all other variables as independent variables (predictors)</li>
</ul>
</section>
<section id="step-1-summon-the-stats-gods-with-summary" class="level1">
<h1>Step 1: Summon the Stats Gods with “summary()”</h1>
<p>First, cast your R spell with <code>summary(lm(mpg ~ ., data = mtcars))</code>. This incantation conjures a table of coefficients, p-values, and other stats. Don’t panic if it looks like a cryptic riddle! We’ll break it down:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ ., data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4506 -1.6044 -0.1196  1.2193  4.6271 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) 12.30337   18.71788   0.657   0.5181  
cyl         -0.11144    1.04502  -0.107   0.9161  
disp         0.01334    0.01786   0.747   0.4635  
hp          -0.02148    0.02177  -0.987   0.3350  
drat         0.78711    1.63537   0.481   0.6353  
wt          -3.71530    1.89441  -1.961   0.0633 .
qsec         0.82104    0.73084   1.123   0.2739  
vs           0.31776    2.10451   0.151   0.8814  
am           2.52023    2.05665   1.225   0.2340  
gear         0.65541    1.49326   0.439   0.6652  
carb        -0.19942    0.82875  -0.241   0.8122  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.65 on 21 degrees of freedom
Multiple R-squared:  0.869, Adjusted R-squared:  0.8066 
F-statistic: 13.93 on 10 and 21 DF,  p-value: 3.793e-07</code></pre>
</div>
</div>
<section id="coefficients" class="level2">
<h2 class="anchored" data-anchor-id="coefficients">Coefficients</h2>
<p>These tell you how much, on average, the dependent variable changes for a one-unit increase in the corresponding independent variable (holding other variables constant). For example, a coefficient of 0.05 for <code>cyl</code> means for every one more cylinder, mpg is expected to increase by 0.05 miles per gallon, on average.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>coefficients</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         cyl        disp          hp        drat          wt 
12.30337416 -0.11144048  0.01333524 -0.02148212  0.78711097 -3.71530393 
       qsec          vs          am        gear        carb 
 0.82104075  0.31776281  2.52022689  0.65541302 -0.19941925 </code></pre>
</div>
</div>
</section>
<section id="p-values" class="level2">
<h2 class="anchored" data-anchor-id="p-values">P-values</h2>
<p>These whisper secrets about significance. A p-value less than 0.05 (like for <code>wt</code>!) means the observed relationship between the variable and mpg is unlikely to be due to chance. The following are the individual p-values for each variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>coefficients[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         cyl        disp          hp        drat          wt 
 0.51812440  0.91608738  0.46348865  0.33495531  0.63527790  0.06325215 
       qsec          vs          am        gear        carb 
 0.27394127  0.88142347  0.23398971  0.66520643  0.81217871 </code></pre>
</div>
</div>
<p>Now the overall p-value for the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">model_p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(.model) {</span>
<span id="cb7-2">  </span>
<span id="cb7-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get p-values</span></span>
<span id="cb7-4">  fstat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(.model)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fstatistic</span>
<span id="cb7-5">  p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pf</span>(fstat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], fstat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], fstat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lower.tail =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(p)</span>
<span id="cb7-7">}</span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model_p</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.model =</span> model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       value 
3.793152e-07 </code></pre>
</div>
</div>
</section>
</section>
<section id="step-2-lets-talk-turkey---interpreting-the-numbers" class="level1">
<h1>Step 2: Let’s Talk Turkey - Interpreting the Numbers</h1>
<section id="coefficients-1" class="level2">
<h2 class="anchored" data-anchor-id="coefficients-1">Coefficients</h2>
<p>Think of them as slopes. A positive coefficient means the dependent variable increases with the independent variable. Negative? The opposite! For example, <code>disp</code> has a negative coefficient, so bigger engines (larger displacement) tend to have lower mpg.</p>
</section>
<section id="p-values-1" class="level2">
<h2 class="anchored" data-anchor-id="p-values-1">P-values</h2>
<p>Imagine a courtroom. A low p-value is like a strong witness, convincing you the relationship between the variables is real. High p-values (like for <code>am</code>!) are like unreliable witnesses, leaving us unsure.</p>
</section>
</section>
<section id="step-3-zoom-out---the-bigger-picture" class="level1">
<h1>Step 3: Zoom Out - The Bigger Picture</h1>
<section id="r-squared" class="level2">
<h2 class="anchored" data-anchor-id="r-squared">R-squared</h2>
<p>This tells you how well the model explains the variation in mpg. A value close to 1 is fantastic, while closer to 0 means the model needs work. In our case, it’s not bad, but there’s room for improvement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>r.squared</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8690158</code></pre>
</div>
</div>
</section>
<section id="residuals" class="level2">
<h2 class="anchored" data-anchor-id="residuals">Residuals</h2>
<p>These are the differences between the actual mpg values and the model’s predictions. Analyzing them can reveal hidden patterns and model issues.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>residuals)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    model.residuals
Mazda RX4              -1.599505761
Mazda RX4 Wag          -1.111886079
Datsun 710             -3.450644085
Hornet 4 Drive          0.162595453
Hornet Sportabout       1.006565971
Valiant                -2.283039036
Duster 360             -0.086256253
Merc 240D               1.903988115
Merc 230               -1.619089898
Merc 280                0.500970058
Merc 280C              -1.391654392
Merc 450SE              2.227837890
Merc 450SL              1.700426404
Merc 450SLC            -0.542224699
Cadillac Fleetwood     -1.634013415
Lincoln Continental    -0.536437711
Chrysler Imperial       4.206370638
Fiat 128                4.627094192
Honda Civic             0.503261089
Toyota Corolla          4.387630904
Toyota Corona          -2.143103442
Dodge Challenger       -1.443053221
AMC Javelin            -2.532181498
Camaro Z28             -0.006021976
Pontiac Firebird        2.508321011
Fiat X1-9              -0.993468693
Porsche 914-2          -0.152953961
Lotus Europa            2.763727417
Ford Pantera L         -3.070040803
Ferrari Dino            0.006171846
Maserati Bora           1.058881618
Volvo 142E             -2.968267683</code></pre>
</div>
</div>
<p><strong>Bonus Tip:</strong> Visualize the data! Scatter plots and other graphs can make relationships between variables pop.</p>
<p><strong>Remember:</strong> Interpreting regression output is an art, not a science. Use your domain knowledge, consider the context, and don’t hesitate to explore further!</p>
<p><strong>So next time you face regression output, channel your inner R wizard and remember:</strong></p>
<ul>
<li>Coefficients whisper about slopes and changes.</li>
<li>P-values tell tales of significance, true or false.</li>
<li>R-squared unveils the model’s explanatory magic.</li>
<li>Residuals hold hidden clues, waiting to be discovered.</li>
</ul>
<p>With these tools in your belt, you’ll be interpreting regression output like a pro in no time! Now go forth and conquer the data, fellow R adventurers!</p>
<p><strong>Note:</strong> This is just a brief example. For a deeper dive, explore specific diagnostics, model selection techniques, and other advanced topics to truly master the art of regression interpretation.</p>


</section>
</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-12-14/index.html</guid>
  <pubDate>Thu, 14 Dec 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Conquering Unequal Variance with Weighted Least Squares in R: A Practical Guide</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-12-12/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Tired of your least-squares regression model giving wonky results because some data points shout louder than others? Meet Weighted Least Squares (WLS), the superhero of regression, ready to tackle unequal variance (heteroscedasticity) and give your model the justice it deserves! Today, we’ll dive into the world of WLS in R, using base functions for maximum transparency. Buckle up, data warriors!</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p><strong>The Scenario:</strong> Imagine studying the relationship between exam scores and study hours. But wait, some students took the test multiple times, inflating their data points! This unequal variance can skew your ordinary least squares (OLS) model, making it unreliable. WLS to the rescue!</p>
<section id="steps" class="level2">
<h2 class="anchored" data-anchor-id="steps">Steps</h2>
<p><strong>Step 1: Gathering the Troops (Data):</strong></p>
<p>Let’s create some simulated data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate exam scores and study hours</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb1-3">scores <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb1-4">hours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb1-5">hours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> hours <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add heteroscedasticity</span></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a data frame</span></span>
<span id="cb1-8">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(scores, hours)</span></code></pre></div>
</div>
<p><strong>Step 2: Visualizing the Battlefield:</strong></p>
<p>A scatter plot is our trusty map:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hours, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>scores)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-12/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Do you see those clusters of high-scoring students with more study hours? They’re the loud ones skewing the OLS line.</p>
<p><strong>Step 3: Building the WLS Wall:</strong></p>
<p>It’s time to define our weights. We want to give less weight to observations with high variance (those loud students) and more weight to those with low variance. Here’s a simple approach:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate inverse of variance</span></span>
<span id="cb3-2">weights <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hours)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit WLS model</span></span>
<span id="cb3-5">wls_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(scores <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hours, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weights =</span> weights, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data)</span></code></pre></div>
</div>
<p><strong>Step 4: Inspecting the Model’s Performance:</strong></p>
<p>Let’s see if WLS silenced the loud ones:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(wls_model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = scores ~ hours, data = data, weights = weights)

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-75.854  -1.456   0.927   3.509  57.472 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   68.524      0.632 108.421   &lt;2e-16 ***
hours         -1.085      1.480  -0.733    0.465    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.65 on 98 degrees of freedom
Multiple R-squared:  0.00545,   Adjusted R-squared:  -0.004698 
F-statistic: 0.537 on 1 and 98 DF,  p-value: 0.4654</code></pre>
</div>
</div>
<p>Compare this summary to your OLS model’s. Do the coefficients and residuals look more sensible?</p>
<p><strong>Step 5: Visualizing the Conquered Land:</strong></p>
<p>Time to see if WLS straightened the line:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hours, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>scores)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hours, wls_model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fitted, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-12/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice how the red WLS line now passes closer to the majority of data points, unlike the blue OLS line that chased the loud ones.</p>
<p><strong>Step 6: Residuals: The Echoes of Battle:</strong></p>
<p>Let’s see if the residuals (errors) are under control:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hours, wls_model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>residuals)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-12/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A random scatterplot of residuals is a good sign! No more funky patterns indicating heteroscedasticity.</p>
<p><strong>The Victory Lap:</strong></p>
<p>WLS has restored justice to your regression model! Remember, this is just a basic example. You can customize your weights based on your specific data and needs.</p>
<p><strong>Now it’s your turn!</strong> Try WLS on your own data and see the magic unfold. Remember, data analysis is an adventure, and WLS is your trusty steed. Ride on, data warrior!</p>
<p><strong>Bonus Tip:</strong> Check out the <code>lmtest</code> and <code>sandwich</code> packages for even more advanced WLS analysis.</p>
<p>Happy coding!</p>


</section>
</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-12-12/index.html</guid>
  <pubDate>Tue, 12 Dec 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Exploring TidyAML: Simplifying Regression Analysis in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-12-08/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>If you’re a data enthusiast diving into the world of regression analysis in R, you’ve likely encountered the challenges of managing code complexity and juggling different modeling engines. The good news is that there’s a powerful tool to streamline your regression workflow – the tidyAML R package.</p>
</section>
<section id="getting-started-with-tidyaml" class="level1">
<h1>Getting Started with TidyAML</h1>
<p>Before we dive into the script, let’s make sure you have the necessary libraries installed. Fire up your R console and install the tidyAML package along with its dependencies:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyAML"</span>)</span></code></pre></div>
<p>Now, let’s explore a script that leverages tidyAML for quick and efficient regression analysis. Here’s a breakdown of the key components:</p>
</section>
<section id="intial-setup" class="level1">
<h1>Intial Setup</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyAML)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidymodels)</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(multilevelmod)</span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(earth)</span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(randomForest)</span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rpart)</span>
<span id="cb2-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lightgbm)</span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(baguette)</span>
<span id="cb2-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(bonsai)</span>
<span id="cb2-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gee)</span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidymodels_prefer</span>()</span></code></pre></div>
</div>
<section id="setting-up-the-recipe" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-the-recipe">Setting Up the Recipe</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mtcars</span>
<span id="cb3-2">recipe <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df)</span></code></pre></div>
</div>
<p>In this snippet, we’re creating a recipe for our regression analysis. The response variable (<code>mpg</code>) is modeled against all other variables in the <code>mtcars</code> dataset.</p>
</section>
<section id="fast-regression-with-tidyaml" class="level2">
<h2 class="anchored" data-anchor-id="fast-regression-with-tidyaml">Fast Regression with TidyAML</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">fr_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fast_regression</span>(</span>
<span id="cb4-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.data =</span> df,</span>
<span id="cb4-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.rec_obj =</span> recipe,</span>
<span id="cb4-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_fns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mars"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bag_mars"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rand_forest"</span>,</span>
<span id="cb4-5">                   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"boost_tree"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bag_tree"</span>),</span>
<span id="cb4-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_eng =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gee"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gls"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"earth"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rpart"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgbm"</span>)</span>
<span id="cb4-7">)</span></code></pre></div>
</div>
<p>This is where the magic happens. The <code>fast_regression</code> function performs regression using various modeling functions (<code>linear_reg</code>, <code>mars</code>, etc.) and engines (<code>lm</code>, <code>gee</code>, etc.) specified. It’s a versatile approach to quickly explore different models.</p>
</section>
<section id="visualizing-residuals" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-residuals">Visualizing Residuals</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">fr_tbl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">res =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(fitted_wflw, \(x) x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-3">                     broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> df))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unnest</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> res) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pfe =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(.parsnip_engine, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" - "</span>, .parsnip_fns)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.res =</span> mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> .pred) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> pfe, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .res, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> pfe)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals by Fitted Model"</span>,</span>
<span id="cb5-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals are mpg - .pred"</span>,</span>
<span id="cb5-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model"</span>,</span>
<span id="cb5-13">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals"</span>,</span>
<span id="cb5-14">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Engine + Function"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-08/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This block of code generates a boxplot visualizing residuals by model. Residuals are the differences between observed and predicted values. The plot helps you assess how well your models are performing.</p>
</section>
</section>
<section id="try-it-yourself" class="level1">
<h1>Try It Yourself!</h1>
<p>Now that you’ve seen the power of tidyAML in action, it’s time to try it yourself. Install the package, load your data, and adapt the script to your specific use case. TidyAML provides a clean and efficient way to explore different regression models, making your analysis more manageable and insightful.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyAML"</span>)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyAML)</span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Your data loading and analysis code here</span></span></code></pre></div>
<p>Happy coding, and may your regression analyses be tidy and insightful!</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-12-08/index.html</guid>
  <pubDate>Fri, 08 Dec 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Unraveling Patterns: A Step-by-Step Guide to Piecewise Regression in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-12-07/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hey there, fellow R enthusiasts! Today, let’s embark on a fascinating journey into the realm of piecewise regression using R. If you’ve ever wondered how to uncover hidden trends and breakpoints in your data, you’re in for a treat. Buckle up, and let’s dive into the world of piecewise regression!</p>
</section>
<section id="piecewise-regression" class="level1">
<h1>Piecewise Regression</h1>
<p>Piecewise regression is a powerful technique that allows us to model distinct segments of a dataset with different linear relationships. It’s like fitting multiple straight lines to capture the nuances of different regions in your data. So, grab your virtual lab coat, and let’s get started.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<section id="step-1-load-your-data-and-libraries" class="level2">
<h2 class="anchored" data-anchor-id="step-1-load-your-data-and-libraries">Step 1: Load Your Data and Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install and load necessary packages</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("segmented")</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(segmented)</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample data</span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb1-7">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-8">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmax</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmax</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine data</span></span>
<span id="cb1-11">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(x, y)</span></code></pre></div>
</div>
</section>
<section id="step-2-explore-your-data" class="level2">
<h2 class="anchored" data-anchor-id="step-2-explore-your-data">Step 2: Explore Your Data</h2>
<p>Before diving into the regression, let’s take a peek at our data. Visualizing the data often provides insights into potential breakpoints.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scatter plot to visualize the data</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb2-3">  data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, </span>
<span id="cb2-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scatter Plot of Your Data"</span>,</span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Independent Variable (x)"</span>, </span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dependent Variable (y)"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-07/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="step-3-perform-piecewise-regression" class="level2">
<h2 class="anchored" data-anchor-id="step-3-perform-piecewise-regression">Step 3: Perform Piecewise Regression</h2>
<p>Now, the exciting part! Let’s fit our piecewise regression model using the <code>segmented</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit the piecewise regression model</span></span>
<span id="cb3-2">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data)</span>
<span id="cb3-3">segmented_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">segmented</span>(model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seg.Z =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>x)</span></code></pre></div>
</div>
</section>
<section id="step-4-visualize-the-results" class="level2">
<h2 class="anchored" data-anchor-id="step-4-visualize-the-results">Step 4: Visualize the Results:</h2>
<p>To truly understand the magic happening, let’s visualize the fitted model and residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">seg_preds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(segmented_model)</span>
<span id="cb4-2">seg_res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> seg_preds</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the original data with the fitted model</span></span>
<span id="cb4-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb4-6">  data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y,</span>
<span id="cb4-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Piecewise Regression Fit"</span>,</span>
<span id="cb4-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Independent Variable (x)"</span>,</span>
<span id="cb4-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dependent Variable (y)"</span>,</span>
<span id="cb4-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span></span>
<span id="cb4-11">)</span>
<span id="cb4-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, seg_preds,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-07/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot residuals</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the residuals for each segment</span></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(x, seg_res, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals"</span>)</span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-07/index_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="step-5-interpret-the-breakpoints" class="level2">
<h2 class="anchored" data-anchor-id="step-5-interpret-the-breakpoints">Step 5: Interpret the Breakpoints:</h2>
<p>Inspecting the segmented model will reveal the breakpoints and the corresponding regression lines. It’s like deciphering the story your data is trying to tell.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View breakpoints and coefficients</span></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(segmented_model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    ***Regression Model with Segmented Relationship(s)***

Call: 
segmented.lm(obj = model, seg.Z = ~x)

Estimated Break-Point(s):
          Est. St.Err
psi1.x 24.757  3.074

Coefficients of the linear terms:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  2.49825    2.55867   0.976    0.331
x           -0.04055    0.17907  -0.226    0.821
U1.x         0.93569    0.18186   5.145       NA

Residual standard error: 6.073 on 96 degrees of freedom
Multiple R-Squared: 0.9333,  Adjusted R-squared: 0.9312 

Boot restarting based on 6 samples. Last fit:
Convergence attained in 2 iterations (rel. change 2.9855e-12)</code></pre>
</div>
</div>
</section>
<section id="step-6-encourage-exploration" class="level2">
<h2 class="anchored" data-anchor-id="step-6-encourage-exploration">Step 6: Encourage Exploration:</h2>
<p>Now that you’ve conquered piecewise regression, encourage your fellow data explorers to try it themselves. Challenge them to apply this technique to their datasets and share their insights.</p>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Congratulations, you’ve just unlocked the power of piecewise regression in R! By visualizing data, fitting models, and exploring breakpoints, you’ve gained a valuable tool for understanding complex relationships. Keep coding, keep exploring, and stay curious!</p>
<p>Happy coding, and may your data always reveal its secrets!</p>
<p>Steven P. Sanderson II, MPH</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-12-07/index.html</guid>
  <pubDate>Thu, 07 Dec 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>A Complete Guide to Stepwise Regression in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-12-06/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Stepwise regression is a powerful technique used to build predictive models by iteratively adding or removing variables based on statistical criteria. In R, this can be achieved using functions like <code>step()</code> or manually with forward and backward selection.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<section id="forward-stepwise-regression" class="level2">
<h2 class="anchored" data-anchor-id="forward-stepwise-regression">Forward Stepwise Regression:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize an empty model</span></span>
<span id="cb1-2">forward_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward stepwise regression</span></span>
<span id="cb1-5">forward_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step</span>(forward_model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"forward"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scope =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">formula</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=70.9
mpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb</code></pre>
</div>
</div>
<p>In simple terms, we start with a model containing no predictors (<code>mpg ~ 1</code>) and iteratively add the most statistically significant variables until no improvement is observed.</p>
</section>
<section id="backward-stepwise-regression" class="level2">
<h2 class="anchored" data-anchor-id="backward-stepwise-regression">Backward Stepwise Regression:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize a model with all predictors</span></span>
<span id="cb3-2">backward_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward stepwise regression</span></span>
<span id="cb3-5">backward_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step</span>(backward_model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"backward"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=70.9
mpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb

       Df Sum of Sq    RSS    AIC
- cyl   1    0.0799 147.57 68.915
- vs    1    0.1601 147.66 68.932
- carb  1    0.4067 147.90 68.986
- gear  1    1.3531 148.85 69.190
- drat  1    1.6270 149.12 69.249
- disp  1    3.9167 151.41 69.736
- hp    1    6.8399 154.33 70.348
- qsec  1    8.8641 156.36 70.765
&lt;none&gt;              147.49 70.898
- am    1   10.5467 158.04 71.108
- wt    1   27.0144 174.51 74.280

Step:  AIC=68.92
mpg ~ disp + hp + drat + wt + qsec + vs + am + gear + carb

       Df Sum of Sq    RSS    AIC
- vs    1    0.2685 147.84 66.973
- carb  1    0.5201 148.09 67.028
- gear  1    1.8211 149.40 67.308
- drat  1    1.9826 149.56 67.342
- disp  1    3.9009 151.47 67.750
- hp    1    7.3632 154.94 68.473
&lt;none&gt;              147.57 68.915
- qsec  1   10.0933 157.67 69.032
- am    1   11.8359 159.41 69.384
- wt    1   27.0280 174.60 72.297

Step:  AIC=66.97
mpg ~ disp + hp + drat + wt + qsec + am + gear + carb

       Df Sum of Sq    RSS    AIC
- carb  1    0.6855 148.53 65.121
- gear  1    2.1437 149.99 65.434
- drat  1    2.2139 150.06 65.449
- disp  1    3.6467 151.49 65.753
- hp    1    7.1060 154.95 66.475
&lt;none&gt;              147.84 66.973
- am    1   11.5694 159.41 67.384
- qsec  1   15.6830 163.53 68.200
- wt    1   27.3799 175.22 70.410

Step:  AIC=65.12
mpg ~ disp + hp + drat + wt + qsec + am + gear

       Df Sum of Sq    RSS    AIC
- gear  1     1.565 150.09 63.457
- drat  1     1.932 150.46 63.535
&lt;none&gt;              148.53 65.121
- disp  1    10.110 158.64 65.229
- am    1    12.323 160.85 65.672
- hp    1    14.826 163.35 66.166
- qsec  1    26.408 174.94 68.358
- wt    1    69.127 217.66 75.350

Step:  AIC=63.46
mpg ~ disp + hp + drat + wt + qsec + am

       Df Sum of Sq    RSS    AIC
- drat  1     3.345 153.44 62.162
- disp  1     8.545 158.64 63.229
&lt;none&gt;              150.09 63.457
- hp    1    13.285 163.38 64.171
- am    1    20.036 170.13 65.466
- qsec  1    25.574 175.67 66.491
- wt    1    67.572 217.66 73.351

Step:  AIC=62.16
mpg ~ disp + hp + wt + qsec + am

       Df Sum of Sq    RSS    AIC
- disp  1     6.629 160.07 61.515
&lt;none&gt;              153.44 62.162
- hp    1    12.572 166.01 62.682
- qsec  1    26.470 179.91 65.255
- am    1    32.198 185.63 66.258
- wt    1    69.043 222.48 72.051

Step:  AIC=61.52
mpg ~ hp + wt + qsec + am

       Df Sum of Sq    RSS    AIC
- hp    1     9.219 169.29 61.307
&lt;none&gt;              160.07 61.515
- qsec  1    20.225 180.29 63.323
- am    1    25.993 186.06 64.331
- wt    1    78.494 238.56 72.284

Step:  AIC=61.31
mpg ~ wt + qsec + am

       Df Sum of Sq    RSS    AIC
&lt;none&gt;              169.29 61.307
- am    1    26.178 195.46 63.908
- qsec  1   109.034 278.32 75.217
- wt    1   183.347 352.63 82.790</code></pre>
</div>
</div>
<p>Here, we begin with a model including all predictors and iteratively remove the least statistically significant variables until the model no longer improves.</p>
</section>
<section id="both-direction-stepwise-regression" class="level2">
<h2 class="anchored" data-anchor-id="both-direction-stepwise-regression">Both-Direction Stepwise Regression:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize a model with all predictors</span></span>
<span id="cb5-2">both_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Both-direction stepwise regression</span></span>
<span id="cb5-5">both_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step</span>(both_model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=70.9
mpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb

       Df Sum of Sq    RSS    AIC
- cyl   1    0.0799 147.57 68.915
- vs    1    0.1601 147.66 68.932
- carb  1    0.4067 147.90 68.986
- gear  1    1.3531 148.85 69.190
- drat  1    1.6270 149.12 69.249
- disp  1    3.9167 151.41 69.736
- hp    1    6.8399 154.33 70.348
- qsec  1    8.8641 156.36 70.765
&lt;none&gt;              147.49 70.898
- am    1   10.5467 158.04 71.108
- wt    1   27.0144 174.51 74.280

Step:  AIC=68.92
mpg ~ disp + hp + drat + wt + qsec + vs + am + gear + carb

       Df Sum of Sq    RSS    AIC
- vs    1    0.2685 147.84 66.973
- carb  1    0.5201 148.09 67.028
- gear  1    1.8211 149.40 67.308
- drat  1    1.9826 149.56 67.342
- disp  1    3.9009 151.47 67.750
- hp    1    7.3632 154.94 68.473
&lt;none&gt;              147.57 68.915
- qsec  1   10.0933 157.67 69.032
- am    1   11.8359 159.41 69.384
+ cyl   1    0.0799 147.49 70.898
- wt    1   27.0280 174.60 72.297

Step:  AIC=66.97
mpg ~ disp + hp + drat + wt + qsec + am + gear + carb

       Df Sum of Sq    RSS    AIC
- carb  1    0.6855 148.53 65.121
- gear  1    2.1437 149.99 65.434
- drat  1    2.2139 150.06 65.449
- disp  1    3.6467 151.49 65.753
- hp    1    7.1060 154.95 66.475
&lt;none&gt;              147.84 66.973
- am    1   11.5694 159.41 67.384
- qsec  1   15.6830 163.53 68.200
+ vs    1    0.2685 147.57 68.915
+ cyl   1    0.1883 147.66 68.932
- wt    1   27.3799 175.22 70.410

Step:  AIC=65.12
mpg ~ disp + hp + drat + wt + qsec + am + gear

       Df Sum of Sq    RSS    AIC
- gear  1     1.565 150.09 63.457
- drat  1     1.932 150.46 63.535
&lt;none&gt;              148.53 65.121
- disp  1    10.110 158.64 65.229
- am    1    12.323 160.85 65.672
- hp    1    14.826 163.35 66.166
+ carb  1     0.685 147.84 66.973
+ vs    1     0.434 148.09 67.028
+ cyl   1     0.414 148.11 67.032
- qsec  1    26.408 174.94 68.358
- wt    1    69.127 217.66 75.350

Step:  AIC=63.46
mpg ~ disp + hp + drat + wt + qsec + am

       Df Sum of Sq    RSS    AIC
- drat  1     3.345 153.44 62.162
- disp  1     8.545 158.64 63.229
&lt;none&gt;              150.09 63.457
- hp    1    13.285 163.38 64.171
+ gear  1     1.565 148.53 65.121
+ cyl   1     1.003 149.09 65.242
+ vs    1     0.645 149.45 65.319
+ carb  1     0.107 149.99 65.434
- am    1    20.036 170.13 65.466
- qsec  1    25.574 175.67 66.491
- wt    1    67.572 217.66 73.351

Step:  AIC=62.16
mpg ~ disp + hp + wt + qsec + am

       Df Sum of Sq    RSS    AIC
- disp  1     6.629 160.07 61.515
&lt;none&gt;              153.44 62.162
- hp    1    12.572 166.01 62.682
+ drat  1     3.345 150.09 63.457
+ gear  1     2.977 150.46 63.535
+ cyl   1     2.447 150.99 63.648
+ vs    1     1.121 152.32 63.927
+ carb  1     0.011 153.43 64.160
- qsec  1    26.470 179.91 65.255
- am    1    32.198 185.63 66.258
- wt    1    69.043 222.48 72.051

Step:  AIC=61.52
mpg ~ hp + wt + qsec + am

       Df Sum of Sq    RSS    AIC
- hp    1     9.219 169.29 61.307
&lt;none&gt;              160.07 61.515
+ disp  1     6.629 153.44 62.162
+ carb  1     3.227 156.84 62.864
+ drat  1     1.428 158.64 63.229
- qsec  1    20.225 180.29 63.323
+ cyl   1     0.249 159.82 63.465
+ vs    1     0.249 159.82 63.466
+ gear  1     0.171 159.90 63.481
- am    1    25.993 186.06 64.331
- wt    1    78.494 238.56 72.284

Step:  AIC=61.31
mpg ~ wt + qsec + am

       Df Sum of Sq    RSS    AIC
&lt;none&gt;              169.29 61.307
+ hp    1     9.219 160.07 61.515
+ carb  1     8.036 161.25 61.751
+ disp  1     3.276 166.01 62.682
+ cyl   1     1.501 167.78 63.022
+ drat  1     1.400 167.89 63.042
+ gear  1     0.123 169.16 63.284
+ vs    1     0.000 169.29 63.307
- am    1    26.178 195.46 63.908
- qsec  1   109.034 278.32 75.217
- wt    1   183.347 352.63 82.790</code></pre>
</div>
</div>
<p>In both-direction regression, the algorithm combines both forward and backward steps, optimizing the model by adding significant variables and removing insignificant ones.</p>
<section id="visualizing-data-and-model-fit" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-data-and-model-fit">Visualizing Data and Model Fit:</h4>
<p>Now, let’s visualize the data and model fit using base R plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scatter plot of mpg vs. hp</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp, mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg, </span>
<span id="cb7-3">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scatter Plot of mpg vs. hp"</span>, </span>
<span id="cb7-4">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hp"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mpg"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb7-5">     )</span>
<span id="cb7-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">points</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp), forward_model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fitted.values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb7-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">points</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp), backward_model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fitted.values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb7-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">points</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp), both_model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fitted.values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb7-10"></span>
<span id="cb7-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topright"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Forward"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Backward"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Both-Direction"</span>), </span>
<span id="cb7-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-06/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This plot displays the scatter plot of <code>mpg</code> against <code>hp</code> with fitted lines for each stepwise regression. The colors correspond to the models created earlier.</p>
</section>
<section id="visualizing-residuals" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-residuals">Visualizing Residuals:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Residual plots for each model</span></span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward stepwise regression residuals</span></span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(forward_model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>residuals, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Forward Residuals"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals"</span>)</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward stepwise regression residuals</span></span>
<span id="cb8-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(backward_model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>residuals, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Backward Residuals"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals"</span>)</span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Both-direction stepwise regression residuals</span></span>
<span id="cb8-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(both_model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>residuals, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Both-Direction Residuals"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-06/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These plots help assess how well the models fit the data by examining the residuals.</p>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Stepwise regression is a valuable tool, but it’s crucial to interpret results cautiously and be aware of potential pitfalls.</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-12-06/index.html</guid>
  <pubDate>Wed, 06 Dec 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Unveiling the Magic of Polynomial Regression in R: A Step-by-Step Guide</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-12-05/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hey folks! 👋 Today, let’s embark on a coding adventure and explore the fascinating world of Polynomial Regression in R. Whether you’re new to R or a seasoned coder, we’re going to break down the complexities and make this journey enjoyable and insightful.</p>
</section>
<section id="what-is-polynomial-regression" class="level1">
<h1>What is Polynomial Regression?</h1>
<p>At its core, Polynomial Regression is an extension of linear regression, allowing us to capture more complex relationships between variables. It’s like upgrading from a straight road to a curvy one, better accommodating the twists and turns of our data.</p>
</section>
<section id="lets-dive-in" class="level1">
<h1>Let’s Dive In!</h1>
<section id="step-1-set-the-stage" class="level2">
<h2 class="anchored" data-anchor-id="step-1-set-the-stage">Step 1: Set the Stage</h2>
<p>First things first, fire up your RStudio and load your favorite dataset. For our journey, I’ll use a hypothetical dataset about, say, the growth of healthyR packages over the years.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assume 'years' and 'growth' are our dataset columns</span></span>
<span id="cb1-2">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">years =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb1-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">growth =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>))</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize the data</span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>years, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>growth, </span>
<span id="cb1-7">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HealthyR Package Growth Over the Years"</span>,</span>
<span id="cb1-8">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Years"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Growth"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-05/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="step-2-lets-fit-a-polynomial" class="level2">
<h2 class="anchored" data-anchor-id="step-2-lets-fit-a-polynomial">Step 2: Let’s Fit a Polynomial</h2>
<p>Now, let’s fit a polynomial regression model to our data. We’ll use the <code>lm()</code> function, and don’t worry, it’s simpler than it sounds!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit a polynomial regression model (let's go quadratic)</span></span>
<span id="cb2-2">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(growth <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poly</span>(years, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data)</span></code></pre></div>
</div>
</section>
<section id="step-3-visualize-the-magic" class="level2">
<h2 class="anchored" data-anchor-id="step-3-visualize-the-magic">Step 3: Visualize the Magic</h2>
<p>Time to visualize the results. We’ll create a smooth curve representing our polynomial fit, compare it against the actual data, and also peek at the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate points for smooth curve</span></span>
<span id="cb3-2">curve_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">years =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>))</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Predict growth based on the model</span></span>
<span id="cb3-5">predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> curve_data)</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The data</span></span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>years, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>growth, </span>
<span id="cb3-9">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HealthyR Package Growth Over the Years"</span>,</span>
<span id="cb3-10">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Years"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Growth"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize the fitted model</span></span>
<span id="cb3-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(curve_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>years, predictions, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-05/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="step-4-assess-residuals" class="level2">
<h2 class="anchored" data-anchor-id="step-4-assess-residuals">Step 4: Assess Residuals</h2>
<p>To ensure our model is doing its job, let’s examine the residuals. These are the differences between our predictions and the actual values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate residuals</span></span>
<span id="cb4-2">residuals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">residuals</span>(model)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize the residuals</span></span>
<span id="cb4-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>years, residuals, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals Analysis"</span>,</span>
<span id="cb4-6">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Years"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span>
<span id="cb4-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-05/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="conclusion-try-it-yourself" class="level1">
<h1>Conclusion: Try It Yourself!</h1>
<p>There you have it—a whirlwind tour of Polynomial Regression in R using base R for visuals! I encourage you to take the wheel and try it on your own datasets. Adjust the degree of your polynomial, explore different visualizations, and let the data unveil its secrets.</p>
<p>Remember, coding is an adventure, and each line is a step into the unknown. Happy coding! 🚀</p>
<p>Feel free to reach out if you have any questions or want to share your coding escapades. Until next time, happy data wrangling!</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-12-05/index.html</guid>
  <pubDate>Tue, 05 Dec 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Understanding Spline Regression</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-12-04/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Spline regression is particularly useful when the relationship between the independent and dependent variables is not adequately captured by a linear model. It involves fitting a piecewise continuous curve (spline) to the data. Let’s dive into the process using R.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<section id="step-1-load-the-necessary-libraries" class="level2">
<h2 class="anchored" data-anchor-id="step-1-load-the-necessary-libraries">Step 1: Load the Necessary Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install and load the required libraries</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("splines")</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(splines)</span></code></pre></div>
</div>
</section>
<section id="step-2-generate-sample-data" class="level2">
<h2 class="anchored" data-anchor-id="step-2-generate-sample-data">Step 2: Generate Sample Data</h2>
<p>For our example, let’s create a hypothetical dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate sample data</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb2-3">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb2-4">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span></code></pre></div>
</div>
</section>
<section id="step-3-fit-a-spline-regression-model" class="level2">
<h2 class="anchored" data-anchor-id="step-3-fit-a-spline-regression-model">Step 3: Fit a Spline Regression Model</h2>
<p>Now, let’s fit a spline regression model to our data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit a spline regression model</span></span>
<span id="cb3-2">spline_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ns</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
</div>
<p>Here, <code>ns</code> from the <code>splines</code> package is used to create a natural spline basis with 4 degrees of freedom.</p>
</section>
<section id="step-4-visualize-the-results" class="level2">
<h2 class="anchored" data-anchor-id="step-4-visualize-the-results">Step 4: Visualize the Results</h2>
<p>Visualizing the data and the fitted spline is crucial for understanding the model’s performance:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize the data and fitted spline</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spline Regression Example"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>)</span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(x, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(spline_model), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topright"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fitted Spline"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-04/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This code generates a plot with the original data points and overlays the fitted spline.</p>
</section>
<section id="step-5-examine-residuals" class="level2">
<h2 class="anchored" data-anchor-id="step-5-examine-residuals">Step 5: Examine Residuals</h2>
<p>Checking residuals helps assess the model’s goodness of fit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Examine residuals</span></span>
<span id="cb5-2">residuals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">residuals</span>(spline_model)</span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(x, residuals, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals of Spline Regression"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>, </span>
<span id="cb5-4">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals"</span>)</span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-12-04/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This plot shows the residuals (the differences between observed and predicted values) against the independent variable.</p>
</section>
</section>
<section id="you-try" class="level1">
<h1>You Try!</h1>
<p>Now that you’ve seen the basics, I encourage you to try spline regression on your own datasets. Experiment with different degrees of freedom (<code>df</code> parameter) in the <code>ns</code> function to observe how it affects the fit.</p>
<p>Remember, the power of spline regression lies in its ability to capture complex patterns in your data. Don’t hesitate to tweak the code and visualize the results to gain a deeper understanding.</p>
<p>Feel free to share your experiences or ask questions in the comments. Happy coding!</p>
<p>That wraps up our journey into spline regression in R. I hope you found this tutorial helpful and inspiring for your data analysis endeavors.</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-12-04/index.html</guid>
  <pubDate>Mon, 04 Dec 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>tidyAML: Now supporting gee models</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-12-01/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>I am happy to announce that a new version of <code>tidyAML</code> is now available on CRAN. This version includes support for <code>gee</code> models. This is a big step forward for <code>tidyAML</code> as it now supports a wide variety of regression and classification models.</p>
</section>
<section id="what-is-tidyaml" class="level1">
<h1>What is <code>tidyAML</code>?</h1>
<p>The package is meant to be a way to quickly create many models of different algorithms, and this release is a small step forward in supporting that mission. The package is built upon the <code>tidymodels</code> packages.</p>
</section>
<section id="what-is-gee" class="level1">
<h1>What is <code>gee</code>?</h1>
<p><code>gee</code> stands for Generalized Estimating Equations. It is a way to model correlated data. For example, if you have a dataset where you have multiple observations per person, you may want to use <code>gee</code> to account for the correlation between observations within a person. This is a very common situation in longitudinal studies. Here is <a href="https://parsnip.tidymodels.org/reference/details_linear_reg_gee.html?q=gee#null">a link</a> to the <code>gee</code> parsnip model.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>Let’s see how it works, we will examine how it is setup to faily gracefully and how it works when the <code>multilevelmod</code> package is installed and loaded into your environment.</p>
<section id="load-library" class="level2">
<h2 class="anchored" data-anchor-id="load-library">Load Library</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyAML)</span></code></pre></div>
</div>
<p>Now, let’s build a model that will fail, it’s important I think to see the failure message so you can understand what is happening. It’s likely because the library is not loaded, let’s face it, it has happened to all of us.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(recipes)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb2-3"></span>
<span id="cb2-4">rec_obj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span>
<span id="cb2-5">frt_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fast_regression</span>(</span>
<span id="cb2-6">  mtcars, </span>
<span id="cb2-7">  rec_obj, </span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_eng =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gee"</span>),</span>
<span id="cb2-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_fns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span></span>
<span id="cb2-10">)</span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(frt_tbl)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3
Columns: 8
$ .model_id       &lt;int&gt; 1, 2, 3
$ .parsnip_engine &lt;chr&gt; "lm", "gee", "glm"
$ .parsnip_mode   &lt;chr&gt; "regression", "regression", "regression"
$ .parsnip_fns    &lt;chr&gt; "linear_reg", "linear_reg", "linear_reg"
$ model_spec      &lt;list&gt; [~NULL, ~NULL, NULL, regression, TRUE, NULL, lm, TRUE]…
$ wflw            &lt;list&gt; [cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb, mp…
$ fitted_wflw     &lt;list&gt; [cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb, mp…
$ pred_wflw       &lt;list&gt; [&lt;tbl_df[8 x 1]&gt;], &lt;NULL&gt;, [&lt;tbl_df[8 x 1]&gt;]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">frt_tbl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(pred_wflw) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 8 × 1
  .pred
  &lt;dbl&gt;
1 22.9 
2 18.0 
3 21.1 
4 32.9 
5 18.5 
6 10.4 
7  9.59
8 24.7 

[[2]]
NULL

[[3]]
# A tibble: 8 × 1
  .pred
  &lt;dbl&gt;
1 22.9 
2 18.0 
3 21.1 
4 32.9 
5 18.5 
6 10.4 
7  9.59
8 24.7 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">frt_tbl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(fitted_wflw) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>tidy)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 11 × 5
   term         estimate std.error statistic p.value
   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 (Intercept) -40.3       30.5       -1.32   0.209 
 2 cyl           0.907      1.09       0.830  0.421 
 3 disp          0.0105     0.0189     0.557  0.587 
 4 hp           -0.00487    0.0248    -0.196  0.847 
 5 drat          1.73       2.04       0.846  0.413 
 6 wt           -5.71       2.35      -2.43   0.0302
 7 qsec          3.39       1.34       2.54   0.0248
 8 vs           -3.85       2.99      -1.29   0.220 
 9 am            2.16       2.29       0.942  0.364 
10 gear          1.40       1.68       0.838  0.417 
11 carb          0.200      0.835      0.239  0.815 

[[2]]
# A tibble: 0 × 0

[[3]]
# A tibble: 11 × 5
   term         estimate std.error statistic p.value
   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 (Intercept) -40.3       30.5       -1.32   0.209 
 2 cyl           0.907      1.09       0.830  0.421 
 3 disp          0.0105     0.0189     0.557  0.587 
 4 hp           -0.00487    0.0248    -0.196  0.847 
 5 drat          1.73       2.04       0.846  0.413 
 6 wt           -5.71       2.35      -2.43   0.0302
 7 qsec          3.39       1.34       2.54   0.0248
 8 vs           -3.85       2.99      -1.29   0.220 
 9 am            2.16       2.29       0.942  0.364 
10 gear          1.40       1.68       0.838  0.417 
11 carb          0.200      0.835      0.239  0.815 </code></pre>
</div>
</div>
<p>We see that the <code>gee</code> model failed. This is because we did not load the <code>multilevelmod</code> package. Let’s load it and try again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(multilevelmod)</span>
<span id="cb8-2"></span>
<span id="cb8-3">frt_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fast_regression</span>(</span>
<span id="cb8-4">  mtcars, </span>
<span id="cb8-5">  rec_obj, </span>
<span id="cb8-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_eng =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gee"</span>),</span>
<span id="cb8-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.parsnip_fns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_reg"</span></span>
<span id="cb8-8">)</span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(frt_tbl)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3
Columns: 8
$ .model_id       &lt;int&gt; 1, 2, 3
$ .parsnip_engine &lt;chr&gt; "lm", "gee", "glm"
$ .parsnip_mode   &lt;chr&gt; "regression", "regression", "regression"
$ .parsnip_fns    &lt;chr&gt; "linear_reg", "linear_reg", "linear_reg"
$ model_spec      &lt;list&gt; [~NULL, ~NULL, NULL, regression, TRUE, NULL, lm, TRUE]…
$ wflw            &lt;list&gt; [cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb, mp…
$ fitted_wflw     &lt;list&gt; [cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb, mp…
$ pred_wflw       &lt;list&gt; [&lt;tbl_df[8 x 1]&gt;], [&lt;tbl_df[8 x 1]&gt;], [&lt;tbl_df[8 x 1]&gt;…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">frt_tbl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(pred_wflw) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 8 × 1
  .pred
  &lt;dbl&gt;
1  20.6
2  15.6
3  15.8
4  26.1
5  27.8
6  16.6
7  25.4
8  21.6

[[2]]
# A tibble: 8 × 1
  .pred
  &lt;dbl&gt;
1  21.3
2  15.2
3  15.3
4  25.7
5  27.3
6  16.5
7  25.7
8  20.5

[[3]]
# A tibble: 8 × 1
  .pred
  &lt;dbl&gt;
1  20.6
2  15.6
3  15.8
4  26.1
5  27.8
6  16.6
7  25.4
8  21.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">frt_tbl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(fitted_wflw) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>tidy)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 11 × 5
   term        estimate std.error statistic p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 (Intercept) -3.70      18.9       -0.195  0.848 
 2 cyl          0.668      1.03       0.647  0.529 
 3 disp         0.00831    0.0153     0.544  0.596 
 4 hp          -0.0124     0.0173    -0.717  0.486 
 5 drat         2.87       1.44       2.00   0.0674
 6 wt          -2.87       1.40      -2.05   0.0609
 7 qsec         0.777      0.618      1.26   0.231 
 8 vs           0.169      1.64       0.103  0.920 
 9 am           1.90       1.79       1.07   0.306 
10 gear         1.31       1.44       0.907  0.381 
11 carb        -0.601      0.730     -0.823  0.425 

[[2]]
# A tibble: 10 × 6
   term         estimate std.error statistic p.value        ``
   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)  6.54       10.2     0.643     4.01    1.63    
 2 disp         0.0119      0.0140  0.849     0.0134  0.887   
 3 hp          -0.0149      0.0165 -0.901     0.0104 -1.43    
 4 drat         2.36        1.18    2.01      0.859   2.75    
 5 wt          -3.01        1.35   -2.23      1.35   -2.23    
 6 qsec         0.577       0.524   1.10      0.193   2.99    
 7 vs           0.000922    1.58    0.000582  1.07    0.000860
 8 am           1.35        1.54    0.880     0.886   1.53    
 9 gear         1.00        1.33    0.752     0.527   1.90    
10 carb        -0.355       0.611  -0.582     0.378  -0.940   

[[3]]
# A tibble: 11 × 5
   term        estimate std.error statistic p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 (Intercept) -3.70      18.9       -0.195  0.848 
 2 cyl          0.668      1.03       0.647  0.529 
 3 disp         0.00831    0.0153     0.544  0.596 
 4 hp          -0.0124     0.0173    -0.717  0.486 
 5 drat         2.87       1.44       2.00   0.0674
 6 wt          -2.87       1.40      -2.05   0.0609
 7 qsec         0.777      0.618      1.26   0.231 
 8 vs           0.169      1.64       0.103  0.920 
 9 am           1.90       1.79       1.07   0.306 
10 gear         1.31       1.44       0.907  0.381 
11 carb        -0.601      0.730     -0.823  0.425 </code></pre>
</div>
</div>
</section>
</section>
<section id="the-recipe-object" class="level1">
<h1>The recipe object</h1>
<p>Let’s take a look at the model spec, the workflow and the fitted workflow to see what has happened behind the scenes. First let’s look at the formula in the recipe object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">formula</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prep</span>(rec_obj))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb
&lt;environment: 0x0000012c521f0c98&gt;</code></pre>
</div>
</div>
<p>So we see what the formula is, but we also see that there is no <code>id_var</code> listed which means it would fail for the <code>gee</code> specification, but, our model worked! That is because behind the scenes in the fast sense at this point in development the first variable is taken to be the id variable. Let’s see what the workflow looks like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">gee_wflw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> frt_tbl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(wflw)</span>
<span id="cb16-2"></span>
<span id="cb16-3">gee_wflw[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>actions<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>formula</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mpg ~ id_var(cyl) + disp + hp + drat + wt + qsec + vs + am + 
    gear + carb
&lt;environment: 0x0000012c5206d0f8&gt;</code></pre>
</div>
</div>
<p>As we can see the first predictor variable has been chosen as the id variable. This will change in the future, where you will be able to choose the <code>id_var</code>.</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Thank you for reading and I hope you enjoy the new version of <code>tidyAML</code>. Please let me know if you have any questions or comments. We will continue our development of <code>tidyAML</code> and hope to have more updates soon.</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>tidyaml</category>
  <category>regression</category>
  <category>classification</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-12-01/index.html</guid>
  <pubDate>Fri, 01 Dec 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Navigating Quantile Regression with R: A Comprehensive Guide</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-11-29/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Quantile regression is a robust statistical method that goes beyond traditional linear regression by allowing us to model the relationship between variables at different quantiles of the response distribution. In this blog post, we’ll explore how to perform quantile regression in R using the quantreg library.</p>
</section>
<section id="setting-the-stage" class="level1">
<h1>Setting the Stage</h1>
<p>First things first, let’s create some data to work with. We’ll generate a data frame <code>df</code> with two variables: ‘hours’ and ‘score’. The relationship between ‘hours’ and ‘score’ will have a bit of noise to make things interesting.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create data frame</span></span>
<span id="cb1-2">hours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb1-3">score <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> hours <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> hours)</span>
<span id="cb1-4">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(hours, score)</span></code></pre></div>
</div>
</section>
<section id="visualizing-the-data" class="level1">
<h1>Visualizing the Data</h1>
<p>Before we jump into regression, it’s always a good idea to visualize our data. Let’s start with a scatter plot to get a sense of the relationship between hours and scores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scatter plot</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hours, df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>score, </span>
<span id="cb2-3">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scatter Plot of Hours vs. Score"</span>, </span>
<span id="cb2-4">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hours"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Score"</span></span>
<span id="cb2-5">     )</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-29/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now that we’ve got a clear picture of our data, it’s time to perform quantile regression.</p>
</section>
<section id="quantile-regression-with-quantreg" class="level1">
<h1>Quantile Regression with quantreg</h1>
<p>We’ll use the <code>quantreg</code> library to perform quantile regression. The key function here is <code>rq()</code> (Quantile Regression). We’ll run quantile regression for a few quantiles, say 0.25, 0.5, and 0.75.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install and load quantreg if not already installed</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("quantreg")</span></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(quantreg)</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Quantile regression</span></span>
<span id="cb3-6">quant_reg_25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rq</span>(score <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hours, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tau =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)</span>
<span id="cb3-7">quant_reg_50 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rq</span>(score <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hours, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tau =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb3-8">quant_reg_75 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rq</span>(score <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hours, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tau =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)</span>
<span id="cb3-9"></span>
<span id="cb3-10">purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(quant_reg_25, quant_reg_50, quant_reg_75), broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>tidy)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 2 × 5
  term        estimate conf.low conf.high   tau
  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 (Intercept)    60.3     59.0      61.1   0.25
2 hours           1.56     1.33      1.82  0.25

[[2]]
# A tibble: 2 × 5
  term        estimate conf.low conf.high   tau
  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 (Intercept)    60.2     59.6      60.5    0.5
2 hours           1.96     1.86      2.20   0.5

[[3]]
# A tibble: 2 × 5
  term        estimate conf.low conf.high   tau
  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 (Intercept)    59.9     59.5      60.7   0.75
2 hours           2.36     2.16      2.53  0.75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(quant_reg_25, quant_reg_50, quant_reg_75), broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>glance)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 1 × 5
    tau logLik      AIC   BIC df.residual
  &lt;dbl&gt; &lt;logLik&gt;  &lt;dbl&gt; &lt;dbl&gt;       &lt;int&gt;
1  0.25 -259.6364  523.  528.          98

[[2]]
# A tibble: 1 × 5
    tau logLik      AIC   BIC df.residual
  &lt;dbl&gt; &lt;logLik&gt;  &lt;dbl&gt; &lt;dbl&gt;       &lt;int&gt;
1   0.5 -249.6752  503.  509.          98

[[3]]
# A tibble: 1 × 5
    tau logLik      AIC   BIC df.residual
  &lt;dbl&gt; &lt;logLik&gt;  &lt;dbl&gt; &lt;dbl&gt;       &lt;int&gt;
1  0.75 -252.0106  508.  513.          98</code></pre>
</div>
</div>
</section>
<section id="visualizing-model-performance" class="level1">
<h1>Visualizing Model Performance</h1>
<p>Now, let’s visualize how well our quantile regression models perform. We’ll overlay the regression lines on our scatter plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scatter plot with regression lines</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scatter plot with regression lines</span></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hours, df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>score, </span>
<span id="cb7-4">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Quantile Regression: Hours vs. Score"</span>, </span>
<span id="cb7-5">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hours"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Score"</span>)</span>
<span id="cb7-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(quant_reg_25), </span>
<span id="cb7-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(quant_reg_25)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hours"</span>], </span>
<span id="cb7-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(quant_reg_50), </span>
<span id="cb7-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(quant_reg_50)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hours"</span>], </span>
<span id="cb7-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(quant_reg_75), </span>
<span id="cb7-13">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(quant_reg_75)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hours"</span>], </span>
<span id="cb7-14">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topleft"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Quantile 0.25"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Quantile 0.5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Quantile 0.75"</span>),</span>
<span id="cb7-16">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-29/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this blog post, we delved into the fascinating world of quantile regression using R and the quantreg library. We generated some synthetic data, visualized it, and then performed quantile regression at different quantiles. The final touch was overlaying the regression lines on our scatter plot to visualize how well our models fit the data.</p>
<p>Quantile regression provides a more nuanced view of the relationship between variables, especially when dealing with skewed or non-normally distributed data. It’s a valuable tool in your statistical toolkit. Happy coding, and may your regressions be ever quantile-wise accurate!</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-11-29/index.html</guid>
  <pubDate>Wed, 29 Nov 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Understanding and Implementing Robust Regression in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-11-28/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>If you’re familiar with linear regression in R, you’ve probably encountered the traditional <code>lm()</code> function. While this is a powerful tool, it might not be the best choice when dealing with outliers or influential observations. In such cases, robust regression comes to the rescue, and in R, the <code>rlm()</code> function from the MASS package is a valuable resource. In this blog post, we’ll delve into the step-by-step process of performing robust regression in R, using a dataset to illustrate the differences between the base R lm model and the robust rlm model.</p>
</section>
<section id="the-dataset" class="level1">
<h1>The Dataset</h1>
<p>Let’s start by loading the dataset into R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb1-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">34</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>),</span>
<span id="cb1-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">170</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">194</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">44</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">61</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">61</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">67</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">59</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>)</span>
<span id="cb1-5">)</span></code></pre></div>
</div>
<p>This dataset contains three variables: <code>x1</code>, <code>x2</code>, and <code>y</code>. Now, let’s explore how to fit a linear regression model using both the traditional <code>lm()</code> function and the robust <code>rlm()</code> function.</p>
</section>
<section id="fitting-a-model" class="level1">
<h1>Fitting a Model</h1>
<section id="traditional-linear-regression-lm" class="level2">
<h2 class="anchored" data-anchor-id="traditional-linear-regression-lm">Traditional Linear Regression (lm)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit the lm model</span></span>
<span id="cb2-2">lm_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the summary</span></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(lm_model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-72.020 -27.290  -0.138   4.487 124.144 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   41.106     29.940   1.373    0.188
x1            -0.605      2.066  -0.293    0.773
x2             1.075      1.857   0.579    0.570

Residual standard error: 49.42 on 17 degrees of freedom
Multiple R-squared:  0.02203,   Adjusted R-squared:  -0.09303 
F-statistic: 0.1914 on 2 and 17 DF,  p-value: 0.8275</code></pre>
</div>
</div>
<p>The <code>lm()</code> function provides a standard linear regression model. However, it assumes that the data follows a normal distribution and is sensitive to outliers. This sensitivity can lead to biased coefficient estimates.</p>
</section>
<section id="robust-linear-regression-rlm" class="level2">
<h2 class="anchored" data-anchor-id="robust-linear-regression-rlm">Robust Linear Regression (rlm)</h2>
<p>Now, let’s contrast this with the robust approach using the <code>rlm()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the MASS package</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(MASS)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit the rlm model</span></span>
<span id="cb4-5">robust_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rlm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df)</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the summary</span></span>
<span id="cb4-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(robust_model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call: rlm(formula = y ~ x1 + x2, data = df)
Residuals:
     Min       1Q   Median       3Q      Max 
-24.9296  -6.1604  -0.5812   6.4648 170.4612 

Coefficients:
            Value   Std. Error t value
(Intercept) 21.4109  5.9703     3.5862
x1           2.3077  0.4121     5.6004
x2          -0.2449  0.3703    -0.6615

Residual standard error: 9.369 on 17 degrees of freedom</code></pre>
</div>
</div>
<p>The <code>rlm()</code> function, part of the MASS package, uses a robust M-estimation approach. It downplays the impact of outliers, making it more suitable for datasets with influential observations.</p>
</section>
</section>
<section id="understanding-the-results" class="level1">
<h1>Understanding the Results</h1>
<p>When you compare the summaries of the two models, you’ll notice differences in the coefficient estimates and standard errors. The robust model is less influenced by outliers, providing more reliable estimates in the presence of skewed or contaminated data.</p>
</section>
<section id="view-the-residuals" class="level1">
<h1>View the Residuals</h1>
<p>Let’s take a closer look at the residuals of the two models. First, we’ll extract the residuals from the <code>lm()</code> model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">lm_residuals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">residuals</span>(lm_model)</span></code></pre></div>
</div>
<p>Next, we’ll extract the residuals from the <code>rlm()</code> model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">robust_residuals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">residuals</span>(robust_model)</span></code></pre></div>
</div>
<p>Now, let’s plot the residuals from both models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new plot</span></span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb8-3">  lm_residuals, </span>
<span id="cb8-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, </span>
<span id="cb8-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, </span>
<span id="cb8-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals Comparison: lm vs. rlm"</span>,</span>
<span id="cb8-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Observation"</span>, </span>
<span id="cb8-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals"</span></span>
<span id="cb8-9">  )</span>
<span id="cb8-10"></span>
<span id="cb8-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add robust residuals to the plot</span></span>
<span id="cb8-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">points</span>(</span>
<span id="cb8-13">  robust_residuals, </span>
<span id="cb8-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, </span>
<span id="cb8-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb8-16">  )</span>
<span id="cb8-17"></span>
<span id="cb8-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add a legend</span></span>
<span id="cb8-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topright"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm Residuals"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rlm Residuals"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-28/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="try-it-on-your-own" class="level1">
<h1>Try it on Your Own</h1>
<p>Now that you’ve seen the contrast between the traditional <code>lm()</code> and the robust <code>rlm()</code> models, I encourage you to apply this knowledge to your own datasets. Experiment with different datasets, introduce outliers, and observe how the two models react. This hands-on approach will deepen your understanding of robust regression in R.</p>
<p>Remember, robust regression is a powerful tool when facing real-world data challenges. As you explore, don’t hesitate to tweak parameters, test assumptions, and refine your models. Happy coding, and may your regression analyses be robust and resilient!</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-11-28/index.html</guid>
  <pubDate>Tue, 28 Nov 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Unveiling Power Regression: A Step-by-Step Guide in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-11-27/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In the realm of statistics, power regression stands out as a versatile tool for exploring the relationship between two variables, where one variable is the power of the other. This type of regression is particularly useful when there’s an inherent nonlinear relationship between the variables, often characterized by an exponential or inverse relationship.</p>
<p>Power regression takes the form of y = ax^b, where:</p>
<ul>
<li><p><code>y</code>: The response variable, the quantity we’re trying to predict</p></li>
<li><p><code>x</code>: The predictor variable, the quantity we’re using to make predictions</p></li>
<li><p><code>a</code>: The intercept, the value of y when x = 1</p></li>
<li><p><code>b</code>: The power coefficient, which determines the rate at which y changes as x increases or decreases</p></li>
</ul>
</section>
<section id="steps" class="level1">
<h1>Steps</h1>
<section id="step-1-gathering-the-data" class="level2">
<h2 class="anchored" data-anchor-id="step-1-gathering-the-data">Step 1: Gathering the Data</h2>
<p>To embark on our power regression journey, we’ll need some data to work with. Let’s simulate a dataset that exhibits an exponential relationship between two variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate data</span></span>
<span id="cb1-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-3">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span></code></pre></div>
</div>
</section>
<section id="step-2-visualizing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="step-2-visualizing-the-data">Step 2: Visualizing the Data</h2>
<p>Before diving into the regression analysis, it’s crucial to visualize the data to gain a deeper understanding of the underlying relationship between the variables. A scatterplot can effectively reveal any patterns or trends in the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create scatterplot</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(x, y)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-27/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="step-3-transforming-the-data" class="level2">
<h2 class="anchored" data-anchor-id="step-3-transforming-the-data">Step 3: Transforming the Data</h2>
<p>Since power regression assumes a nonlinear relationship between the variables, we need to transform the data to fit the model’s structure. This involves taking the logarithm of both sides of the power regression equation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform data</span></span>
<span id="cb3-2">log_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(y)</span>
<span id="cb3-3">log_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(x)</span></code></pre></div>
</div>
</section>
<section id="step-4-fitting-the-power-regression-model" class="level2">
<h2 class="anchored" data-anchor-id="step-4-fitting-the-power-regression-model">Step 4: Fitting the Power Regression Model</h2>
<p>Now that the data is suitably transformed, we can proceed with fitting the power regression model using the <code>lm()</code> function in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit power regression model</span></span>
<span id="cb4-2">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(log_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> log_x)</span></code></pre></div>
</div>
</section>
<section id="step-5-examining-the-model-results" class="level2">
<h2 class="anchored" data-anchor-id="step-5-examining-the-model-results">Step 5: Examining the Model Results</h2>
<p>The <code>summary()</code> function provides valuable insights into the model’s performance, including the estimated regression coefficients, their standard errors, and the p-values associated with each coefficient.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Summarize model results</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_y ~ log_x)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.10472 -0.01800  0.00221  0.01433  0.61505 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.812631   0.027647   29.39   &lt;2e-16 ***
log_x       2.969125   0.007367  403.03   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.06803 on 98 degrees of freedom
Multiple R-squared:  0.9994,    Adjusted R-squared:  0.9994 
F-statistic: 1.624e+05 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="step-6-visualizing-the-fitted-model" class="level2">
<h2 class="anchored" data-anchor-id="step-6-visualizing-the-fitted-model">Step 6: Visualizing the Fitted Model</h2>
<p>Visualizing the fitted model allows us to evaluate how well the model captures the underlying relationship between the variables. We can add the fitted model to the scatterplot using the <code>predict()</code> function (don’t forget to exponentiate!):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Predict fitted values</span></span>
<span id="cb7-2">fitted_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x),</span>
<span id="cb7-3">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">interval =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prediction"</span>,</span>
<span id="cb7-4">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add fitted model to scatterplot</span></span>
<span id="cb7-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(x, y)</span>
<span id="cb7-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(x, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(fitted_values[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-27/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="step-7-calculating-prediction-intervals" class="level2">
<h2 class="anchored" data-anchor-id="step-7-calculating-prediction-intervals">Step 7: Calculating Prediction Intervals</h2>
<p>Prediction intervals provide a range of plausible values for the response variable at a given level of confidence. We calculated the prediction intervals using the <code>predict()</code> function above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add fitted model to scatterplot</span></span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(x, y)</span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(x, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(fitted_values[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add prediction intervals to scatterplot</span></span>
<span id="cb8-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(x, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(fitted_values[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb8-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(x, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(fitted_values[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-27/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Power regression serves as a powerful tool for modeling nonlinear relationships between variables. By transforming the data, fitting the model, and visualizing the results, we can gain valuable insights into the underlying patterns and make informed predictions about the response variable.</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-11-27/index.html</guid>
  <pubDate>Mon, 27 Nov 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Unveiling the Magic of LOESS Regression in R: A Step-by-Step Guide with mtcars</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-11-22/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>If you’ve ever found yourself grappling with noisy data and yearning for a smoother representation, LOESS regression might be the enchanting solution you’re seeking. In this blog post, we’ll unravel the mysteries of LOESS regression using the power of R, and walk through a practical example using the iconic <code>mtcars</code> dataset.</p>
</section>
<section id="what-is-loess-regression" class="level1">
<h1>What is LOESS Regression?</h1>
<p>LOESS, which stands for LOcal regrESSion, is a versatile and powerful technique for fitting a curve to a set of data points. Unlike traditional linear regression, LOESS adapts to the local behavior of the data, making it perfect for capturing intricate patterns in noisy datasets.</p>
</section>
<section id="getting-started-loading-the-mtcars-dataset" class="level1">
<h1>Getting Started: Loading the mtcars Dataset</h1>
<p>Let’s kick off our journey by loading the <code>mtcars</code> dataset. This dataset, featuring various car specifications, will serve as our canvas for the LOESS magic.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the mtcars dataset</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(mtcars)</span></code></pre></div>
<section id="understanding-loess-the-basics" class="level2">
<h2 class="anchored" data-anchor-id="understanding-loess-the-basics">Understanding LOESS: The Basics</h2>
<p>Now, let’s delve into the heart of LOESS regression. In R, the magic happens with the <code>loess()</code> function. This function fits a smooth curve through your data, adjusting to the local characteristics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit a LOESS model</span></span>
<span id="cb2-2">loess_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loess</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span></code></pre></div>
</div>
<p>Congratulations, you’ve just cast the LOESS spell on the fuel efficiency and weight relationship of these iconic cars!</p>
</section>
<section id="visualizing-the-enchantment" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-the-enchantment">Visualizing the Enchantment</h2>
<p>What good is magic if you can’t see it? Let’s visualize the results with a compelling plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate predictions from the LOESS model</span></span>
<span id="cb3-2">predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(loess_model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> mtcars)</span>
<span id="cb3-3">predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(mtcars, predictions)</span>
<span id="cb3-4">predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> predictions[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">order</span>(predictions<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>wt), ]</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a scatter plot of the original data</span></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb3-8">  predictions<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>wt,</span>
<span id="cb3-9">  predictions<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg, </span>
<span id="cb3-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, </span>
<span id="cb3-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LOESS Regression: Unveiling the Magic with mtcars"</span>, </span>
<span id="cb3-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Weight (1000 lbs)"</span>, </span>
<span id="cb3-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles Per Gallon"</span></span>
<span id="cb3-14">)</span>
<span id="cb3-15"></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add the LOESS curve to the plot</span></span>
<span id="cb3-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(predictions<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>predictions, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-22/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Behold, as the red curve gracefully dances through the blue points, smoothing out the rough edges and revealing the underlying trends in the relationship between weight and fuel efficiency.</p>
<p>Now, we did not specify any parameters for the <code>loess()</code> function, so it used the default values. Let’s take a look at the default parameters.</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loess</span>(formula, data, weights, subset, na.action, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb4-2">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">span =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, enp.target, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">degree =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-3">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parametric =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">drop.square =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalize =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb4-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gaussian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"symmetric"</span>),</span>
<span id="cb4-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loess"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model.frame"</span>),</span>
<span id="cb4-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loess.control</span>(...), ...)</span></code></pre></div>
<p>If you want to see the documentation in R you can use <code>?loess</code> or <code>help(loess)</code>. I have it here for you anyways but it is good to know how to check it on the fly:</p>
<p><em>Arguments</em> <code>formula</code> - a formula specifying the numeric response and one to four numeric predictors (best specified via an interaction, but can also be specified additively). Will be coerced to a formula if necessary.</p>
<p><code>data</code> - an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which loess is called.</p>
<p><code>weights</code> - optional weights for each case.</p>
<p><code>subset</code> - an optional specification of a subset of the data to be used.</p>
<p><code>na.action</code> - the action to be taken with missing values in the response or predictors. The default is given by getOption(“na.action”).</p>
<p><code>model</code> - should the model frame be returned?</p>
<p><code>span</code> - the parameter α which controls the degree of smoothing.</p>
<p><code>enp.target</code> - an alternative way to specify span, as the approximate equivalent number of parameters to be used.</p>
<p><code>degree</code> - the degree of the polynomials to be used, normally 1 or 2. (Degree 0 is also allowed, but see the ‘Note’.)</p>
<p><code>parametric</code> - should any terms be fitted globally rather than locally? Terms can be specified by name, number or as a logical vector of the same length as the number of predictors.</p>
<p><code>drop.square</code> - for fits with more than one predictor and degree = 2, should the quadratic term be dropped for particular predictors? Terms are specified in the same way as for parametric.</p>
<p><code>normalize</code> - should the predictors be normalized to a common scale if there is more than one? The normalization used is to set the 10% trimmed standard deviation to one. Set to false for spatial coordinate predictors and others known to be on a common scale.</p>
<p><code>family</code> - if “gaussian” fitting is by least-squares, and if “symmetric” a re-descending M estimator is used with Tukey’s biweight function. Can be abbreviated.</p>
<p><code>method</code> - fit the model or just extract the model frame. Can be abbreviated.</p>
<p><code>control</code> - control parameters: see loess.control.</p>
<p><code>...</code> - control parameters can also be supplied directly (if control is not specified).</p>
<p>Now that we see we can set things like <code>span</code> and <code>degree</code> let’s try it out.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the data frame</span></span>
<span id="cb5-2">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>), </span>
<span id="cb5-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span>))</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit LOESS regression models</span></span>
<span id="cb5-6">loess50 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loess</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">span=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb5-7">smooth50 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(loess50)</span>
<span id="cb5-8">loess75 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loess</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">span=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)</span>
<span id="cb5-9">smooth75 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(loess75)</span>
<span id="cb5-10">loess90 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loess</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">span=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>)</span>
<span id="cb5-11">smooth90 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(loess90)</span>
<span id="cb5-12">loess50_degree1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loess</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">span=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">degree=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-13">smooth50_degree1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(loess50_degree1)</span>
<span id="cb5-14">loess50_degree2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loess</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">span=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">degree=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-15">smooth50_degree2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(loess50_degree2)</span>
<span id="cb5-16"></span>
<span id="cb5-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create scatterplot with each regression line overlaid</span></span>
<span id="cb5-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Loess Regression Models'</span>)</span>
<span id="cb5-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(smooth50, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb5-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(smooth75, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'purple'</span>)</span>
<span id="cb5-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(smooth90, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>)</span>
<span id="cb5-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(smooth50_degree1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'green'</span>)</span>
<span id="cb5-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(smooth50_degree2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'orange'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-22/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="empowering-you-try-it-yourself" class="level2">
<h2 class="anchored" data-anchor-id="empowering-you-try-it-yourself">Empowering You: Try It Yourself!</h2>
<p>Now comes the most exciting part – empowering you to wield the magic wand with the <code>mtcars</code> dataset or any other dataset of your choice. Encourage your readers to try the code on their own datasets, and witness the transformative power of LOESS regression.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Your readers can replace this with their own dataset</span></span>
<span id="cb6-2">user_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user_dataset.csv"</span>)</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit a LOESS model on their data</span></span>
<span id="cb6-5">user_loess_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loess</span>(Y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> user_data)</span>
<span id="cb6-6"></span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize the results</span></span>
<span id="cb6-8">user_predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(user_loess_model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> user_data)</span>
<span id="cb6-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(user_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>X, user_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Your Turn: Unleash LOESS Magic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>)</span>
<span id="cb6-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(user_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>X, user_predictions, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this journey, we’ve walked through the fundamentals of LOESS regression in R, witnessed its magic in action using the iconic <code>mtcars</code> dataset, and now it’s your turn to wield the wand. As you embark on your own adventures with LOESS, remember that this enchanting technique adapts to the nuances of your data, revealing hidden patterns and smoothing the way for clearer insights.</p>
<p>Happy coding, and may the LOESS magic be with you! 🚗✨</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-11-22/index.html</guid>
  <pubDate>Wed, 22 Nov 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Logarithmic Regression in R: A Step-by-Step Guide with Prediction Intervals</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-11-21/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Logarithmic regression is a statistical technique used to model the relationship between a dependent variable and an independent variable when the relationship is logarithmic. In other words, it is used to model situations where the dependent variable changes at a decreasing rate as the independent variable increases.</p>
<p>In this blog post, we will guide you through the process of performing logarithmic regression in R, from data preparation to visualizing the results. We will also discuss how to calculate prediction intervals and plot them along with the regression line.</p>
</section>
<section id="step-1-data-preparation" class="level1">
<h1>Step 1: Data Preparation</h1>
<p>Before diving into the analysis, it is essential to ensure that your data is properly formatted and ready for analysis. This may involve data cleaning, checking for missing values, and handling outliers.</p>
</section>
<section id="step-2-visualizing-the-data" class="level1">
<h1>Step 2: Visualizing the Data</h1>
<p>A quick scatterplot of the dependent variable versus the independent variable can provide valuable insights into the relationship between the two variables. This will help you determine if a logarithmic regression model is appropriate for your data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the data</span></span>
<span id="cb1-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-3">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb1-4">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x)</span>
<span id="cb1-5">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dependent =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">independent =</span> x)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a scatterplot</span></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>independent, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>dependent)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-21/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="step-3-fitting-the-logarithmic-regression-model" class="level1">
<h1>Step 3: Fitting the Logarithmic Regression Model</h1>
<p>The <code>lm()</code> function in R can be used to fit a logarithmic regression model. The syntax for fitting a logarithmic regression model is as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(dependent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(independent), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data)</span></code></pre></div>
</div>
</section>
<section id="step-4-evaluating-the-model" class="level1">
<h1>Step 4: Evaluating the Model</h1>
<p>Once the model has been fitted, it is important to evaluate its performance. There are several metrics that can be used to evaluate the performance of a logarithmic regression model, such as the coefficient of determination (R-squared) and the mean squared error (MSE).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dependent ~ log(independent), data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.12938 -0.24849 -0.03559  0.23825  0.55343 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       7.70024    0.12087   63.71   &lt;2e-16 ***
log(independent) -1.76239    0.03221  -54.72   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2974 on 98 degrees of freedom
Multiple R-squared:  0.9683,    Adjusted R-squared:  0.968 
F-statistic:  2994 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="step-5-calculating-prediction-intervals" class="level1">
<h1>Step 5: Calculating Prediction Intervals</h1>
<p>Prediction intervals provide a range of values within which we expect the true value of the dependent variable to fall for a given value of the independent variable. There are several methods for calculating prediction intervals, but one common method is to use the <code>predict()</code> function in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">newdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">independent =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>))</span>
<span id="cb5-2"></span>
<span id="cb5-3">predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(model, </span>
<span id="cb5-4">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> newdata, </span>
<span id="cb5-5">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">interval =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prediction"</span>,</span>
<span id="cb5-6">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span></code></pre></div>
</div>
</section>
<section id="step-6-plotting-the-predictions-and-intervals" class="level1">
<h1>Step 6: Plotting the Predictions and Intervals</h1>
<p>Plotting the predictions and intervals along with the regression line can help visualize the relationship between the variables and the uncertainty in the predictions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>independent, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>dependent)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(predictions[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> newdata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>independent, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matlines</span>(newdata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>independent, predictions[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-21/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Logarithmic regression is a powerful statistical technique that can be used to model a variety of relationships between variables. By following the steps outlined in this blog post, you can implement logarithmic regression in R to gain valuable insights from your data.</p>
</section>
<section id="you-try" class="level1">
<h1>You Try!!</h1>
<p>We encourage you to try out logarithmic regression on your own data. Start by exploring the relationship between your variables using a scatterplot. Then, fit a logarithmic regression model using the <code>lm()</code> function and evaluate its performance using the <code>summary()</code> function. Finally, calculate prediction intervals and plot them along with the regression line to visualize the relationship between the variables and the uncertainty in the predictions.</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-11-21/index.html</guid>
  <pubDate>Tue, 21 Nov 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Mastering Exponential Regression in R: A Step-by-Step Guide</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-11-20/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Hey folks, welcome back to another exciting R programming journey! Today, we’re diving into the fascinating world of exponential regression using base R. Exponential regression is a powerful tool, especially in the realm of data science, and we’ll walk through the process step by step. So, grab your coding hats, and let’s get started!</p>
</section>
<section id="understanding-exponential-regression" class="level1">
<h1>Understanding Exponential Regression</h1>
<p>Before we jump into the code, let’s quickly grasp the concept of exponential regression. In simple terms, it’s a statistical method used to model relationships where the rate of change of a variable is proportional to its current state. Think of scenarios like population growth, viral spread, or even financial investments.</p>
<section id="step-1-your-data" class="level2">
<h2 class="anchored" data-anchor-id="step-1-your-data">Step 1: Your Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">Year <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2001</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2002</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2003</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2004</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2005</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2006</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2007</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2008</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2009</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2010</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2011</span>, </span>
<span id="cb1-2">          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2012</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2013</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2014</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2017</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2018</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2019</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>)</span>
<span id="cb1-3">Population <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">550</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">610</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">680</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">760</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">850</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">950</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1060</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1180</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1320</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1470</span>, </span>
<span id="cb1-4">                <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1640</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1830</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2040</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2280</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2540</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2830</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3140</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3480</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3850</span>)</span>
<span id="cb1-5"></span>
<span id="cb1-6">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(Year, Population)</span></code></pre></div>
</div>
<p>Make sure to replace “your_data.csv” with the actual file name and path of your dataset. This is the foundation of our analysis, so choose a dataset that suits your exponential regression exploration.</p>
</section>
<section id="step-2-explore-your-data" class="level2">
<h2 class="anchored" data-anchor-id="step-2-explore-your-data">Step 2: Explore Your Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Take a sneak peek at your data</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Year Population
1 2001        500
2 2002        550
3 2003        610
4 2004        680
5 2005        760
6 2006        850</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Year        Population    
 Min.   :2001   Min.   : 500.0  
 1st Qu.:2006   1st Qu.: 827.5  
 Median :2010   Median :1395.0  
 Mean   :2010   Mean   :1678.0  
 3rd Qu.:2015   3rd Qu.:2345.0  
 Max.   :2020   Max.   :3850.0  </code></pre>
</div>
</div>
<p>Understanding your data is crucial. The ‘head()’ function displays the first few rows, and ‘summary()’ gives you a statistical summary. Look for patterns that might indicate exponential growth or decay.</p>
</section>
<section id="step-3-plot-your-data" class="level2">
<h2 class="anchored" data-anchor-id="step-3-plot-your-data">Step 3: Plot Your Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a scatter plot</span></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb6-3">  Year, </span>
<span id="cb6-4">  Population, </span>
<span id="cb6-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exponential Regression"</span>, </span>
<span id="cb6-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Independent Variable"</span>, </span>
<span id="cb6-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dependent Variable"</span></span>
<span id="cb6-8">)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-20/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Visualizing your data helps in identifying trends. A scatter plot is an excellent choice to see if there’s a potential exponential relationship.</p>
</section>
<section id="step-4-fit-exponential-model" class="level2">
<h2 class="anchored" data-anchor-id="step-4-fit-exponential-model">Step 4: Fit Exponential Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit exponential regression model</span></span>
<span id="cb7-2">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(Population) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df)</span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Population) ~ Year, data = df)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0134745 -0.0032271  0.0008587  0.0037029  0.0108613 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -2.113e+02  4.637e-01  -455.7   &lt;2e-16 ***
Year         1.087e-01  2.307e-04   471.3   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.005948 on 18 degrees of freedom
Multiple R-squared:  0.9999,    Adjusted R-squared:  0.9999 
F-statistic: 2.221e+05 on 1 and 18 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Here, we take the logarithm of the dependent variable ‘y’ to linearize the relationship. This facilitates using linear regression to model the data.</p>
</section>
<section id="step-5-make-predictions" class="level2">
<h2 class="anchored" data-anchor-id="step-5-make-predictions">Step 5: Make Predictions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make predictions</span></span>
<span id="cb9-2">prediction_interval <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(</span>
<span id="cb9-3">  model, </span>
<span id="cb9-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> df,</span>
<span id="cb9-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">interval=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prediction"</span>,</span>
<span id="cb9-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span></span>
<span id="cb9-7">  ))</span></code></pre></div>
</div>
<p>Replace ‘new_x’ with the values for which you want to predict ‘y’. The ‘exp()’ function is used to reverse the logarithmic transformation.</p>
</section>
<section id="step-6-visualize-results" class="level2">
<h2 class="anchored" data-anchor-id="step-6-visualize-results">Step 6: Visualize Results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the original data and the regression line</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Year, df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Population, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exponential Regression"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Year"</span>, </span>
<span id="cb10-3">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>)</span>
<span id="cb10-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Year, prediction_interval[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Year, prediction_interval[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb10-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Year, prediction_interval[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb10-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topright"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exponential Regression"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-20/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This code adds the exponential regression line to your scatter plot. It’s a visual confirmation of how well your model fits the data.</p>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>There you have it, a step-by-step guide to performing exponential regression in R using base functions. Remember, the real fun begins when you apply this to your own datasets. Play around, tweak the parameters, and see how well you can predict those future values.</p>
<p>Coding is all about exploration and experimentation, so don’t hesitate to get your hands dirty. Happy coding, and may your data always reveal its secrets in the most exponential way possible!</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-11-20/index.html</guid>
  <pubDate>Mon, 20 Nov 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Quadratic Regression in R: Unveiling Non-Linear Relationships</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-11-17/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In the realm of data analysis, quadratic regression emerges as a powerful tool for uncovering the hidden patterns within datasets that exhibit non-linear relationships. Unlike its linear counterpart, quadratic regression ventures beyond straight lines, gracefully capturing curved relationships between variables. This makes it an essential technique for understanding a wide range of phenomena, from predicting stock prices to modeling population growth.</p>
<p>Embark on a journey into the world of quadratic regression using the versatile R programming language. We’ll explore the steps involved in fitting a quadratic model, interpreting its parameters, and visualizing the results. Along the way, you’ll gain hands-on experience with this valuable technique, enabling you to tackle your own data analysis challenges with confidence.</p>
</section>
<section id="setting-the-stage-data-preparation" class="level1">
<h1>Setting the Stage: Data Preparation</h1>
<p>Before embarking on our quadratic regression adventure, let’s assemble our data. Suppose we’re investigating the relationship between study hours and exam scores. We’ve gathered data from a group of students, recording their study hours and corresponding exam scores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a data frame to store the data</span></span>
<span id="cb1-2">study_hours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">47</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">51</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>)</span>
<span id="cb1-3">exam_scores <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">89</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">94</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">59</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">44</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span>)</span>
<span id="cb1-4">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(study_hours, exam_scores)</span>
<span id="cb1-5">data</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   study_hours exam_scores
1            6          14
2            9          28
3           12          50
4           14          70
5           30          89
6           35          94
7           40          90
8           47          75
9           51          59
10          55          44
11          60          27</code></pre>
</div>
</div>
</section>
<section id="visualizing-the-relationship-a-scatterplots-revelation" class="level1">
<h1>Visualizing the Relationship: A Scatterplot’s Revelation</h1>
<p>To gain an initial impression of the relationship between study hours and exam scores, let’s create a scatterplot. This simple yet powerful visualization will reveal the underlying pattern in our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a scatterplot of exam scores versus study hours</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb3-3">  data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>study_hours, </span>
<span id="cb3-4">  data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>exam_scores, </span>
<span id="cb3-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exam Scores vs. Study Hours"</span>, </span>
<span id="cb3-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Study Hours"</span>, </span>
<span id="cb3-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exam Scores"</span></span>
<span id="cb3-8">  )</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-17/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Upon examining the scatterplot, a hint of a non-linear relationship emerges. The data points don’t fall along a straight line, suggesting a more complex association between study hours and exam scores. This is where quadratic regression steps in.</p>
</section>
<section id="fitting-the-quadratic-model-capturing-the-curve" class="level1">
<h1>Fitting the Quadratic Model: Capturing the Curve</h1>
<p>To capture the curvature evident in our data, we’ll employ the <code>lm()</code> function in R to fit a quadratic regression model. This model incorporates a second-degree term, allowing it to represent curved relationships between variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit a quadratic regression model to the data</span></span>
<span id="cb4-2">quadratic_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(exam_scores <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> study_hours <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">I</span>(study_hours<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data)</span></code></pre></div>
</div>
<p>The <code>I()</code> function in the model formula ensures that the square of study hours is treated as a separate variable, enabling the model to capture the non-linearity.</p>
</section>
<section id="interpreting-the-model-unraveling-the-parameters" class="level1">
<h1>Interpreting the Model: Unraveling the Parameters</h1>
<p>Now that we’ve fitted the quadratic model, let’s delve into its parameters and understand their significance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Summarize the quadratic regression model</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(quadratic_model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = exam_scores ~ study_hours + I(study_hours^2), data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2484 -3.7429 -0.1812  1.1464 13.6678 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      -18.25364    6.18507  -2.951   0.0184 *  
study_hours        6.74436    0.48551  13.891 6.98e-07 ***
I(study_hours^2)  -0.10120    0.00746 -13.565 8.38e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.218 on 8 degrees of freedom
Multiple R-squared:  0.9602,    Adjusted R-squared:  0.9502 
F-statistic: 96.49 on 2 and 8 DF,  p-value: 2.51e-06</code></pre>
</div>
</div>
<p>The output of the summary function provides valuable insights into the model’s performance and the significance of its parameters. It indicates the intercept, representing the predicted exam score when study hours are zero, and the coefficients for the linear and quadratic terms.</p>
</section>
<section id="visualizing-the-model-bringing-the-curve-to-life" class="level1">
<h1>Visualizing the Model: Bringing the Curve to Life</h1>
<p>To fully appreciate the quadratic model’s ability to capture the non-linear relationship between study hours and exam scores, let’s visualize the model alongside the data points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the predicted exam scores for a range of study hours</span></span>
<span id="cb7-2">predicted_scores <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(</span>
<span id="cb7-3">  quadratic_model, </span>
<span id="cb7-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb7-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">study_hours =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(study_hours), </span>
<span id="cb7-6">                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(study_hours), </span>
<span id="cb7-7">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb7-8">                      )</span>
<span id="cb7-9">    )</span>
<span id="cb7-10">  )</span>
<span id="cb7-11"></span>
<span id="cb7-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the data points and the predicted scores</span></span>
<span id="cb7-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb7-14">  data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>study_hours, </span>
<span id="cb7-15">  data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>exam_scores, </span>
<span id="cb7-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exam Scores vs. Study Hours"</span>, </span>
<span id="cb7-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Study Hours"</span>, </span>
<span id="cb7-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exam Scores"</span></span>
<span id="cb7-19">  )</span>
<span id="cb7-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(study_hours), </span>
<span id="cb7-21">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(study_hours), </span>
<span id="cb7-22">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>), </span>
<span id="cb7-23">      predicted_scores, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span></span>
<span id="cb7-24">      )</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-17/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The resulting plot reveals the graceful curve of the quadratic model, fitting the data points closely. This visualization reinforces the model’s ability to capture the non-linear relationship between study hours and exam scores.</p>
</section>
<section id="your-turn-embarking-on-your-own-quadratic-regression-adventure" class="level1">
<h1>Your Turn: Embarking on Your Own Quadratic Regression Adventure</h1>
<p>Armed with the knowledge and skills gained from this tutorial, you’re now ready to embark on your own quadratic regression adventures. Gather your data, fit the model, interpret the parameters, and visualize the results.</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-11-17/index.html</guid>
  <pubDate>Fri, 17 Nov 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>{healthyR.ts} New Features: Unlocking More Power</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-11-16/index.html</link>
  <description><![CDATA[ 




<section id="new-features-unlocking-more-power" class="level1">
<h1>New Features: Unlocking More Power</h1>
<p>My R package <code>{healthyR.ts}</code> has been updated to version 0.3.0; you can install it from either CRAN, r-universe or GitHub. Let’s go over some of the changes and improvements.</p>
</section>
<section id="news" class="level1">
<h1>News</h1>
<section id="util_log_ts---logging-time-series-data" class="level2">
<h2 class="anchored" data-anchor-id="util_log_ts---logging-time-series-data">1. <code>util_log_ts()</code> - Logging Time Series Data</h2>
<p>One of the standout additions is the introduction of <code>util_log_ts()</code>. This function seems like a game-changer, providing a streamlined way to log time series data. This is incredibly useful, especially when dealing with extensive datasets, making the whole process more efficient and user-friendly. This is a helper function for <code>auto_stationarize()</code>.</p>
</section>
<section id="util_singlediff_ts---single-differences-for-time-series" class="level2">
<h2 class="anchored" data-anchor-id="util_singlediff_ts---single-differences-for-time-series">2. <code>util_singlediff_ts()</code> - Single Differences for Time Series</h2>
<p>The addition of <code>util_singlediff_ts()</code> expands the toolkit, offering a function dedicated to handling single differences in time series data. This is valuable for various applications, such as identifying trends or preparing data for further analysis. This is a helper function for <code>auto_stationarize()</code>.</p>
</section>
<section id="util_doublediff_ts---double-differences-for-time-series" class="level2">
<h2 class="anchored" data-anchor-id="util_doublediff_ts---double-differences-for-time-series">3. <code>util_doublediff_ts()</code> - Double Differences for Time Series</h2>
<p>Building on the concept of differencing, <code>util_doublediff_ts()</code> seems to provide a higher level of sophistication, allowing users to perform double differences on time series data. This could be pivotal in cases where a more refined analysis is required. This is a helper function for <code>auto_stationarize()</code>.</p>
</section>
<section id="util_difflog_ts---combining-differences-and-log-transformation" class="level2">
<h2 class="anchored" data-anchor-id="util_difflog_ts---combining-differences-and-log-transformation">4. <code>util_difflog_ts()</code> - Combining Differences and Log Transformation</h2>
<p>The fusion of differencing and log transformation in <code>util_difflog_ts()</code> is a remarkable addition. This could be particularly beneficial in scenarios where both operations are needed to unlock deeper insights from the time series data. This is a helper function for <code>auto_stationarize()</code>.</p>
</section>
<section id="util_doubledifflog_ts---double-differences-with-log-transformation" class="level2">
<h2 class="anchored" data-anchor-id="util_doubledifflog_ts---double-differences-with-log-transformation">5. <code>util_doubledifflog_ts()</code> - Double Differences with Log Transformation</h2>
<p>The introduction of <code>util_doubledifflog_ts()</code> appears to take things a step further by combining double differences and log transformation. This function seems poised to provide a comprehensive solution for users dealing with complex time series data. This is a helper function for <code>auto_stationarize()</code>.</p>
</section>
</section>
<section id="minor-fixes-and-improvements-polishing-the-experience" class="level1">
<h1>Minor Fixes and Improvements: Polishing the Experience</h1>
<section id="attributes-enhancement-in-ts_growth_rate_vec" class="level2">
<h2 class="anchored" data-anchor-id="attributes-enhancement-in-ts_growth_rate_vec">1. Attributes Enhancement in <code>ts_growth_rate_vec()</code></h2>
<p>The attention to detail is evident with the addition of attributes to the output of <code>ts_growth_rate_vec()</code>. This enhancement not only improves the clarity of results but also contributes to a more informative and user-friendly experience.</p>
</section>
<section id="refinement-of-auto_stationarize-in-response-to-user-feedback" class="level2">
<h2 class="anchored" data-anchor-id="refinement-of-auto_stationarize-in-response-to-user-feedback">2. Refinement of <code>auto_stationarize()</code> in Response to User Feedback</h2>
<p>Updates to <code>auto_stationarize()</code> based on user feedback (Fix #481 #483) demonstrate a commitment to refining existing features. This responsiveness to the community’s needs is commendable and ensures that the package evolves in sync with user expectations. It has taken all of the <code>util_</code> transforms mentioned above in order to improve it’s functionality.</p>
</section>
<section id="integration-with-auto_arima-engine-in-ts_auto_arima" class="level2">
<h2 class="anchored" data-anchor-id="integration-with-auto_arima-engine-in-ts_auto_arima">3. Integration with <code>auto_arima</code> Engine in <code>ts_auto_arima()</code></h2>
<p>The integration of <code>ts_auto_arima()</code> with the parsnip engine of <code>auto_arima</code> is a notable improvement. This update, triggered when <code>.tune</code> is set to <code>FALSE</code>, aligns the package with cutting-edge tools, potentially enhancing the efficiency and accuracy of time series modeling.</p>
<p>In conclusion, the release of healthyR.ts version 0.3.0 is an exciting leap forward. The new features introduce powerful capabilities, while the minor fixes and improvements showcase a commitment to providing a robust and user-friendly package. Users can look forward to a more versatile and refined experience in time series analysis. Great job on this release, and I’m sure the community is eager to explore these enhancements!</p>
</section>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<p>Let’s see how the main functions now behave.</p>
<section id="auto_stationarize" class="level2">
<h2 class="anchored" data-anchor-id="auto_stationarize"><code>auto_stationarize()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(healthyR.ts)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">auto_stationarize</span>(AirPassengers)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The time series is already stationary via ts_adf_test().</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1949 112 118 132 129 121 135 148 148 136 119 104 118
1950 115 126 141 135 125 149 170 170 158 133 114 140
1951 145 150 178 163 172 178 199 199 184 162 146 166
1952 171 180 193 181 183 218 230 242 209 191 172 194
1953 196 196 236 235 229 243 264 272 237 211 180 201
1954 204 188 235 227 234 264 302 293 259 229 203 229
1955 242 233 267 269 270 315 364 347 312 274 237 278
1956 284 277 317 313 318 374 413 405 355 306 271 306
1957 315 301 356 348 355 422 465 467 404 347 305 336
1958 340 318 362 348 363 435 491 505 404 359 310 337
1959 360 342 406 396 420 472 548 559 463 407 362 405
1960 417 391 419 461 472 535 622 606 508 461 390 432</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">auto_stationarize</span>(BJsales)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The time series is not stationary. Attempting to make it stationary...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$stationary_ts
Time Series:
Start = 3 
End = 150 
Frequency = 1 
  [1]  0.5 -0.4  0.6  1.1 -2.8  3.0 -1.1  0.6 -0.5 -0.5  0.1  2.0 -0.6  0.8  1.2
 [16] -3.4 -0.7 -0.3  1.7  3.0 -3.2  0.9  2.2 -2.5 -0.4  2.6 -4.3  2.0 -3.1  2.7
 [31] -2.1  0.1  2.1 -0.2 -2.2  0.6  1.0 -2.6  3.0  0.3  0.2 -0.8  1.0  0.0  3.2
 [46] -2.2 -4.7  1.2  0.8 -0.6 -0.4  0.6  1.0 -1.6 -0.1  3.4 -0.9 -1.7 -0.5  0.8
 [61]  2.4 -1.9  0.6 -2.2  2.6 -0.1 -2.7  1.7 -0.3  1.9 -2.7  1.1 -0.6  0.9  0.0
 [76]  1.8 -0.5 -0.4 -1.2  2.6 -1.8  1.7 -0.9  0.6 -0.4  3.0 -2.8  3.1 -2.3 -1.1
 [91]  2.1 -0.3 -1.7 -0.8 -0.4  1.1 -1.5  0.3  1.4 -2.0  1.3 -0.3  0.4 -3.5  1.1
[106]  2.6  0.4 -1.3  2.0 -1.6  0.6 -0.1 -1.4  1.6  1.6 -3.4  1.7 -2.2  2.1 -2.0
[121] -0.2  0.2  0.7 -1.4  1.8 -0.1 -0.7  0.4  0.4  1.0 -2.4  1.0 -0.4  0.8 -1.0
[136]  1.4 -1.2  1.1 -0.9  0.5  1.9 -0.6  0.3 -1.4 -0.9 -0.5  1.4  0.1

$ndiffs
[1] 1

$adf_stats
$adf_stats$test_stat
[1] -6.562008

$adf_stats$p_value
[1] 0.01


$trans_type
[1] "double_diff"

$ret
[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot.ts</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">auto_stationarize</span>(BJsales)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>stationary_ts)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The time series is not stationary. Attempting to make it stationary...</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-16/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">auto_stationarize</span>(BJsales.lead)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The time series is not stationary. Attempting to make it stationary...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$stationary_ts
Time Series:
Start = 2 
End = 150 
Frequency = 1 
  [1]  0.06  0.25 -0.57  0.58 -0.20  0.23 -0.04 -0.19  0.03  0.42  0.04  0.24
 [13]  0.34 -0.46 -0.18 -0.08  0.29  0.56 -0.37  0.20  0.54 -0.31  0.03  0.52
 [25] -0.70  0.35 -0.63  0.44 -0.38 -0.01  0.22  0.10 -0.50  0.01  0.30 -0.76
 [37]  0.52  0.15  0.06 -0.10  0.21 -0.01  0.70 -0.22 -0.76  0.06  0.02 -0.17
 [49] -0.08  0.01  0.11 -0.39  0.01  0.50 -0.02 -0.37 -0.13  0.05  0.54 -0.46
 [61]  0.25 -0.52  0.44  0.02 -0.47  0.11  0.06  0.25 -0.35  0.00 -0.06  0.21
 [73] -0.09  0.36  0.09 -0.04 -0.20  0.44 -0.23  0.40 -0.01  0.17  0.08  0.58
 [85] -0.27  0.79 -0.21  0.02  0.30  0.28 -0.27 -0.01  0.03  0.16 -0.28  0.15
 [97]  0.26 -0.36  0.32 -0.11  0.22 -0.65  0.00  0.47  0.16 -0.19  0.48 -0.26
[109]  0.21  0.00 -0.20  0.35  0.38 -0.48  0.20 -0.32  0.43 -0.50  0.12 -0.17
[121]  0.15 -0.36  0.35 -0.03 -0.18  0.16  0.07  0.21 -0.50  0.23 -0.13  0.14
[133] -0.15  0.19 -0.24  0.26 -0.22  0.17  0.37 -0.06  0.29 -0.34 -0.12 -0.16
[145]  0.25  0.08 -0.07  0.26 -0.37

$ndiffs
[1] 1

$adf_stats
$adf_stats$test_stat
[1] -4.838625

$adf_stats$p_value
[1] 0.01


$trans_type
[1] "diff"

$ret
[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot.ts</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">auto_stationarize</span>(BJsales.lead)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>stationary_ts)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The time series is not stationary. Attempting to make it stationary...</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-16/index_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ts_auto_arima" class="level2">
<h2 class="anchored" data-anchor-id="ts_auto_arima"><code>ts_auto_arima()</code></h2>
<p>This use to only use the Arima engine if the <code>.tune</code> parameter was set to FALSE, thus it would many times give a simple straight line forecast. This was changed to make the engine auto_arima if <code>.tune</code> is set to FALSE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(timetk)</span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb14-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(modeltime)</span>
<span id="cb14-4"></span>
<span id="cb14-5">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> AirPassengers <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_to_tbl</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>index)</span>
<span id="cb14-8"></span>
<span id="cb14-9">splits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">time_series_split</span>(</span>
<span id="cb14-10">  data</span>
<span id="cb14-11">  , date_col</span>
<span id="cb14-12">  , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">assess =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb14-13">  , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">skip =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb14-14">  , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cumulative =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb14-15">)</span>
<span id="cb14-16"></span>
<span id="cb14-17">ts_aa <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_auto_arima</span>(</span>
<span id="cb14-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.data =</span> data,</span>
<span id="cb14-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.num_cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb14-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.date_col =</span> date_col,</span>
<span id="cb14-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.value_col =</span> value,</span>
<span id="cb14-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.rsamp_obj =</span> splits,</span>
<span id="cb14-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.formula =</span> value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .,</span>
<span id="cb14-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.grid_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb14-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.cv_slice_limit =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb14-26">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.tune =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb14-27">)</span>
<span id="cb14-28"></span>
<span id="cb14-29">ts_aa<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>recipe_info</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$recipe_call
recipe(.data = data, .date_col = date_col, .value_col = value, 
    .formula = value ~ ., .rsamp_obj = splits, .tune = FALSE, 
    .grid_size = 5, .num_cores = 2, .cv_slice_limit = 2)

$recipe_syntax
[1] "ts_arima_recipe &lt;-"                                                                                                                                                                           
[2] "\n  recipe(.data = data, .date_col = date_col, .value_col = value, .formula = value ~ \n    ., .rsamp_obj = splits, .tune = FALSE, .grid_size = 5, .num_cores = 2, \n    .cv_slice_limit = 2)"

$rec_obj</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">ts_aa<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>model_info</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$model_spec
ARIMA Regression Model Specification (regression)

Computational engine: auto_arima 


$wflw
══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: arima_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
ARIMA Regression Model Specification (regression)

Computational engine: auto_arima 


$fitted_wflw
══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: arima_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
Series: outcome 
ARIMA(1,1,0)(0,1,0)[12] 

Coefficients:
          ar1
      -0.2431
s.e.   0.0894

sigma^2 = 109.8:  log likelihood = -447.95
AIC=899.9   AICc=900.01   BIC=905.46

$was_tuned
[1] "not_tuned"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">ts_aa<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>model_calibration</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$plot

$calibration_tbl
# Modeltime Table
# A tibble: 1 × 5
  .model_id .model     .model_desc             .type .calibration_data
      &lt;int&gt; &lt;list&gt;     &lt;chr&gt;                   &lt;chr&gt; &lt;list&gt;           
1         1 &lt;workflow&gt; ARIMA(1,1,0)(0,1,0)[12] Test  &lt;tibble [12 × 4]&gt;

$model_accuracy
# A tibble: 1 × 9
  .model_id .model_desc             .type   mae  mape  mase smape  rmse   rsq
      &lt;int&gt; &lt;chr&gt;                   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1         1 ARIMA(1,1,0)(0,1,0)[12] Test   18.5  4.18 0.384  4.03  23.9 0.955</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">ts_aa<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>model_calibration<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot</span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9e72df46a6f62d8a62a4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9e72df46a6f62d8a62a4">{"x":{"data":[{"x":["1949-01-01","1949-02-01","1949-03-01","1949-04-01","1949-05-01","1949-06-01","1949-07-01","1949-08-01","1949-09-01","1949-10-01","1949-11-01","1949-12-01","1950-01-01","1950-02-01","1950-03-01","1950-04-01","1950-05-01","1950-06-01","1950-07-01","1950-08-01","1950-09-01","1950-10-01","1950-11-01","1950-12-01","1951-01-01","1951-02-01","1951-03-01","1951-04-01","1951-05-01","1951-06-01","1951-07-01","1951-08-01","1951-09-01","1951-10-01","1951-11-01","1951-12-01","1952-01-01","1952-02-01","1952-03-01","1952-04-01","1952-05-01","1952-06-01","1952-07-01","1952-08-01","1952-09-01","1952-10-01","1952-11-01","1952-12-01","1953-01-01","1953-02-01","1953-03-01","1953-04-01","1953-05-01","1953-06-01","1953-07-01","1953-08-01","1953-09-01","1953-10-01","1953-11-01","1953-12-01","1954-01-01","1954-02-01","1954-03-01","1954-04-01","1954-05-01","1954-06-01","1954-07-01","1954-08-01","1954-09-01","1954-10-01","1954-11-01","1954-12-01","1955-01-01","1955-02-01","1955-03-01","1955-04-01","1955-05-01","1955-06-01","1955-07-01","1955-08-01","1955-09-01","1955-10-01","1955-11-01","1955-12-01","1956-01-01","1956-02-01","1956-03-01","1956-04-01","1956-05-01","1956-06-01","1956-07-01","1956-08-01","1956-09-01","1956-10-01","1956-11-01","1956-12-01","1957-01-01","1957-02-01","1957-03-01","1957-04-01","1957-05-01","1957-06-01","1957-07-01","1957-08-01","1957-09-01","1957-10-01","1957-11-01","1957-12-01","1958-01-01","1958-02-01","1958-03-01","1958-04-01","1958-05-01","1958-06-01","1958-07-01","1958-08-01","1958-09-01","1958-10-01","1958-11-01","1958-12-01","1959-01-01","1959-02-01","1959-03-01","1959-04-01","1959-05-01","1959-06-01","1959-07-01","1959-08-01","1959-09-01","1959-10-01","1959-11-01","1959-12-01","1960-01-01","1960-02-01","1960-03-01","1960-04-01","1960-05-01","1960-06-01","1960-07-01","1960-08-01","1960-09-01","1960-10-01","1960-11-01","1960-12-01"],"y":[112,118,132,129,121,135,148,148,136,119,104,118,115,126,141,135,125,149,170,170,158,133,114,140,145,150,178,163,172,178,199,199,184,162,146,166,171,180,193,181,183,218,230,242,209,191,172,194,196,196,236,235,229,243,264,272,237,211,180,201,204,188,235,227,234,264,302,293,259,229,203,229,242,233,267,269,270,315,364,347,312,274,237,278,284,277,317,313,318,374,413,405,355,306,271,306,315,301,356,348,355,422,465,467,404,347,305,336,340,318,362,348,363,435,491,505,404,359,310,337,360,342,406,396,420,472,548,559,463,407,362,405,417,391,419,461,472,535,622,606,508,461,390,432],"text":[".index: 1949-01-01<br />.value: 112.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-02-01<br />.value: 118.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-03-01<br />.value: 132.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-04-01<br />.value: 129.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-05-01<br />.value: 121.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-06-01<br />.value: 135.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-07-01<br />.value: 148.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-08-01<br />.value: 148.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-09-01<br />.value: 136.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-10-01<br />.value: 119.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-11-01<br />.value: 104.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-12-01<br />.value: 118.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-01-01<br />.value: 115.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-02-01<br />.value: 126.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-03-01<br />.value: 141.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-04-01<br />.value: 135.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-05-01<br />.value: 125.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-06-01<br />.value: 149.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-07-01<br />.value: 170.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-08-01<br />.value: 170.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-09-01<br />.value: 158.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-10-01<br />.value: 133.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-11-01<br />.value: 114.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-12-01<br />.value: 140.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-01-01<br />.value: 145.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-02-01<br />.value: 150.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-03-01<br />.value: 178.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-04-01<br />.value: 163.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-05-01<br />.value: 172.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-06-01<br />.value: 178.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-07-01<br />.value: 199.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-08-01<br />.value: 199.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-09-01<br />.value: 184.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-10-01<br />.value: 162.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-11-01<br />.value: 146.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-12-01<br />.value: 166.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-01-01<br />.value: 171.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-02-01<br />.value: 180.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-03-01<br />.value: 193.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-04-01<br />.value: 181.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-05-01<br />.value: 183.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-06-01<br />.value: 218.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-07-01<br />.value: 230.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-08-01<br />.value: 242.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-09-01<br />.value: 209.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-10-01<br />.value: 191.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-11-01<br />.value: 172.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-12-01<br />.value: 194.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-01-01<br />.value: 196.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-02-01<br />.value: 196.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-03-01<br />.value: 236.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-04-01<br />.value: 235.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-05-01<br />.value: 229.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-06-01<br />.value: 243.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-07-01<br />.value: 264.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-08-01<br />.value: 272.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-09-01<br />.value: 237.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-10-01<br />.value: 211.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-11-01<br />.value: 180.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-12-01<br />.value: 201.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-01-01<br />.value: 204.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-02-01<br />.value: 188.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-03-01<br />.value: 235.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-04-01<br />.value: 227.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-05-01<br />.value: 234.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-06-01<br />.value: 264.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-07-01<br />.value: 302.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-08-01<br />.value: 293.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-09-01<br />.value: 259.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-10-01<br />.value: 229.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-11-01<br />.value: 203.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-12-01<br />.value: 229.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-01-01<br />.value: 242.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-02-01<br />.value: 233.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-03-01<br />.value: 267.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-04-01<br />.value: 269.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-05-01<br />.value: 270.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-06-01<br />.value: 315.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-07-01<br />.value: 364.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-08-01<br />.value: 347.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-09-01<br />.value: 312.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-10-01<br />.value: 274.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-11-01<br />.value: 237.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-12-01<br />.value: 278.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-01-01<br />.value: 284.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-02-01<br />.value: 277.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-03-01<br />.value: 317.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-04-01<br />.value: 313.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-05-01<br />.value: 318.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-06-01<br />.value: 374.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-07-01<br />.value: 413.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-08-01<br />.value: 405.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-09-01<br />.value: 355.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-10-01<br />.value: 306.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-11-01<br />.value: 271.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-12-01<br />.value: 306.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-01-01<br />.value: 315.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-02-01<br />.value: 301.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-03-01<br />.value: 356.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-04-01<br />.value: 348.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-05-01<br />.value: 355.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-06-01<br />.value: 422.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-07-01<br />.value: 465.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-08-01<br />.value: 467.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-09-01<br />.value: 404.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-10-01<br />.value: 347.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-11-01<br />.value: 305.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-12-01<br />.value: 336.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-01-01<br />.value: 340.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-02-01<br />.value: 318.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-03-01<br />.value: 362.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-04-01<br />.value: 348.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-05-01<br />.value: 363.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-06-01<br />.value: 435.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-07-01<br />.value: 491.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-08-01<br />.value: 505.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-09-01<br />.value: 404.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-10-01<br />.value: 359.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-11-01<br />.value: 310.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-12-01<br />.value: 337.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-01-01<br />.value: 360.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-02-01<br />.value: 342.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-03-01<br />.value: 406.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-04-01<br />.value: 396.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-05-01<br />.value: 420.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-06-01<br />.value: 472.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-07-01<br />.value: 548.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-08-01<br />.value: 559.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-09-01<br />.value: 463.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-10-01<br />.value: 407.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-11-01<br />.value: 362.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-12-01<br />.value: 405.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-01-01<br />.value: 417.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-02-01<br />.value: 391.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-03-01<br />.value: 419.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-04-01<br />.value: 461.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-05-01<br />.value: 472.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-06-01<br />.value: 535.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-07-01<br />.value: 622.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-08-01<br />.value: 606.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-09-01<br />.value: 508.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-10-01<br />.value: 461.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-11-01<br />.value: 390.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-12-01<br />.value: 432.0000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["1960-01-01","1960-02-01","1960-03-01","1960-04-01","1960-05-01","1960-06-01","1960-07-01","1960-08-01","1960-09-01","1960-10-01","1960-11-01","1960-12-01"],"y":[424.10989389354904,407.05570173851447,470.8257459339377,460.88165546391258,484.86806208866483,536.87136706816841,612.87056352310901,623.87075889033031,527.87071139037903,471.87072293911967,426.87072013125544,469.87072081393603],"text":[".index: 1960-01-01<br />.value: 424.1099<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-02-01<br />.value: 407.0557<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-03-01<br />.value: 470.8257<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-04-01<br />.value: 460.8817<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-05-01<br />.value: 484.8681<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-06-01<br />.value: 536.8714<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-07-01<br />.value: 612.8706<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-08-01<br />.value: 623.8708<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-09-01<br />.value: 527.8707<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-10-01<br />.value: 471.8707<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-11-01<br />.value: 426.8707<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]",".index: 1960-12-01<br />.value: 469.8707<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]<br />.color_mod: 1_ARIMA(1,1,0)(0,1,0)[12]"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"1_ARIMA(1,1,0)(0,1,0)[12]","legendgroup":"1_ARIMA(1,1,0)(0,1,0)[12]","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":25.570776255707766,"l":28.493150684931514},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.611872146118724},"title":{"text":"Forecast Plot","font":{"color":"rgba(44,62,80,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["1948-05-28","1961-07-06"],"tickmode":"auto","ticktext":["1950","1955","1960"],"tickvals":[-7305,-5479,-3653],"categoryorder":"array","categoryarray":["1950","1955","1960"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.6529680365296811,"tickwidth":0.22139200221392005,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392005,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[78.006462055483482,649.86429683484687],"tickmode":"auto","ticktext":["200","400","600"],"tickvals":[200,400,600],"categoryorder":"array","categoryarray":["200","400","600"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.6529680365296811,"tickwidth":0.22139200221392005,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392005,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088001,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.68949771689498},"title":{"text":"Legend","font":{"color":"rgba(44,62,80,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"21c1c22705e":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"21c1c22705e","visdat":{"21c1c22705e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Finally enhancement to add attributes to <code>ts_growth_rate_vec()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_growth_rate_vec</span>(AirPassengers)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]          NA   5.3571429  11.8644068  -2.2727273  -6.2015504  11.5702479
  [7]   9.6296296   0.0000000  -8.1081081 -12.5000000 -12.6050420  13.4615385
 [13]  -2.5423729   9.5652174  11.9047619  -4.2553191  -7.4074074  19.2000000
 [19]  14.0939597   0.0000000  -7.0588235 -15.8227848 -14.2857143  22.8070175
 [25]   3.5714286   3.4482759  18.6666667  -8.4269663   5.5214724   3.4883721
 [31]  11.7977528   0.0000000  -7.5376884 -11.9565217  -9.8765432  13.6986301
 [37]   3.0120482   5.2631579   7.2222222  -6.2176166   1.1049724  19.1256831
 [43]   5.5045872   5.2173913 -13.6363636  -8.6124402  -9.9476440  12.7906977
 [49]   1.0309278   0.0000000  20.4081633  -0.4237288  -2.5531915   6.1135371
 [55]   8.6419753   3.0303030 -12.8676471 -10.9704641 -14.6919431  11.6666667
 [61]   1.4925373  -7.8431373  25.0000000  -3.4042553   3.0837004  12.8205128
 [67]  14.3939394  -2.9801325 -11.6040956 -11.5830116 -11.3537118  12.8078818
 [73]   5.6768559  -3.7190083  14.5922747   0.7490637   0.3717472  16.6666667
 [79]  15.5555556  -4.6703297 -10.0864553 -12.1794872 -13.5036496  17.2995781
 [85]   2.1582734  -2.4647887  14.4404332  -1.2618297   1.5974441  17.6100629
 [91]  10.4278075  -1.9370460 -12.3456790 -13.8028169 -11.4379085  12.9151292
 [97]   2.9411765  -4.4444444  18.2724252  -2.2471910   2.0114943  18.8732394
[103]  10.1895735   0.4301075 -13.4903640 -14.1089109 -12.1037464  10.1639344
[109]   1.1904762  -6.4705882  13.8364780  -3.8674033   4.3103448  19.8347107
[115]  12.8735632   2.8513238 -20.0000000 -11.1386139 -13.6490251   8.7096774
[121]   6.8249258  -5.0000000  18.7134503  -2.4630542   6.0606061  12.3809524
[127]  16.1016949   2.0072993 -17.1735242 -12.0950324 -11.0565111  11.8784530
[133]   2.9629630  -6.2350120   7.1611253  10.0238663   2.3861171  13.3474576
[139]  16.2616822  -2.5723473 -16.1716172  -9.2519685 -15.4013015  10.7692308
attr(,"vector_attributes")
attr(,"vector_attributes")$tsp
[1] 1949.000 1960.917   12.000

attr(,"vector_attributes")$class
[1] "ts"

attr(,"name")
[1] "AirPassengers"</code></pre>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>rtip</category>
  <category>healthyrts</category>
  <category>timeseries</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-11-16/index.html</guid>
  <pubDate>Thu, 16 Nov 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>How to Perform Multiple Linear Regression in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-11-15/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Multiple linear regression is a powerful statistical method that allows us to examine the relationship between a dependent variable and multiple independent variables.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<section id="step-1-load-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="step-1-load-the-dataset">Step 1: Load the dataset</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the mtcars dataset</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(mtcars)</span></code></pre></div>
</section>
<section id="step-2-build-the-model" class="level2">
<h2 class="anchored" data-anchor-id="step-2-build-the-model">Step 2: Build the model</h2>
<p>Now, let’s create the multiple linear regression model using the specified variables: disp, hp, and drat.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Build the multiple linear regression model</span></span>
<span id="cb2-2">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> disp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> hp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> drat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span></code></pre></div>
</div>
</section>
<section id="step-3-examine-the-data" class="level2">
<h2 class="anchored" data-anchor-id="step-3-examine-the-data">Step 3: Examine the data</h2>
<p>It’s always a good idea to take a look at the relationships between variables before diving into the model. The <code>pairs()</code> function helps us with that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Examine relationships between variables</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pairs</span>(mtcars[,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mpg"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"disp"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hp"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drat"</span>)])</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-15/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="step-4-check-for-multicollinearity" class="level2">
<h2 class="anchored" data-anchor-id="step-4-check-for-multicollinearity">Step 4: Check for multicollinearity</h2>
<p>Multicollinearity is when independent variables in a regression model are highly correlated. It can affect the stability and reliability of our model. Keep an eye on the scatterplots in the pairs plot to get a sense of this.</p>
</section>
<section id="step-5-plot-the-residuals" class="level2">
<h2 class="anchored" data-anchor-id="step-5-plot-the-residuals">Step 5: Plot the residuals</h2>
<p>Now, let’s check the model’s residuals using a scatterplot. Residuals are the differences between observed and predicted values. They should ideally show no pattern.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the residuals</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb4-3">  model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>residuals, </span>
<span id="cb4-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals vs Fitted Values"</span>, </span>
<span id="cb4-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fitted Values"</span>, </span>
<span id="cb4-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Residuals"</span></span>
<span id="cb4-7">  )</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/2023-11-15/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="step-6-evaluate-the-model" class="level2">
<h2 class="anchored" data-anchor-id="step-6-evaluate-the-model">Step 6: Evaluate the model</h2>
<p>By examining the residuals vs.&nbsp;fitted values plot, we can identify patterns that may suggest non-linearity or heteroscedasticity. Ideally, residuals should be randomly scattered.</p>
</section>
<section id="step-7-encourage-readers-to-try-it-themselves" class="level2">
<h2 class="anchored" data-anchor-id="step-7-encourage-readers-to-try-it-themselves">Step 7: Encourage readers to try it themselves</h2>
<p>I’d encourage readers to take the code snippets, run them in their R environment, and explore. Maybe try different variables, tweak the model, or even use another dataset. Hands-on experience is the best teacher!</p>
<p>Remember, understanding the data and interpreting the results is as important as running the code. It’s a fascinating journey into uncovering patterns and relationships within your data.</p>
<p>Feel free to reach out if you have any questions or if there’s anything specific you’d like to explore further. Happy coding!</p>


</section>
</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-11-15/index.html</guid>
  <pubDate>Wed, 15 Nov 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>How to Predict a Single Value Using a Regression Model in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/2023-11-14/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Regression models are a powerful tool for predicting future values based on historical data. They are used in a wide range of industries, including finance, healthcare, and marketing. In this blog post, we will learn how to predict a single value using a regression model in R. We will use the <code>mtcars</code> dataset, which contains information about cars, including their weight, horsepower, and fuel efficiency.</p>
</section>
<section id="building-a-linear-regression-model" class="level1">
<h1>Building a Linear Regression Model</h1>
<p>The first step in predicting a single value is to build a regression model. We can do this using the <code>lm()</code> function in R. The <code>lm()</code> function takes two arguments: a formula and a data frame. The formula specifies the relationship between the dependent variable (the variable we want to predict) and the independent variables (the variables we use to predict the dependent variable). The data frame contains the values of the dependent and independent variables.</p>
<p>To build a linear regression model to predict the fuel efficiency of a car based on its weight and horsepower, we would use the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a linear regression model</span></span>
<span id="cb1-2">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span></code></pre></div>
</div>
<p>The <code>model</code> object now contains the fitted regression model. We can inspect the model by using the <code>summary()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ wt + hp, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-3.941 -1.600 -0.182  1.050  5.854 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 37.22727    1.59879  23.285  &lt; 2e-16 ***
wt          -3.87783    0.63273  -6.129 1.12e-06 ***
hp          -0.03177    0.00903  -3.519  0.00145 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.593 on 29 degrees of freedom
Multiple R-squared:  0.8268,    Adjusted R-squared:  0.8148 
F-statistic: 69.21 on 2 and 29 DF,  p-value: 9.109e-12</code></pre>
</div>
</div>
<p>The output of the <code>summary()</code> function shows the estimated coefficients, standard errors, and p-values for the independent variables in the model. The coefficients represent the change in the dependent variable for a one-unit increase in the independent variable, holding all other variables constant.</p>
</section>
<section id="predicting-a-single-value" class="level1">
<h1>Predicting a Single Value</h1>
<p>Once we have fitted a regression model, we can use it to predict single values. We can do this using the <code>predict()</code> function. The <code>predict()</code> function takes two arguments: the fitted model and a new data frame containing the values of the independent variables for which we want to make predictions.</p>
<p>To predict the fuel efficiency of a car with a weight of 3,000 pounds and a horsepower of 150, we would use the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new data frame containing the values of the independent </span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># variables for which we want to make predictions</span></span>
<span id="cb4-3">newdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">wt =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wt is in 1000 lbs</span></span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Predict the fuel efficiency of the car</span></span>
<span id="cb4-6">prediction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(model, newdata)</span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the predicted fuel efficiency</span></span>
<span id="cb4-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(prediction)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
20.82784 </code></pre>
</div>
</div>
<p>The output of the <code>predict()</code> function is a vector containing the predicted values for the dependent variable. In this case, the predicted fuel efficiency is 20.8278358 miles per gallon.</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this blog post, we have learned how to predict a single value using a regression model in R. We used the <code>mtcars</code> dataset to build a linear regression model to predict the fuel efficiency of a car based on its weight and horsepower. We then used the <code>predict()</code> function to predict the fuel efficiency of a car with a specific weight and horsepower.</p>
</section>
<section id="try-it-yourself" class="level1">
<h1>Try It Yourself</h1>
<p>Now that you know how to predict a single value using a regression model in R, try it yourself! Here are some ideas:</p>
<ul>
<li>Build a linear regression model to predict the price of a house based on its size and number of bedrooms.</li>
<li>Build a linear regression model to predict the salary of a person based on their education level and years of experience.</li>
<li>Build a linear regression model to predict the number of customers that will visit a store on a given day based on the day of the week and the weather forecast.</li>
</ul>
<p>Once you have built a regression model, you can use it to predict single values for new data. This can be a valuable tool for making decisions about the future.</p>


</section>

 ]]></description>
  <category>rtip</category>
  <category>regression</category>
  <guid>https://www.spsanderson.com/steveondata/posts/2023-11-14/index.html</guid>
  <pubDate>Tue, 14 Nov 2023 05:00:00 GMT</pubDate>
</item>
</channel>
</rss>
